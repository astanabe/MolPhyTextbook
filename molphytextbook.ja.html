<!DOCTYPE html><html prefix="dcterms: http://purl.org/dc/terms/">
<head>
<title>分子系統学演習 データセットの作成から仮説検定まで</title>
<!--Generated on Tue Oct 20 04:07:55 2015 by LaTeXML (version 0.8.0_02) http://dlmf.nist.gov/LaTeXML/.-->
<!--Document created on 2015/10/20.-->

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="LaTeXML.css" type="text/css">
<link rel="stylesheet" href="ltx-book.css" type="text/css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<h1 class="ltx_title ltx_title_document">分子系統学演習 データセットの作成から仮説検定まで</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">田辺晶史
</span></span>
</div>
<div class="ltx_date ltx_role_creation">2015/10/20</div>

<section id="Chx1" class="ltx_chapter">
<h2 class="ltx_title ltx_title_chapter">はじめに</h2>

<div id="Chx1.p1" class="ltx_para">
<p class="ltx_p">本書は、2008年10月の農林交流センターワークショップ「分子系統樹推定法：理論と応用」での講義用に執筆を開始しました。そのため、当初は受講者の復習と落選者の自習のためのものでした。それ以来毎年10月頃にワークショップがあり、それに合わせて加筆・修正を加え、現在の姿になりました。</p>
</div>
<div id="Chx1.p2" class="ltx_para">
<p class="ltx_p">分子系統樹推定法は、多くの分野で求められている技術となってきましたが、残念なことに未だに確立されたものではなく発展途上です。今回、私の担当する講義では「よく使われている方法」ではなく、(たぶん)「現状では最も良い方法」を提示することにしました。そのため、本書の内容は非常にアグレッシブな内容となっています。本書をお読みの皆さんの中には、既存の論文の中で使われている方法の解説を望まれる方がいらっしゃるかもしれません。おそらくそういう方にも多少は役に立つ情報は載っていると思いますが、本書の目的は「現状では最も良い(と私が勝手に思っている)方法」を提示することにあることを予めご了承下さい。</p>
</div>
<div id="Chx1.p3" class="ltx_para">
<p class="ltx_p">また、本書はクリエイティブ・コモンズの表示-継承 2.1 日本ライセンスの下で配布することにしました。このライセンスの下では、原著作者の明示を行う限り、利用者は自由に本書を複製・頒布・展示することができます。また、原著作者の明示と本ライセンスまたは互換性のあるライセンスの適用を行う限り、本書を改変した二次著作物の作成・配布も自由に行うことができます。詳しい使用許諾条件を見るには
<br class="ltx_break"><a href="http://creativecommons.org/licenses/by-sa/2.1/jp/" title="" class="ltx_ref">http://creativecommons.org/licenses/by-sa/2.1/jp/</a>
<br class="ltx_break">をチェックするか、クリエイティブ･コモンズに郵便にてお問い合わせください。住所は：171 Second Street, Suite 300, San Francisco, California 94105, USA です。</p>
</div>
<div id="Chx1.p4" class="ltx_para">
<p class="ltx_p">本書が皆さんの役に立つことができましたら幸いです。この機会を与えて下さった農業環境技術研究所の三中信宏先生と、本書をお読みの皆さんに感謝します。</p>
</div>
</section>
<section id="Chx2" class="ltx_chapter">
<h2 class="ltx_title ltx_title_chapter">凡例</h2>

<div id="Chx2.p1" class="ltx_para">
<p class="ltx_p">本書ではコンピュータに入力するコマンドやその結果を表記する際に以下のように記述しています。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># コメント</span>
        </span>
<span class="ltx_p ltx_align_left">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; command option1 \</span>
        </span>
<span class="ltx_p ltx_align_left">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">option2 \</span>
        </span>
<span class="ltx_p ltx_align_left">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">option3↓</span>
        </span>
<span class="ltx_p ltx_align_left">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">output of command</span>
        </span>
<span class="ltx_p ltx_align_left">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; command option1 option2 option3↓</span>
        </span>
<span class="ltx_p ltx_align_left">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">output of command</span>
        </span>
</p>
<p class="ltx_p">上記の例では<span class="ltx_text ltx_font_typewriter">command option1 option2 option3</span>という全く同じコマンドを2回実行しており、コマンド実行後に<span class="ltx_text ltx_font_typewriter">output of command</span>がコマンドにより表示されています。ここで、#から改行まではコメントを表しており、入力の必要はありません。行頭の<span class="ltx_text ltx_font_typewriter">&gt;</span>とそれに続くスペースはコマンドの入力の開始を表しており、↓までがコマンドとオプションの入力内容になります。<span class="ltx_text ltx_font_typewriter">&gt;</span>とそれに続くスペースはあくまで入力の開始を示すためのものですので、入力しないで下さい。↓は入力の終端を表し、ここでEnterキーを押すことを指示する記号です。↓を入力しないようにして下さい。なお、コマンドとオプションを見やすくするためにコマンドやオプションの途中に改行を意図的に入れることがありますが、そのような改行の直前には<span class="ltx_text ltx_font_typewriter">\</span>を記してあります。したがって、<span class="ltx_text ltx_font_typewriter">\</span>が直前にある改行はコマンドの終端や改行入力の指示を意味しません。また、表示環境によってはワードラップ機能により筆者の意図しない改行が入ってしまうことがありますが、これもコマンドの終端や改行入力の指示を意味しませんので注意して下さい。</p>
</div>
<div id="Chx2.p2" class="ltx_para">
<p class="ltx_p">また、本書では様々なファイルを使用しますが、その内容は以下のように記述しています。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| 1行目の内容</span>
        </span>
<span class="ltx_p ltx_align_left">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| 2行目の内容</span>
        </span>
</p>
<p class="ltx_p">この例では、行頭の<span class="ltx_text ltx_font_typewriter">|</span>とそれに続くスペースはファイル内の行頭を表しており、ファイル作成の際は入力しないように注意して下さい。これは、ワードラップ機能による筆者の意図しない改行とファイルに入力すべき改行を区別できるようにするためのものです。</p>
</div>
</section>
<section id="Ch0" class="ltx_chapter">
<h2 class="ltx_title ltx_title_chapter">
<span class="ltx_tag ltx_tag_chapter">第0章 </span>必要なソフトウェアのインストールと環境整備</h2>

<div id="Ch0.p1" class="ltx_para">
<p class="ltx_p">本書が想定するのは、Windows・Linux・Mac OS Xの3つのOSです。各OSのバージョンはWindowsではXP～7、LinuxではDebian GNU/Linux wheezyかUbuntu 12.04 LTS、Mac OS XではSnow Leopard以降のことしか想定していません。これら以外のOSでは、自力で何とかしていただく必要があります。上記のOSであっても、場合によっては自力で何とかする必要性に直面する可能性はあります。</p>
</div>
<section id="Ch0.S1" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">0.1 </span>Windowsの場合</h3>

<div id="Ch0.S1.p1" class="ltx_para">
<p class="ltx_p">Jalview、TracerおよびFigTreeの動作にはJava実行環境が必要ですが、Windowsには標準では最新のJava実行環境が備わっていません。そのため
<br class="ltx_break"><a href="http://java.com/" title="" class="ltx_ref">http://java.com/</a>
<br class="ltx_break">からJava実行環境を入手してインストールしておく必要があります。</p>
</div>
<div id="Ch0.S1.p2" class="ltx_para">
<p class="ltx_p">また、Windows環境では、エクスプローラ上で指定したフォルダをカレントフォルダとするコマンドプロンプトを簡単に起動できるようになる「ContextConsole Shell Extension」をインストールしておくことをおすすめします。
<br class="ltx_break"><a href="http://code.kliu.org/cmdopen/" title="" class="ltx_ref">http://code.kliu.org/cmdopen/</a>
<br class="ltx_break">から入手できます。このソフトをインストールすると、フォルダアイコンの右クリックメニューからコマンドプロンプトを起動できるようになります。なお、「カレントフォルダ」というのは、その時点でプログラムを起動すると作業フォルダとして使われるフォルダのことです。プログラムによってはカレントフォルダを無視して任意のフォルダを作業フォルダとするものもあります。フォルダのことをディレクトリと呼ぶこともありますが意味は同じです。</p>
</div>
<div id="Ch0.S1.p3" class="ltx_para">
<p class="ltx_p">Windowsでは、標準ではファイル名末尾の拡張子(<span class="ltx_text ltx_font_typewriter">.fas</span>とか<span class="ltx_text ltx_font_typewriter">.nex</span>のこと)が表示されません。これはこの先大変不便なので、表示するように変更しておく必要があります。それにはまず、エクスプローラを起動(WinキーとEの同時押しで可能です)し、<span class="ltx_text ltx_font_typewriter">ツール</span>メニュー内の<span class="ltx_text ltx_font_typewriter">フォルダ オプション</span>を開きます(Vista/7ではコントロールパネル内にもあります)。すると、表示されるダイアログに<span class="ltx_text ltx_font_typewriter">表示</span>タブがありますのでそれを選択します。そして、<span class="ltx_text ltx_font_typewriter">詳細設定</span>ペインの中に<span class="ltx_text ltx_font_typewriter">登録されている拡張子は表示しない</span>という項目があり、チェックが入っているはずですので、そのチェックを外して<span class="ltx_text ltx_font_typewriter">OK</span>を押すと、拡張子が表示されるようになります。また、Windows Vista/7に搭載されているユーザーアカウント制御(UAC)という機能は、セキュリティ上重要ではあるのですが、様々なソフトが正常に動作しないようにしてしまう困った機能ですので、もし何か問題があれば無効にして試してみて下さい。ウィルス対策ソフトも誤検出や暴走するものがありますので注意して下さい。</p>
</div>
<div id="Ch0.S1.p4" class="ltx_para">
<p class="ltx_p">後の操作の際に、「正規表現」を利用した検索・置換が可能なテキストエディタがあると便利です。正規表現とは、「一定のルールに該当する文字列を検索する」ためのそのルールの記述方法のことです。例えば「2009/10/22」といった日付を全て探したい、別の文字列に置換したい場合に用います。Windows用の無料テキストエディタで正規表現検索・置換ができるものとしてはサクラエディタがあります。
<br class="ltx_break"><a href="http://sakura-editor.sourceforge.net/" title="" class="ltx_ref">http://sakura-editor.sourceforge.net/</a>
<br class="ltx_break">からダウンロードできます。インストーラをダウンロードして実行し、予めインストールしておいて下さい。</p>
</div>
<div id="Ch0.S1.p5" class="ltx_para">
<p class="ltx_p">本書ではEMBOSSというソフトを利用します。Windows用のEMBOSSは
<br class="ltx_break"><a href="ftp://emboss.open-bio.org/pub/EMBOSS/windows/" title="" class="ltx_ref">ftp://emboss.open-bio.org/pub/EMBOSS/windows/</a>
<br class="ltx_break">でインストーラが配布されていますのでこれをダウンロードして起動し、指示通りにインストールすれば完了です。</p>
</div>
<div id="Ch0.S1.p6" class="ltx_para">
<p class="ltx_p">次に、配列を表示するためのソフトとしてMEGAかJalviewをインストールして下さい。それぞれ下記のURLから入手できます。
<br class="ltx_break"><a href="http://www.megasoftware.net/" title="" class="ltx_ref">http://www.megasoftware.net/</a>
<br class="ltx_break"><a href="http://www.jalview.org/Web_Installers/install.htm" title="" class="ltx_ref">http://www.jalview.org/Web_Installers/install.htm</a>
<br class="ltx_break">Jalviewはデフォルトでは起動時にデモが始まってしまい、それが非常に重いので、<span class="ltx_text ltx_font_typewriter">Tools</span>メニュー内の<span class="ltx_text ltx_font_typewriter">Preferences...</span>を開き、<span class="ltx_text ltx_font_typewriter">Open file</span>のチェックボックスに入っているチェックを外して下さい。これでデモが起動しなくなります。</p>
</div>
<div id="Ch0.S1.p7" class="ltx_para">
<p class="ltx_p">その他のソフトウェアは、
<br class="ltx_break"><a href="http://www.fifthdimension.jp/products/molphypack/" title="" class="ltx_ref">http://www.fifthdimension.jp/products/molphypack/</a>
<br class="ltx_break">にインストーラを用意してあります。ダウンロードして実行し、案内に従ってインストールしておいて下さい。</p>
</div>
<div id="Ch0.S1.p8" class="ltx_para">
<p class="ltx_p">分子系統樹推定で用いられるソフトウェアには、英語圏で制作されたものが多くあります。そのようなものはしばしば日本語の文字を含んだフォルダ名・ファイル名を正しく扱うことができません。しかし多くのOSでユーザー用のフォルダはユーザー名を含んでいます。そのため、ユーザー名に日本語(に限らず英数字以外の文字)を用いていると問題が起きる可能性があります。的確なエラーメッセージが表示されれば原因は分かるし対策も打てるのですが、エラーメッセージを見ても原因が分からないことも頻繁にありますので、もしユーザー名に英数字以外を用いていた場合、新たに英数字以外の文字をユーザー名に含まないアカウントを作成してそちらのアカウントでログオンするようにして下さい。特定のファイルやフォルダの最上位のフォルダからの位置を正確に記したものを絶対パスとかフルパスと言います。フルパスにスペースを含んでいると正常に動作しないソフトウェアもあるかもしれませんので注意して下さい。特に、Windows XPではデスクトップやマイドキュメントはフルパスにスペースが含まれていますので注意が必要です。</p>
</div>
<div id="Ch0.S1.p9" class="ltx_para">
<p class="ltx_p">また、最近のOSには自動更新機能が搭載されていることがありますが、更新の際に強制的に再起動するものがあります。分子系統樹推定は非常に時間のかかる解析です。1ヶ月かかる解析の最中に強制再起動が働いて、また最初からやり直し、などということになっては大変です。例えば、Windowsでは更新を定期的に確認し、もし見つかれば自動的にインストールして、必要があれば強制再起動するのがデフォルト設定になっています。というわけで、強制的に再起動されたりすることの無いように設定を確認しておいて下さい。処理の重いスクリーンセイバーや常駐ソフトウェアも解析の邪魔になりますので、解析中は無効にしておくことをおすすめします。</p>
</div>
</section>
<section id="Ch0.S2" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">0.2 </span>Mac OS Xの場合</h3>

<div id="Ch0.S2.p1" class="ltx_para">
<p class="ltx_p">Mac OS Xは正統なUNIXの流れを汲むOSであり、ほとんどのUNIX環境用ソフトウェアがそのままで動作します。標準でターミナルがインストールされており、Java・Perlも入っています。しかし、Cコンパイラなどの重要なコマンドは標準ではインストールされていません。CコンパイラはXcode Toolsの一部としてAppleから提供されています。
<br class="ltx_break"><a href="https://developer.apple.com/downloads/index.action" title="" class="ltx_ref">https://developer.apple.com/downloads/index.action</a>
<br class="ltx_break">から事前にダウンロードしてインストールしておく必要があります。開発者として登録した上で、OSのバージョンに合ったものをインストールする必要がありますのでご注意下さい。Snow Leopard以前のOSであれば、OSのインストール用DVDに同梱されているはずですので、それをインストールしていただければ結構です。なお、Lion以降では、オプションとして提供されているCommand Line Tools for Xcodeという名前のパッケージも必要です。こちらもインストールしておいて下さい。</p>
</div>
<div id="Ch0.S2.p2" class="ltx_para">
<p class="ltx_p">後の操作の際に「正規表現検索・置換」に対応したテキストエディタがあると大変便利です。正規表現とは、「一定のルールに該当する文字列を検索する」ためのそのルールの記述方法のことです。例えば「2009/10/22」といった日付を全て探したい、別の文字列に置換したい場合に用います。Mac OS X用の無料テキストエディタで正規表現が利用可能なものとしては、CotEditorがおすすめです。CotEditorは下記から入手できます。
<br class="ltx_break"><a href="http://sourceforge.jp/projects/coteditor/" title="" class="ltx_ref">http://sourceforge.jp/projects/coteditor/</a>
<br class="ltx_break">ダウンロードして<span class="ltx_text ltx_font_typewriter">アプリケーション(/Applications)</span>に入れておいて下さい。</p>
</div>
<div id="Ch0.S2.p3" class="ltx_para">
<p class="ltx_p">Mac OS Xでは、多くの作業をターミナルで行いますが、ターミナル上でのフォルダの移動は面倒な作業です。以下のURLから「cdto」というソフトをインストールしておくことでその手間が軽減できます。
<br class="ltx_break"><a href="https://code.google.com/p/cdto/" title="" class="ltx_ref">https://code.google.com/p/cdto/</a>
<br class="ltx_break">配布ファイルを展開して、OSのバージョンに合った実行ファイルを<span class="ltx_text ltx_font_typewriter">アプリケーション(/Applications)</span>にインストールして下さい。インストール後、Finder上でcdtoのアイコンをFinderのタイトルバー付近の適当な場所にドラッグアンドドロップして下さい。cdtoのボタンが登録されます。以降、そのボタンを押すことでFinderで開いているフォルダをカレントフォルダとするターミナルが起動できるようになります。</p>
</div>
<div id="Ch0.S2.p4" class="ltx_para">
<p class="ltx_p">次に、配列を表示するためのソフトとしてMEGAかJalviewをインストールして下さい。それぞれ下記のURLから入手できます。
<br class="ltx_break"><a href="http://www.megasoftware.net/" title="" class="ltx_ref">http://www.megasoftware.net/</a>
<br class="ltx_break"><a href="http://www.jalview.org/Web_Installers/install.htm" title="" class="ltx_ref">http://www.jalview.org/Web_Installers/install.htm</a>
<br class="ltx_break">Jalviewはデフォルトでは起動時にデモが始まってしまい、それが非常に重いので、<span class="ltx_text ltx_font_typewriter">Tools</span>メニュー内の<span class="ltx_text ltx_font_typewriter">Preferences...</span>を開き、<span class="ltx_text ltx_font_typewriter">Open file</span>のチェックボックスに入っているチェックを外して下さい。これでデモが起動しなくなります。</p>
</div>
<div id="Ch0.S2.p5" class="ltx_para">
<p class="ltx_p">以上のインストールが終わったら、以下のコマンドをターミナルで実行して下さい。必要なものが全てインストールされます。途中、何回か管理者パスワードを質問されますので、入力して下さい。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; mkdir -p ~/temporary↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; cd ~/temporary↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; curl -O http://www.fifthdimension.jp/products/molphypack/install_on_OSX.sh↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; sh install_on_OSX.sh↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; cd ..↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; rm -rf temporary↓</span>
          </span>
</p>
<p class="ltx_p">もしも外部ネットワークへのアクセスにプロキシを設定する必要がある場合は、上記のコマンド実行の前に以下のコマンドを実行して環境変数を設定しておいて下さい。これにより、外部へはプロキシを経由してアクセスが行われるようになります。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; export http_proxy=http://server.address:portnumber↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; export ftp_proxy=http://server.address:portnumber↓</span>
          </span>
</p>
<p class="ltx_p">なお、ユーザー名とパスワードを用いた認証が必要なプロキシでは、以下のようにして下さい。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; export http_proxy=http://username:password@server.address:portnumber↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; export ftp_proxy=http://username:password@server.address:portnumber↓</span>
          </span>
</p>
</div>
</section>
<section id="Ch0.S3" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">0.3 </span>Linuxの場合</h3>

<div id="Ch0.S3.p1" class="ltx_para">
<p class="ltx_p">Debianでは、sources.listを編集してcontribとnon-freeを有効にしておいて下さい。Ubuntuではuniverse・multiverseが相当しますが、最初から有効になっていますので編集の必要はありません。その上で、以下のコマンドをターミナルかコンソールで実行して下さい。必要なものが全てインストールされます。途中、何回か管理者パスワードを質問されますので、入力して下さい。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; mkdir -p ~/temporary↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; cd ~/temporary↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; wget -c http://www.fifthdimension.jp/products/molphypack/install_on_Debian.sh↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; sh install_on_Debian.sh↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; cd ..↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; rm -rf temporary↓</span>
          </span>
</p>
<p class="ltx_p">もしも外部ネットワークへのアクセスにプロキシを設定する必要がある場合は、上記のコマンド実行の前に以下のコマンドを実行して環境変数を設定しておいて下さい。これにより、外部へはプロキシを経由してアクセスが行われるようになります。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; export http_proxy=http://server.address:portnumber↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; export ftp_proxy=http://server.address:portnumber↓</span>
          </span>
</p>
<p class="ltx_p">なお、ユーザー名とパスワードを用いた認証が必要なプロキシでは、以下のようにして下さい。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; export http_proxy=http://username:password@server.address:portnumber↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; export ftp_proxy=http://username:password@server.address:portnumber↓</span>
          </span>
</p>
<p class="ltx_p">本スクリプトではテキストエディタは追加されません。EmacsでもVimでもgEditでもKateでも、お好みものをお使い下さい。検索・置換をPerlのワンライナーで行なっていただいても構いません。</p>
</div>
</section>
</section>
<section id="Ch1" class="ltx_chapter">
<h2 class="ltx_title ltx_title_chapter">
<span class="ltx_tag ltx_tag_chapter">第1章 </span>配列データセットの作成</h2>

<section id="Ch1.S1" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1.1 </span>配列データファイルの形式と相互変換</h3>

<div id="Ch1.S1.p1" class="ltx_para">
<p class="ltx_p">各種データベースやソフトウェアでは、様々なデータファイル形式が用いられており、利用時には相互に変換する必要がしばしば生じます。以下ではまず各種ファイル形式について簡単に解説した後、相互変換方法について述べます。</p>
</div>
<section id="Ch1.S1.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.1.1 </span>各ファイル形式の特徴</h4>

<section id="Ch1.S1.SS1.SSSx1" class="ltx_subsubsection">
<h5 class="ltx_title ltx_title_subsubsection">GenBank形式</h5>

<div id="Ch1.S1.SS1.SSSx1.p1" class="ltx_para">
<p class="ltx_p">Web上の配列データベースにおけるスタンダードなファイル形式です。配列データ以外に、その配列に関する様々な注釈(annotation)情報を加えることができます。それらの情報に基づいたデータの加工処理もソフトウェアを用いて簡単に行うことができるため大変便利です。人間にとってもプログラムにとっても可読性の高いファイル形式と言えるでしょう。最も単純な場合は以下のような形式です。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| LOCUS       ABC1234       60 bp</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| DEFINITION  TaxonA 18S small subunit ribosomal RNA gene, partial sequence.</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| ORIGIN</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|         1 AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| //</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| LOCUS       ABC1235       60 bp</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| DEFINITION  TaxonB 18S small subunit ribosomal RNA gene, partial sequence.</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| ORIGIN</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|         1 AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| //</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| LOCUS       ABC1236       60 bp</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| DEFINITION  TaxonC 18S small subunit ribosomal RNA gene, partial sequence.</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| ORIGIN</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|         1 AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| //</span>
              </span>
</p>
<p class="ltx_p">ほとんどの場合はもっと様々な情報を含んでいるので、これほどシンプルではありません。</p>
</div>
</section>
<section id="Ch1.S1.SS1.SSSx2" class="ltx_subsubsection">
<h5 class="ltx_title ltx_title_subsubsection">FASTA形式</h5>

<div id="Ch1.S1.SS1.SSSx2.p1" class="ltx_para">
<p class="ltx_p">Web上の配列データベースは、この形式でのデータ出力にも対応していることが多いと思います。しかし、注釈(annotation)情報はありませんので、それらの情報を用いた加工を行いたい場合には不適です。また、塩基配列決定を行った場合には、波形の編集や複数の配列を結合(assemble)した後、このファイル形式に配列データを書き出すことが多いでしょう。ほとんどの多重配列エディタ(multiple sequence editor)においてもスタンダードなファイル形式であり、いずれのソフトにおいても入力の互換性は高いと言えます。実際の配列編集を行う際にはこのファイル形式で作業することが多いでしょう。ClustalW/Xでは配列データキャラクタとして<span class="ltx_text ltx_font_typewriter">?</span>に対応していないため、もし<span class="ltx_text ltx_font_typewriter">?</span>があるなら<span class="ltx_text ltx_font_typewriter">N</span>などに置換しておく必要があります。以下に典型的なFASTA形式ファイルを示します。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| &gt;TaxonA</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| &gt;TaxonB</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| &gt;TaxonC</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span>
              </span>
</p>
</div>
</section>
<section id="Ch1.S1.SS1.SSSx3" class="ltx_subsubsection">
<h5 class="ltx_title ltx_title_subsubsection">Clustal形式</h5>

<div id="Ch1.S1.SS1.SSSx3.p1" class="ltx_para">
<p class="ltx_p">ClustalW/Xにおいて多重配列アライメント(multiple sequence alignment)を行った際に出力されるデフォルトファイル形式です。オプション設定により他の形式での出力も可能です。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| CLUSTAL 2.0.12 multiple sequence alignment</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| TaxonA          AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| TaxonB          AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| TaxonC          AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                 ************************************************************</span>
              </span>
</p>
</div>
</section>
<section id="Ch1.S1.SS1.SSSx4" class="ltx_subsubsection">
<h5 class="ltx_title ltx_title_subsubsection">PHYLIP形式</h5>

<div id="Ch1.S1.SS1.SSSx4.p1" class="ltx_para">
<p class="ltx_p">系統解析ソフトウェアにおいて最も多く利用されているファイル形式の一つです。単純なファイル形式ですが方言が多くあり、解析ソフトウェアごとにマニュアルを良く読んで確認する必要があるのがやっかいです。配列名の文字数に制限があり、元々は10文字しか使えませんでした。しかし、これを拡張して配列名と配列の間をスペースで区切ることにして配列名の文字数制限を緩めたものも多く使われています。最大の問題は、元々の配列名文字数10文字の仕様では配列名と配列との間をスペースで区切る必要が無かったため、配列名が10文字ぴったりの場合に両者に互換性が無いことです。よって、この形式を用いる際には配列名を10文字以内にした上で必ず配列名と配列の間をスペースで区切るようにし、元々のPHYLIP形式の仕様に準拠したものとするのが安全です。閲覧・編集に適したinterleaved形式もあり、テキストエディタでの操作に適しています。PHYLIPでは配列内にはスペースが含まれていても問題ありませんが、ソフトウェアによっては配列は一続きの文字列であることを仮定しているものもあります。interleaved形式に対応していないソフトウェアもあります。また、1行空けてさらに同じ形式でデータを続けることで、ブートストラップリサンプリングしたりした多数のデータセットを1ファイルに格納することもできます。GenBank・Clustal・FASTAではそのようなことはできません。</p>
</div>
<div id="Ch1.S1.SS1.SSSx4.p2" class="ltx_para">
<p class="ltx_p">non-interleavedとinterleavedの違いは実際のファイルの中身を見ていただくのが分かり易いでしょう。以下がnon-interleavedのPHYLIP形式配列ファイルです。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| 3 60</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| TaxonA    AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|           AAAAAAAAAA</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| TaxonB    AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|           AAAAAAAAAA</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| TaxonC    AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|           AAAAAAAAAA</span>
              </span>
</p>
<p class="ltx_p">そして、これがinterleavedのPHYLIP形式ファイルです。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| 3 60</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| TaxonA    AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| TaxonB    AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| TaxonC    AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA AAAAAAAAAA</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|           AAAAAAAAAA</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|           AAAAAAAAAA</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|           AAAAAAAAAA</span>
              </span>
</p>
<p class="ltx_p">どちらも50座位で折り返しているのですが、non-interleaved形式ではそれぞれの配列ごとに折り返しているのに対して、interleaved形式では全配列をセットで折り返しています。前述のようにinterleaved形式に対応していないソフトもありますが、non-interleavedなのに折り返しがあるファイルに対応していないソフトもありますので注意が必要です。</p>
</div>
</section>
<section id="Ch1.S1.SS1.SSSx5" class="ltx_subsubsection">
<h5 class="ltx_title ltx_title_subsubsection">NEXUS形式</h5>

<div id="Ch1.S1.SS1.SSSx5.p1" class="ltx_para">
<p class="ltx_p">系統解析ソフトウェアにおいて最も多く利用されているもう一つのファイル形式です。様々な「ブロック」を記述することができ、対応しているソフトウェア用のコマンドを記述しておくことができます。その「ブロック」に非対応のソフトウェアではその中の内容は無視されますので通常問題は生じません。配列も<span class="ltx_text ltx_font_typewriter">Data</span>ブロックというブロック内に記述します。本形式にも閲覧・編集に適したinterleaved形式があり、テキストエディタでの操作に向いています。また、PHYLIP形式と同様、さらに<span class="ltx_text ltx_font_typewriter">Data</span>ブロックを作成することで、ブートストラップリサンプリングしたりした多数のデータセットを1ファイルに格納することもできます。GenBank・Clustal・FASTAではそのようなことはできません。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| #NEXUS</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| Begin Data;</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|   Dimensions NTax=3 NChar=60;</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|   Format DataType=DNA Interleave Missing=? Gap=-;</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| Matrix</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| TaxonA   AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| TaxonB   AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| TaxonC   AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| TaxonA   AAAAAAAAAA</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| TaxonB   AAAAAAAAAA</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| TaxonC   AAAAAAAAAA</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|   ;</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| End;</span>
              </span>
</p>
</div>
</section>
</section>
<section id="Ch1.S1.SS2" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.1.2 </span>データ形式の相互変換</h4>

<div id="Ch1.S1.SS2.p1" class="ltx_para">
<p class="ltx_p">配列名には、基本的に英数字とアンダースコア以外は使わないようにした方が無難です。その他の特殊記号を用いていてうまくいかない場合には、一時的に特殊記号を他の文字列に置き換えておくとよいでしょう。しかし、そのような文字は解析ソフト側でも問題が発生しやすいのでできるだけ使用は避けましょう。</p>
</div>
<section id="Ch1.S1.SS2.SSSx1" class="ltx_subsubsection">
<h5 class="ltx_title ltx_title_subsubsection">
<span class="ltx_text ltx_font_typewriter">seqret</span>によるデータ変換</h5>

<div id="Ch1.S1.SS2.SSSx1.p1" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">seqret</span>はEMBOSSに含まれている配列ファイル入出力コマンドです。ほとんどの形式に対応しており、配列形式の相互変換に便利です。対応形式の一覧は
<br class="ltx_break"><a href="http://emboss.sourceforge.net/docs/themes/SequenceFormats.html" title="" class="ltx_ref">http://emboss.sourceforge.net/docs/themes/SequenceFormats.html</a>
<br class="ltx_break">にあります。入力ファイルをPHYLIP/NEXUS形式へ変換するには以下のようにコマンドを実行します。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; seqret 入力ファイル phylip::出力ファイル↓</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; seqret 入力ファイル nexus::出力ファイル↓</span>
              </span>
</p>
<p class="ltx_p">入力ファイル形式がうまく認識されていないと思われる状況では、入力ファイル形式を以下のように指定することで改善することがあります。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; seqret fasta::入力ファイル phylip::出力ファイル↓</span>
            </p>
</div>
</section>
<section id="Ch1.S1.SS2.SSSx2" class="ltx_subsubsection">
<h5 class="ltx_title ltx_title_subsubsection">Phylogears2によるデータ変換</h5>

<div id="Ch1.S1.SS2.SSSx2.p1" class="ltx_para">
<p class="ltx_p">Phylogears2には、FASTA・NEXUS・PHYLIP・Treefinderの4形式の相互変換が可能な<span class="ltx_text ltx_font_typewriter">pgconvseq</span>コマンドがあります。NEXUSとPHYLIPは多数のデータセットを1ファイルに格納できますが他の形式はそうではないので、多数のデータセットを格納しているNEXUSやPHYLIP形式をFASTAやTreefinder形式に変換する場合は、独自ルールで書き出します。FASTAの場合、データセット間に空行を設けます。Treefinderでは、<span class="ltx_text ltx_font_typewriter">% end of data</span>というコメントを間に挟みます。これらを正しく解釈できるソフト(Phylogears2の一部コマンドだけです)でしかこれらが多数のデータセットであることを認識できません。また、変換元のFASTA形式配列に空行があると、NEXUSやPHYLIP形式に出力した際に別データセットとされてしまうので注意が必要です。使い方は下記のようになります。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgconvseq --output=PHYLIP 入力ファイル 出力ファイル↓</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgconvseq --output=NEXUS 入力ファイル 出力ファイル↓</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgconvseq --output=TF 入力ファイル 出力ファイル↓</span>
              </span>
</p>
<p class="ltx_p">なお、PHYLIP形式では本来配列名は10文字以下でなくてはなりませんが、配列形式として<span class="ltx_text ltx_font_typewriter">PHYLIPex</span>を指定することで11文字以上の配列名も許容したファイルを作成することができます。PHYML・RAxML・PAMLでは、この形式で長いOTU名を使うことができます。</p>
</div>
</section>
</section>
</section>
<section id="Ch1.S2" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1.2 </span>目的の配列を入手する</h3>

<div id="Ch1.S2.p1" class="ltx_para">
<p class="ltx_p">以下では配列データベースから目的の配列を探し出して得る方法について述べます。</p>
</div>
<section id="Ch1.S2.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.2.1 </span>分類群・遺伝子の名前から探す</h4>

<div id="Ch1.S2.SS1.p1" class="ltx_para">
<p class="ltx_p">配列が欲しい分類群が分かっているなら、分類群名データベースから辿ることで目的の配列を得ることができます。</p>
</div>
<div id="Ch1.S2.SS1.p2" class="ltx_para">
<p class="ltx_p">まず、NCBI Taxonomyのサイトを開きます。URLは下記です。
<br class="ltx_break"><a href="http://www.ncbi.nlm.nih.gov/taxonomy/" title="" class="ltx_ref">http://www.ncbi.nlm.nih.gov/taxonomy/</a>
<br class="ltx_break">このページで表示される検索ボックスから正式な分類群名で検索すると、データベース内で見つかった分類群のリストが出ますので、目的の分類群のリンクをクリックします。すると、高次分類群であれば所属する下位の分類群の階層化リストが出ます。最上位の分類群名をクリックすると、NCBIの他のデータベース内にある当該分類群のデータエントリ件数のリストが表示されています。高次分類群でなく種であればすぐにこの表示になります。件数にリンクが設定されていますのでクリックしてリンク先に跳ぶと、選択したデータベース内での当該分類群のデータエントリがずらっと出てきます。この状態で検索ボックスに遺伝子名などを追加すれば絞り込むことができます。NCBI Taxonomyを使わずとも、NucleotideやProteinのデータベースで分類群名で検索しても構いませんが、漏れや余計なものが入りやすいのでこちらの方法がおすすめです。</p>
</div>
<div id="Ch1.S2.SS1.p3" class="ltx_para">
<p class="ltx_p">次に探したいデータの遺伝子名が分かっている場合です。この場合も分類群同様に遺伝子名データベースから辿ればよいでしょう。</p>
</div>
<div id="Ch1.S2.SS1.p4" class="ltx_para">
<p class="ltx_p">まず、NCBI Geneのサイトを開きます。URLは下記になります。
<br class="ltx_break"><a href="http://www.ncbi.nlm.nih.gov/gene/" title="" class="ltx_ref">http://www.ncbi.nlm.nih.gov/gene/</a>
<br class="ltx_break">こちらの検索ボックスで目的の遺伝子名で検索します。ただ、それだけでは大量にヒットしてしまいますので、分類群名などを追加して絞り込むとよいでしょう。分類群名と同様、NucleotideやProteinのデータベースで遺伝子名で検索してもよいでしょう。他のデータベースへのリンクはあるものの分類群と違ってあまり役に立たないのでその方が手っ取り早いかもしれません。</p>
</div>
<div id="Ch1.S2.SS1.p5" class="ltx_para">
<p class="ltx_p">NCBIのNucleotideやProteinのデータベースでは、それぞれのデータエントリにはそのデータ元の生物名、遺伝子名、配列長などの様々な情報が項目ごとに記載されています。ですから、それぞれの項目を指定してキーワード検索できれば余計なものが引っかかりにくくなったりして便利です。そのためには、以下のようなキーワードを書けばよいことになっています。</p>
<p class="ltx_p ltx_align_left" style="border-left:0.5em solid #000000;padding:0.5em 1em 0.5em 1em;">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">キーワード[項目指定語]</span>
          </p>
<p class="ltx_p">項目指定語の一覧は以下のURLで説明されています。
<br class="ltx_break"><a href="http://www.ncbi.nlm.nih.gov/books/NBK49540/" title="" class="ltx_ref">http://www.ncbi.nlm.nih.gov/books/NBK49540/</a></p>
</div>
<div id="Ch1.S2.SS1.p6" class="ltx_para">
<p class="ltx_p">例えば、以下のようなキーワードを付加することで配列長が100～1,000のエントリのみに絞り込むことができます。</p>
<p class="ltx_p ltx_align_left" style="border-left:0.5em solid #000000;padding:0.5em 1em 0.5em 1em;">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">100:1000[Sequence Length]</span>
          </p>
<p class="ltx_p">これらの項目指定検索を組み合わせてやることで目的のエントリを見つけやすくなるでしょう。</p>
</div>
<div id="Ch1.S2.SS1.p7" class="ltx_para">
<p class="ltx_p">目的のエントリが見つかったら、エントリ名をクリックすればいいですし、複数件ある場合は各エントリの頭にあるチェックボックスにチェックを入れてから検索結果リストの上にある<span class="ltx_text ltx_font_typewriter">Display</span>プルダウンメニューから<span class="ltx_text ltx_font_typewriter">GenBank</span>を選択すれば、チェックを入れたエントリの生データ、即ちGenBank形式配列が表示されます。<span class="ltx_text ltx_font_typewriter">Show</span>プルダウンメニューからは1ページに表示する件数、並び替えに使うもの(<span class="ltx_text ltx_font_typewriter">Sorted By</span>)などを指定できます。<span class="ltx_text ltx_font_typewriter">Send to</span>からは<span class="ltx_text ltx_font_typewriter">Text</span>を選べばプレーンテキストで表示され、<span class="ltx_text ltx_font_typewriter">File</span>ならローカルファイルへ保存するダイアログが出るはずです。つまり、<span class="ltx_text ltx_font_typewriter">GenBank</span>形式で表示している状態で<span class="ltx_text ltx_font_typewriter">Send to</span>を<span class="ltx_text ltx_font_typewriter">File</span>にすれば、表示しているGenBank形式データをごっそり手元のマシンに保存できます。</p>
</div>
</section>
<section id="Ch1.S2.SS2" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.2.2 </span>配列から類似配列を探す</h4>

<div id="Ch1.S2.SS2.p1" class="ltx_para">
<p class="ltx_p">NCBI BLASTから配列データベース中の類似配列を探索することができます。URLは下記です。
<br class="ltx_break"><a href="http://www.ncbi.nlm.nih.gov/BLAST/" title="" class="ltx_ref">http://www.ncbi.nlm.nih.gov/BLAST/</a></p>
</div>
<div id="Ch1.S2.SS2.p2" class="ltx_para">
<p class="ltx_p">BLASTの基本的な使い方はライフサイエンス統合データベースプロジェクトが運営する統合TVにて動画で解説されていますのでそちらをご参照下さい。下記URLからアクセスできます。
<br class="ltx_break"><a href="http://togotv.dbcls.jp/" title="" class="ltx_ref">http://togotv.dbcls.jp/</a></p>
</div>
</section>
</section>
<section id="Ch1.S3" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1.3 </span>GenBank形式ファイルからの特定遺伝子配列の抽出</h3>

<div id="Ch1.S3.p1" class="ltx_para">
<p class="ltx_p">GenBank形式では、配列中のそれぞれの領域がどういうものかという注釈(annotation)が加えられています。この情報を利用すれば、長大な配列から特定の遺伝子領域のみを抽出することができます。</p>
</div>
<div id="Ch1.S3.p2" class="ltx_para">
<p class="ltx_p">まず、GenBank形式のデータファイルをテキストエディタで開いてみて下さい。以下のような内容になっているはずです。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| LOCUS       NC_001709              19517 bp    DNA     circular INV 06-MAY-2009</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| DEFINITION  Drosophila melanogaster mitochondrion, complete genome.</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| ACCESSION   NC_001709</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| VERSION     NC_001709.1  GI:5835233</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| DBLINK      Project:164</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| KEYWORDS    .</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| SOURCE      mitochondrion Drosophila melanogaster (fruit fly)</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|   ORGANISM  Drosophila melanogaster</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|             Eukaryota; Metazoa; Arthropoda; Hexapoda; Insecta; Pterygota;</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|             Neoptera; Endopterygota; Diptera; Brachycera; Muscomorpha;</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|             Ephydroidea; Drosophilidae; Drosophila; Sophophora.</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| REFERENCE   1  (bases 1 to 408; 13319 to 19517)</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|   AUTHORS   Lewis,D.L., Farr,C.L. and Kaguni,L.S.</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|   TITLE     Drosophila melanogaster mitochondrial DNA: completion of the</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|             nucleotide sequence and evolutionary comparisons</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|   JOURNAL   Insect Mol. Biol. 4 (4), 263-278 (1995)</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|    PUBMED   8825764</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| 略</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| FEATURES             Location/Qualifiers</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|      source          1..19517</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /organism="Drosophila melanogaster"</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /organelle="mitochondrion"</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /mol_type="genomic DNA"</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /db_xref="taxon:7227"</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|      gene            1..65</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /gene="trnI"</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /nomenclature="Official Symbol: mt:tRNA:I | Name:</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      mitochondrial isoleucine tRNA | Provided by: FBgn0013696"</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /note="tRNA[Ile]"</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /db_xref="FLYBASE:FBgn0013696"</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /db_xref="GeneID:261011"</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|      tRNA            1..65</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /gene="trnI"</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /product="tRNA-Ile"</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /db_xref="FLYBASE:FBgn0013696"</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /db_xref="GeneID:261011"</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| 略</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|      gene            240..1263</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /gene="ND2"</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /nomenclature="Official Symbol: mt:ND2 | Name:</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      mitochondrial NADH-ubiquinone oxidoreductase chain 2 |</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      Provided by: FBgn0013680"</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /note="URF2"</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /db_xref="FLYBASE:FBgn0013680"</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /db_xref="GeneID:192474"</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|      CDS             240..1263</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /gene="ND2"</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /note="TAA stop codon is completed by the addition of 3' A</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      residues to the mRNA"</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /codon_start=1</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /transl_except=(pos:1263,aa:TERM)</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /transl_table=5</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /product="NADH dehydrogenase subunit 2"</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /protein_id="NP_008277.1"</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /db_xref="GI:5835234"</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /db_xref="FLYBASE:FBgn0013680"</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /db_xref="GeneID:192474"</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      /translation="MFNNSSKILFITIMIIGTLITVTSNSWLGAWMGLEINLLSFIPL</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      LSDNNNLMSTEASLKYFLTQVLASTVLLFSSILLMLKNNMNNEINESFTSMIIMSALL</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      LKSGAAPFHFWFPNMMEGLTWMNALMLMTWQKIAPLMLISYLNIKYLLLISVILSVII</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      GAIGGLNQTSLRKLMAFSSINHLGWMLSSLMISESIWLILFFFYSFLSFVLTFMFNIF</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      KLFHLNQLFSWFVNSKILKFTLFMNFLSLGGLPPFLGFLPKWLVIQQLTLCNQYFMLT</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      IMMMSTLITLFFYLRICYSAFMMNYFENNWIMKMNMNSINYNMYMIMTFFSIFGLFLI</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|                      SLFYFMF"</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| 略</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| ORIGIN</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|         1 aatgaattgc ctgataaaaa ggattacctt gatagggtaa atcatgcagt tttctgcatt</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| 略</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| //</span>
          </span>
</p>
<p class="ltx_p">これを見れば、<span class="ltx_text ltx_font_typewriter">FEATURES</span>という項目にどこからどこまでが何という領域か、といった情報が書かれているのが分かります。<span class="ltx_text ltx_font_typewriter">ORIGIN</span>には実際の塩基配列があります。NCBI上のエントリをWebブラウザで見ている場合、<span class="ltx_text ltx_font_typewriter">FEATURES</span>の<span class="ltx_text ltx_font_typewriter">CDS</span>とか<span class="ltx_text ltx_font_typewriter">tRNA</span>といった文字列にはリンクが設定されており、リンク先では該当領域だけが切り出して表示されます。領域を切り出したいエントリが少ない場合は、これを繰り返して切り出した情報を得ることもできますが、エントリ数が大きくなってくると手間がかかります。<span class="ltx_text ltx_font_typewriter">FEATURES</span>の内容を任意のキーワードで検索して、該当する領域の配列を<span class="ltx_text ltx_font_typewriter">ORIGIN</span>の内容から切り出してくれるコマンド<span class="ltx_text ltx_font_typewriter">extractfeat</span>がEMBOSSに含まれていますので、これを使えば容易に大量のエントリから領域を切り出すことができます。</p>
</div>
<div id="Ch1.S3.p3" class="ltx_para">
<p class="ltx_p">例えば<span class="ltx_text ltx_font_italic">trnI</span>領域を別ファイルに書き出すには、以下のようにターミナルやコマンドプロンプトでコマンドを実行します。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; extractfeat -type tRNA -tag gene -value trnI 入力ファイル 出力ファイル↓</span>
        </p>
<p class="ltx_p">このコマンドを実行すると、tRNA領域の中で遺伝子名に<span class="ltx_text ltx_font_typewriter">trnI</span>を含む領域が出力ファイルにFASTA形式で書き出されます。同様に、<span class="ltx_text ltx_font_italic">ND2</span>領域を書き出すには以下のようにします。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; extractfeat -type CDS -tag gene -value ND2 入力ファイル 出力ファイル↓</span>
        </p>
<p class="ltx_p">データベースの注釈がきちんとなされていればこれでうまくいきますが、遺伝子名には微妙に表現が異なる記法が使われていることが頻繁にあります。そのような場合は、<span class="ltx_text ltx_font_typewriter">"ND2 | NAD2"</span>などとスペースと<span class="ltx_text ltx_font_typewriter">|</span>で区切って複数のキーワードを書き、ダブルクォートで囲ってやることでそれぞれのキーワードに一致する配列が出力されます。これは、複数の領域を一度に書き出したい場合にも使えます。
ただし、<span class="ltx_text ltx_font_typewriter">16S ribosomal RNA</span>などといった、上記のような区切り文字でないスペースを含んだキーワードは使用できません。
そのような場合は、事前に配列ファイルを正規表現を用いた検索・置換などを用いて処理しておきます。</p>
</div>
<div id="Ch1.S3.p4" class="ltx_para">
<p class="ltx_p">また、書き出した領域を増幅できるプライマーを設計したい場合には、その領域の前後100bpほどまで含めて書き出したいことがあります。その場合には、以下のように<span class="ltx_text ltx_font_typewriter">-before</span>オプションと<span class="ltx_text ltx_font_typewriter">-after</span>オプションを付加します。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; extractfeat -type CDS -tag gene -value ND2 -before 100 -after 100 入力ファイル 出力ファイル↓</span>
        </p>
</div>
</section>
<section id="Ch1.S4" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1.4 </span>多重配列整列</h3>

<div id="Ch1.S4.p1" class="ltx_para">
<p class="ltx_p">配列の準備ができたら、多重配列整列(multiple sequence alignment)によって各配列間で相同(homologous)な領域を検出して揃えてやる必要があります。これは、相同でない形質を比較しても系統樹の推定には役立たないためです。相同とは、「同じ祖先形質に由来する」という意味です。例えば、人間の眼と魚の眼は共通祖先が持っていた眼に由来すると考えられますが、イカやタコの眼はそうではありません。同様に、鳥の翼とコウモリの翼も相同ではありません。ただ、これらが相同でないというのは、我々が系統関係を知っているから分かるのであって、それが無ければそうとは分からないかもしれません。ですから、相同であるか否かと系統樹とは鶏と卵の関係に似ていると言えます。</p>
</div>
<div id="Ch1.S4.p2" class="ltx_para">
<p class="ltx_p">配列の多重配列整列でも同じことが言えます。つまり、系統関係無しには正しい多重配列整列ができないのです。そこで、多重配列整列と系統樹推定を同時にやってしまおうという動きもあります<cite class="ltx_cite"><a href="#bib.bib23" title="" class="ltx_ref">(例えば Fleissner <span class="ltx_text ltx_font_italic">et al</span>., 2005; Lunter <span class="ltx_text ltx_font_italic">et al</span>., <a href="#bib.bib43" title="" class="ltx_ref">2005</a>; Redelings and Suchard, <a href="#bib.bib51" title="" class="ltx_ref">2005</a>, など)</a></cite>が、膨大な計算を要し、今のところ現実的ではありません。そこで、我々はそこそこ悪くないだろうと思われる「仮の系統樹」を作成し、それに基づいて多重配列整列を行い、系統関係に依存していると考えられる信頼性の低い領域は除去して系統樹推定に用いることにしています。</p>
</div>
<div id="Ch1.S4.p3" class="ltx_para">
<p class="ltx_p">多重配列整列に最もよく用いられているのが、ClustalW2/X2 <cite class="ltx_cite"><a href="#bib.bib38" title="" class="ltx_ref">(Larkin <span class="ltx_text ltx_font_italic">et al</span>., 2007)</a></cite>ですが、最近はMUSCLE <cite class="ltx_cite"><a href="#bib.bib20" title="" class="ltx_ref">(Edgar, 2004)</a></cite>やMAFFT <cite class="ltx_cite"><a href="#bib.bib33" title="" class="ltx_ref">(Katoh <span class="ltx_text ltx_font_italic">et al</span>., 2005)</a></cite>という高速性や正確性で上回るプログラムが登場し、徐々にこれらへの移行が起きつつあります。ここではMAFFTを用いた多重配列整列の方法を説明します。</p>
</div>
<div id="Ch1.S4.p4" class="ltx_para">
<p class="ltx_p">MAFFTはコマンドラインから実行するプログラムです。使用するには、コマンドプロンプトやターミナルで以下のようにします。入力ファイル・出力ファイル共にFASTA形式です。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; mafft --auto 入力ファイル &gt; 出力ファイル↓</span>
        </p>
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">--auto</span>オプションでは、MAFFTが備えているいくつかのアルゴリズムからデータサイズなどに応じて最適なものを自動的に選択してくれます。終了の際のメッセージにどのアルゴリズム(L-INS-i・E-INS-i・G-INS-i・FFT-NS-i・FFT-NS-2など)を用いたのかが表示されますので、論文にする際にはどれが使われたのかできるだけ書いた方が良いでしょう。</p>
</div>
<section id="Ch1.S4.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.4.1 </span>タンパクコード塩基配列の多重配列整列</h4>

<div id="Ch1.S4.SS1.p1" class="ltx_para">
<p class="ltx_p">タンパクコード塩基配列を塩基配列のままで整列すると、翻訳後のアミノ酸の変異を考慮していないため、容易にフレームシフトを起こすギャップが挿入されてしまいます。しかし、現実にはそんな整列結果が妥当であることはほとんどありません。また、遺伝暗号やアミノ酸の物理化学的性質上、起こりやすい・起こりにくい変異はかなり情報が蓄積されていますが、塩基配列の整列ではそのようなことも考慮されません。そこで、いったんアミノ酸配列に翻訳して整列してから、それを逆翻訳(正確には整列済アミノ酸配列を参照しながら塩基配列を整列)してやることで、多くの場合ただ単純に整列するよりも良い結果が得られます。ここでは多重配列整列にMAFFTを、逆翻訳にEMBOSSに含まれている<span class="ltx_text ltx_font_typewriter">tranalign</span>を用いる方法を説明します。</p>
</div>
<div id="Ch1.S4.SS1.p2" class="ltx_para">
<p class="ltx_p">まず、翻訳するには各配列でコドン位置が揃っている必要があるため、塩基配列のままで整列をします。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; mafft --auto 入力ファイル &gt; 出力ファイル↓</span>
          </p>
<p class="ltx_p">整列したファイルをJalviewやMEGAなどで表示して見てやると、大抵の場合第3コドン位置では同義置換ばかりで他のコドン位置よりも変異が激しいためすぐに分かります。変異の多い座位が3座位ごとにあるわけです。そこで、第1コドン位置が1座位目になるように編集して保存します。もし途中から非コード配列になるようであればその領域も削除しておきます。翻訳してから削除しても構いません。もしもコドン位置が分からなかったり、翻訳の向きが分からなかったら、以下のようにEMBOSSの<span class="ltx_text ltx_font_typewriter">sixpack</span>コマンドを使います。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; sixpack 入力ファイル↓</span>
          </p>
<p class="ltx_p">コマンドを実行すると保存先のファイルを聞かれるので適当に名前を付けるかデフォルトのままで保存します。ここで、遺伝暗号がstandardではない場合は、<span class="ltx_text ltx_font_typewriter">-table</span>オプションでそれを指示してやる必要があります。例えば昆虫のミトゲノム配列であればinvertebrate mitochondrialなので以下のようにコマンドを実行します。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; sixpack -table 5 入力ファイル↓</span>
          </p>
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">-table</span>オプションに指定する番号と遺伝暗号との対応は以下のようになっています。</p>
<ol id="Ch1.I1" class="ltx_enumerate">
<li id="Ch1.I1.i0" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
                <span class="ltx_text" style="font-size:90%;">0.</span>
              </span> 
<div id="Ch1.I1.i0.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">Standard (default)</span>
                </p>
</div>
</li>
<li id="Ch1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
                <span class="ltx_text" style="font-size:90%;">1.</span>
              </span> 
<div id="Ch1.I1.i1.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">Standard with alternative initiation codons</span>
                </p>
</div>
</li>
<li id="Ch1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
                <span class="ltx_text" style="font-size:90%;">2.</span>
              </span> 
<div id="Ch1.I1.i2.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">Vertebrate Mitochondrial</span>
                </p>
</div>
</li>
<li id="Ch1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
                <span class="ltx_text" style="font-size:90%;">3.</span>
              </span> 
<div id="Ch1.I1.i3.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">Yeast Mitochondrial</span>
                </p>
</div>
</li>
<li id="Ch1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
                <span class="ltx_text" style="font-size:90%;">4.</span>
              </span> 
<div id="Ch1.I1.i4.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">Mold, Protozoan, Coelenterate Mitochondrial and Mycoplasma/Spiroplasma</span>
                </p>
</div>
</li>
<li id="Ch1.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
                <span class="ltx_text" style="font-size:90%;">5.</span>
              </span> 
<div id="Ch1.I1.i5.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">Invertebrate Mitochondrial</span>
                </p>
</div>
</li>
<li id="Ch1.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
                <span class="ltx_text" style="font-size:90%;">6.</span>
              </span> 
<div id="Ch1.I1.i6.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">Ciliate Macronuclear and Dasycladacean</span>
                </p>
</div>
</li>
<li id="Ch1.I1.i9" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
                <span class="ltx_text" style="font-size:90%;">9.</span>
              </span> 
<div id="Ch1.I1.i9.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">Echinoderm Mitochondrial</span>
                </p>
</div>
</li>
<li id="Ch1.I1.i10" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
                <span class="ltx_text" style="font-size:90%;">10.</span>
              </span> 
<div id="Ch1.I1.i10.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">Euplotid Nuclear</span>
                </p>
</div>
</li>
<li id="Ch1.I1.i11" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
                <span class="ltx_text" style="font-size:90%;">11.</span>
              </span> 
<div id="Ch1.I1.i11.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">Bacterial</span>
                </p>
</div>
</li>
<li id="Ch1.I1.i12" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
                <span class="ltx_text" style="font-size:90%;">12.</span>
              </span> 
<div id="Ch1.I1.i12.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">Alternative Yeast Nuclear</span>
                </p>
</div>
</li>
<li id="Ch1.I1.i13" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
                <span class="ltx_text" style="font-size:90%;">13.</span>
              </span> 
<div id="Ch1.I1.i13.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">Ascidian Mitochondrial</span>
                </p>
</div>
</li>
<li id="Ch1.I1.i14" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
                <span class="ltx_text" style="font-size:90%;">14.</span>
              </span> 
<div id="Ch1.I1.i14.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">Flatworm Mitochondrial</span>
                </p>
</div>
</li>
<li id="Ch1.I1.i15" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
                <span class="ltx_text" style="font-size:90%;">15.</span>
              </span> 
<div id="Ch1.I1.i15.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">Blepharisma Macronuclear</span>
                </p>
</div>
</li>
<li id="Ch1.I1.i16" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
                <span class="ltx_text" style="font-size:90%;">16.</span>
              </span> 
<div id="Ch1.I1.i16.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">Chlorophycean Mitochondrial</span>
                </p>
</div>
</li>
<li id="Ch1.I1.i21" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
                <span class="ltx_text" style="font-size:90%;">21.</span>
              </span> 
<div id="Ch1.I1.i21.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">Trematode Mitochondrial</span>
                </p>
</div>
</li>
<li id="Ch1.I1.i22" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
                <span class="ltx_text" style="font-size:90%;">22.</span>
              </span> 
<div id="Ch1.I1.i22.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">Scenedesmus obliquus</span>
                </p>
</div>
</li>
<li id="Ch1.I1.i23" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
                <span class="ltx_text" style="font-size:90%;">23.</span>
              </span> 
<div id="Ch1.I1.i23.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">Thraustochytrium Mitochondrial</span>
                </p>
</div>
</li>
</ol>
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">sixpack</span>コマンドで出力されるファイルのうち、FASTA形式配列の方を開くと、入力ファイルの1つ目の配列で順方向3フレーム、逆方向3フレームの全6フレームでの翻訳がなされた結果得られたopen reading frame (ORF)の配列が保存されています。ORFとは、開始コドンから終止コドンまでの配列です(ここでは実際には終止コドンで区切っただけの配列となっています)。これが最も長くなるのが正しい翻訳結果と考えられます。<span class="ltx_text ltx_font_typewriter">sixpack</span>コマンドで出力されるもう一つのファイルには、入力ファイルの1つ目の配列で6フレーム翻訳を行った結果がテキストエディタで見やすく出力されていますのでこちらでも確認できます。末尾に6フレームそれぞれでできるORF数がありますので、これが少ない方が正しい可能性が高いでしょう。もし読み枠が逆方向だったら、<span class="ltx_text ltx_font_typewriter">revseq</span>コマンドで必要に応じて逆相補配列に変換することができます。</p>
</div>
<div id="Ch1.S4.SS1.p3" class="ltx_para">
<p class="ltx_p">ファイルに含まれる塩基配列が複数あり、その解読方向が統一されていない場合には、Phylogearsの<span class="ltx_text ltx_font_typewriter">pgstanstrand</span>コマンドによって先頭の配列と同じ方向に揃ったファイルを得ることができます。以下のように使用して下さい。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgstanstrand 入力ファイル 出力ファイル↓</span>
          </p>
<p class="ltx_p">ただし、このコマンドはFASTA形式にしか対応していませんのでご注意下さい。</p>
</div>
<div id="Ch1.S4.SS1.p4" class="ltx_para">
<p class="ltx_p">正しくコドン位置を揃えることができたら、そのファイルから以下のようにEMBOSSの<span class="ltx_text ltx_font_typewriter">degapseq</span>コマンドでギャップを除去してやります。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; degapseq 入力ファイル 出力ファイル↓</span>
          </p>
<p class="ltx_p">ギャップを除去したら、以下のようにEMBOSSの<span class="ltx_text ltx_font_typewriter">transeq</span>コマンドを用いてアミノ酸配列に翻訳してやります。ここでもstandard以外の遺伝暗号の場合は<span class="ltx_text ltx_font_typewriter">-table</span>オプションで遺伝暗号を指定してやって下さい。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; transeq 入力ファイル 出力ファイル↓</span>
          </p>
<p class="ltx_p">翻訳したアミノ酸配列ファイルを念のためテキストエディタや多重配列エディタで開いて確認したら、以下のようにMAFFTで整列します。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; mafft --auto 入力ファイル &gt; 出力ファイル↓</span>
          </p>
<p class="ltx_p">そして、最後にEMBOSSの<span class="ltx_text ltx_font_typewriter">tranalign</span>コマンドでアミノ酸配列から元の塩基配列へ逆翻訳してやります。ここでもstandard以外の遺伝暗号の場合は<span class="ltx_text ltx_font_typewriter">-table</span>オプションで遺伝暗号を指示する必要があります。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; tranalign 未整列塩基配列ファイル 整列済アミノ酸配列ファイル 出力ファイル↓</span>
          </p>
<p class="ltx_p">なお、ここで述べたようにアミノ酸配列の整列に合わせて塩基配列を整列することが常に良いとは限りません。複数回のフレームシフトが起きている場合には塩基のまま整列した方が良いこともあります。そのため、塩基のまま整列した結果と必ず比較して確認するようにして下さい。また、読み間違いに起因すると思われるindelが存在する場合には、一時的に仮の塩基を挿入して整列してから、最終的なファイルでその塩基を<span class="ltx_text ltx_font_typewriter">?</span>や<span class="ltx_text ltx_font_typewriter">-</span>にする必要があります。</p>
</div>
</section>
</section>
<section id="Ch1.S5" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1.5 </span>分子系統樹推定に不適な領域の除去</h3>

<div id="Ch1.S5.p1" class="ltx_para">
<p class="ltx_p">大抵の整列した配列データには、そのままでは分子系統樹推定に不適な部位を含んでいます。そのため、そのような部位を除去してから系統樹推定に用いる必要があります。ここでは系統樹推定に適している・適していないとはどういうデータかを説明した上で、その他の注意点を述べます。</p>
</div>
<section id="Ch1.S5.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.5.1 </span>オルソロガスとパラロガス</h4>

<div id="Ch1.S5.SS1.p1" class="ltx_para">
<p class="ltx_p">整列によって得られた相同(homologous)な配列データセットでも、系統樹推定に使えるとは限りません。例えば図<a href="#Ch1.F1" title="図 1.1 ‣ 1.5.1 オルソロガスとパラロガス ‣ 1.5 分子系統樹推定に不適な領域の除去 ‣ 第1章 配列データセットの作成 ‣ 分子系統学演習 データセットの作成から仮説検定まで" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1.1</span></a>のようにY locusとZ locusが遺伝子重複によって生じた場合を想定すると、Taxon AのY locusとTaxon BのY locus、Taxon CのZ locusは相同ではありますが、正しい系統関係(Taxon BとTaxon Cが単系統でTaxon Aはその外側)を推定することはできません。このような関係をパラロガス(paralogous)と言います。それに対してそれぞれのY locusどうしやZ locusどうしの関係はオルソロガス(orthologous)と呼ばれています。系統樹推定には、オルソロガスなデータセットを用いなければなりません。ですから、遺伝子重複が起きたことが分かっている領域はできるだけ系統樹推定には使わない方が無難です。ただし、重複した遺伝子の全配列を全てのOTUで揃えれば、正しい系統樹を推定可能です。ある程度なら配列が欠けていても何とかなる場合もあるでしょう。</p>
</div>
<figure id="Ch1.F1" class="ltx_figure">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">図 1.1: </span>オルソロガスとパラロガスの例</figcaption><img src="x1.png" id="Ch1.F1.g1" class="ltx_graphics ltx_centering" width="676" height="378" alt="">
</figure>
<div id="Ch1.S5.SS1.p2" class="ltx_para">
<p class="ltx_p">問題は遺伝子重複が起きたかどうかをどうやって知るかですが、これは近縁種で全ゲノムデータが得られていれば、ゲノム内BLASTで一致度の高い複数の領域が見つからないことを確認すればよいでしょう。BLASTの方が確実だと思いますが、Ensembl genome browserに登録されていれば、こちらでも確認することができます。Ensemblのサイトは以下のURLからアクセスして下さい。
<br class="ltx_break"><a href="http://www.ensembl.org/" title="" class="ltx_ref">http://www.ensembl.org/</a></p>
</div>
<div id="Ch1.S5.SS1.p3" class="ltx_para">
<p class="ltx_p">近縁種のゲノムで重複が見つからないからといってオルソロガスとは言い切れませんが、これ以上は確認のしようがないので致し方ないでしょう。より多くの領域を用いて系統樹推定することで信頼性を担保する以外に無いと思います。</p>
</div>
<div id="Ch1.S5.SS1.p4" class="ltx_para">
<p class="ltx_p">その他、incomplete lineage sortingや遺伝子水平伝播によっても、遺伝子の系統樹が種の系統樹と異なってしまうことがあります。例えばαとβが近縁(単系統)でγはその外に位置する系統関係にある3種α・β・γがいるとき、共通祖先時代に既に分化していた対立遺伝子A・aがあるとします。αとγではAが偶然固定し、βではaが偶然固定したとすると、Aとaの配列に基づく系統樹ではαとγが近縁(単系統)になってしまいます。これがincomplete lineage sortingです。また、incomplete lineage sortingによって生じた類似性をhemiplasyと言います<cite class="ltx_cite"><a href="#bib.bib9" title="" class="ltx_ref">(Avise and Robinson, 2008)</a></cite>。全くの別系統で収斂や平行進化で生じる類似性をhomoplasyと言いますが、それに合わせて最近提案された用語です。遺伝子水平伝播はその名の通り、何らかの作用によりある生物の遺伝子が、全く別系統の生物のゲノム内に取り込まれてしまうことです。この場合も遺伝子の系統樹は種の系統樹と一致しなくなってしまいます。</p>
</div>
</section>
<section id="Ch1.S5.SS2" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.5.2 </span>仮定を満たしていないデータ</h4>

<div id="Ch1.S5.SS2.p1" class="ltx_para">
<p class="ltx_p">分子系統樹推定は、様々な仮定を置いて適当にでっち上げた基準で系統樹を評価し、最も良いものを選ぶというものです。ですから、基準そのものの妥当性はさておき、その基準できちんと評価をするにはデータが仮定を満たしている必要があります。この仮定は、最節約法よりも最尤法やベイズ法などのモデルベースの方法の方がより多くなっています。</p>
</div>
<div id="Ch1.S5.SS2.p2" class="ltx_para">
<p class="ltx_p">まず、全ての方法で共通な仮定として、「1座位の塩基・アミノ酸から1座位の塩基・アミノ酸への変異しか含まない」というものがあります(コドン置換モデルの場合は「1つのコドンから1つのコドン」)。分子進化モデルは1座位のアミノ酸から複数座位のアミノ酸への変異など想定していませんし、この仮定を満たしていないと最節約法でも変化の回数を過大評価してしまいます。具体的には、開始・終止コドンから別のコドンへの変異とその逆(1コドンから複数コドンへの変異とその逆)、イントロン両端のスプライセオソーム認識配列から別の配列への変異とその逆(非コード配列＝0コドンから複数コドンへの変異とその逆)、フレームシフト・逆位(複数座位から複数座位への変異)、挿入・欠失(無から有とその逆)がそれに当たります。ただし、挿入・欠失は整列が信頼できるならギャップをただのmissing dataとして取り扱うことで対処できます(ほとんどのソフトウェアがそういう実装になっています)。最節約法では、ギャップを第5 (アミノ酸では第21)の形質状態として取り扱うことも可能ですが、一度の挿入・欠失で生じた連続したギャップが、複数回の挿入・欠失で生じたと解釈されてしまうため、おすすめできません。</p>
</div>
<div id="Ch1.S5.SS2.p3" class="ltx_para">
<p class="ltx_p">次に、モデルベースの方法が仮定しているものとして「系統樹上で分子進化パターンが共通である」というものがあります。現状の分子系統樹推定法では系統樹全体で共通の分子進化モデルを当てはめているからです。ただ、そのような仮定をせずに系統樹上で分子進化モデルを変化させることが可能な推定方法もあるにはある<cite class="ltx_cite"><a href="#bib.bib12" title="" class="ltx_ref">(例えば Boussau and Gouy, 2006; Blanquart and Lartillot, <a href="#bib.bib10" title="" class="ltx_ref">2006</a>, <a href="#bib.bib11" title="" class="ltx_ref">2008</a>, など)</a></cite>のですが、計算量が膨大だったりするため現状ではほとんど使われていません。遺伝暗号やコドン使用頻度がOTU間で共通でないタンパクコード塩基配列はこれらの仮定を満たしていない可能性が極めて高いのでそのようなデータからモデルベースの方法で系統樹推定を行うのは避けた方が良いでしょう。また、塩基・アミノ酸頻度がOTU間で共通でない塩基・アミノ酸配列も同様です。塩基・アミノ酸頻度がOTU間で共通でない塩基・アミノ酸配列は、RY coding <cite class="ltx_cite"><a href="#bib.bib72" title="" class="ltx_ref">(Woese <span class="ltx_text ltx_font_italic">et al</span>., 1991)</a></cite>やDayhoff coding <cite class="ltx_cite"><a href="#bib.bib26" title="" class="ltx_ref">(Hrdy <span class="ltx_text ltx_font_italic">et al</span>., 2004)</a></cite>を用いて情報を多少捨ててでも無理矢理塩基・アミノ酸頻度を共通にしてしまうか、不均質モデル<cite class="ltx_cite"><a href="#bib.bib10" title="" class="ltx_ref">(Blanquart and Lartillot, 2006, <a href="#bib.bib11" title="" class="ltx_ref">2008</a>)</a></cite>を当てはめれば解析は可能です。</p>
</div>
<div id="Ch1.S5.SS2.p4" class="ltx_para">
<p class="ltx_p">最後に、既に述べたことともやや重複しますが、同じ分子進化モデルを当てはめた座位間では同じ分子進化パターンに従っていなくてはなりません。ですから、座位ごとに分子進化パターンが異なると予想される場合(異なる遺伝子座など)には、異なる分子進化モデルを各座位に当てはめるべきです。しかし、異なる分子進化モデルを当てはめれば推定しなくてはならないパラメータが増加してしまいます。開始・終止コドンや、複数の遺伝子に共有されている座位の配列は他とは明らかに異なる選択圧にさらされているはずですから、当然分子進化パターンは異なると予想されます。とは言え、わざわざパラメータ数を増やしてまで異なるモデルを当てはめるほどの情報量は持っていないでしょうから、そのような座位は捨てた方が無難でしょう。</p>
</div>
</section>
<section id="Ch1.S5.SS3" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.5.3 </span>整列の信頼できない座位</h4>

<div id="Ch1.S5.SS3.p1" class="ltx_para">
<p class="ltx_p">偽遺伝子や遺伝子間領域、イントロン、rRNA/tRNAのloop領域などの欠失や挿入の多い配列では、整列の信頼性が低くなってしまいます。誤って整列された座位は、系統樹推定の際のノイズとなってしまうため、除去した方がよいと言われています<cite class="ltx_cite"><a href="#bib.bib63" title="" class="ltx_ref">(Talavera and Castresana, 2007)</a></cite>。これまでのところ、そのような処理が研究者の経験と勘でなされることが多かったのですが、近年になって自動的に行ってくれるソフトウェアが登場してきました。それがGblocks <cite class="ltx_cite"><a href="#bib.bib15" title="" class="ltx_ref">(Castresana, 2000)</a></cite>・trimAl <cite class="ltx_cite"><a href="#bib.bib14" title="" class="ltx_ref">(Capella-Gutiérrez <span class="ltx_text ltx_font_italic">et al</span>., 2009)</a></cite>・Aliscore <cite class="ltx_cite"><a href="#bib.bib45" title="" class="ltx_ref">(Misof and Misof, 2009)</a></cite>・BMGE <cite class="ltx_cite"><a href="#bib.bib17" title="" class="ltx_ref">(Criscuolo and Gribaldo, 2010)</a></cite>です。ここではtrimAlを用いて整列の信頼できない座位をトリミングする手順を説明します。</p>
</div>
<div id="Ch1.S5.SS3.p2" class="ltx_para">
<p class="ltx_p">trimAlが対応している入力ファイル形式はPHYLIP・FASTA・NEXUSなどです。trimAlでは、様々なパラメータをユーザーが設定することもできますが、ギャップをそれなりに残す設定とギャップを残さない設定、さらにその2つからデータに応じて自動的に選択させることもできます。それぞれの設定によるトリミングは以下のようにして行います。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; trimal -gappyout -in 入力ファイル -out 出力ファイル↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; trimal -strict -in 入力ファイル -out 出力ファイル↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; trimal -automated1 -in 入力ファイル -out 出力ファイル↓</span>
            </span>
</p>
<p class="ltx_p">ただし、タンパクコード塩基配列では読み枠がずれないように、コドン単位でのトリミングをする必要があります。trimAlはそこまで考えて処理をしてくれませんが、Phylogears2の<span class="ltx_text ltx_font_typewriter">pgtrimal</span>コマンドを用いることでそれが可能です。<span class="ltx_text ltx_font_typewriter">pgtrimal</span>は内部でtrimAlを呼び出して除去しない座位を得た上で、読み枠がずれないように除去する範囲を拡大します。入力ファイルはNEXUS形式でなくてはなりません。以下のようにして用います。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgtrimal --frame=1 --method=gappyout 入力ファイル 出力ファイル↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgtrimal --frame=1 --method=strict 入力ファイル 出力ファイル↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgtrimal --frame=1 --method=automated1 入力ファイル 出力ファイル↓</span>
            </span>
</p>
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">pgtrimal</span>は<span class="ltx_text ltx_font_typewriter">--frame</span>オプションがあると入力ファイルをタンパクコード塩基配列として扱います。<span class="ltx_text ltx_font_typewriter">--frame=1</span>は配列の1塩基目が第1コドン位置であるという意味です。<span class="ltx_text ltx_font_typewriter">--frame=2</span>であれば2塩基目が、<span class="ltx_text ltx_font_typewriter">--frame=3</span>であれば3塩基目が第1コドン位置であるということになります。</p>
</div>
</section>
<section id="Ch1.S5.SS4" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.5.4 </span>その他の注意点</h4>

<div id="Ch1.S5.SS4.p1" class="ltx_para">
<p class="ltx_p">塩基配列データは、昔はRI、現在は蛍光や電位の変化を検出することで得ているはずです。そのようなデータは、検出されたシグナル強度の波形から読み取られているでしょう。しかし、しばしば波形が重なっていてどの塩基か特定できないことがあります。特に核ゲノムの配列をクローニングせずに直接読んでいる場合にヘテロな個体でよくあることだと思います。このような場合、解析ソフトは表<a href="#Ch1.T1" title="表 1.1 ‣ 1.5.4 その他の注意点 ‣ 1.5 分子系統樹推定に不適な領域の除去 ‣ 第1章 配列データセットの作成 ‣ 分子系統学演習 データセットの作成から仮説検定まで" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1.1</span></a>のような縮重コード表記を考慮してくれますので、何でもすぐに<span class="ltx_text ltx_font_typewriter">N</span>にせずに<span class="ltx_text ltx_font_typewriter">R</span>や<span class="ltx_text ltx_font_typewriter">Y</span>も積極的に用いた方が良いと思います。ただし、そのような不確実なデータを使わないのが最も安全ではあります。また、ギャップやギャップかどうかもよく分からないmissing dataはそれぞれ<span class="ltx_text ltx_font_typewriter">-</span>・<span class="ltx_text ltx_font_typewriter">?</span>として区別できるようにしておいた方が良いでしょう。</p>
</div>
<figure id="Ch1.T1" class="ltx_table">
<table class="ltx_tabular ltx_centering ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_center">
                  <span class="ltx_text" style="font-size:80%;">文字</span>
                </th>
<th class="ltx_td ltx_align_left">
                  <span class="ltx_text" style="font-size:80%;">意味</span>
                </th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_center ltx_border_tt">
                  <span class="ltx_text" style="font-size:80%;">M</span>
                </th>
<td class="ltx_td ltx_align_left ltx_border_tt">
                  <span class="ltx_text" style="font-size:80%;">A or C (amino)</span>
                </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_center">
                  <span class="ltx_text" style="font-size:80%;">R</span>
                </th>
<td class="ltx_td ltx_align_left">
                  <span class="ltx_text" style="font-size:80%;">A or G (purine)</span>
                </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_center">
                  <span class="ltx_text" style="font-size:80%;">W</span>
                </th>
<td class="ltx_td ltx_align_left">
                  <span class="ltx_text" style="font-size:80%;">A or T</span>
                </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_center">
                  <span class="ltx_text" style="font-size:80%;">S</span>
                </th>
<td class="ltx_td ltx_align_left">
                  <span class="ltx_text" style="font-size:80%;">C or G</span>
                </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_center">
                  <span class="ltx_text" style="font-size:80%;">Y</span>
                </th>
<td class="ltx_td ltx_align_left">
                  <span class="ltx_text" style="font-size:80%;">C or T (pyrimidine)</span>
                </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_center">
                  <span class="ltx_text" style="font-size:80%;">K</span>
                </th>
<td class="ltx_td ltx_align_left">
                  <span class="ltx_text" style="font-size:80%;">G or T (keto)</span>
                </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_center">
                  <span class="ltx_text" style="font-size:80%;">V</span>
                </th>
<td class="ltx_td ltx_align_left">
                  <span class="ltx_text" style="font-size:80%;">A or C or G</span>
                </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_center">
                  <span class="ltx_text" style="font-size:80%;">H</span>
                </th>
<td class="ltx_td ltx_align_left">
                  <span class="ltx_text" style="font-size:80%;">A or C or T</span>
                </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_center">
                  <span class="ltx_text" style="font-size:80%;">D</span>
                </th>
<td class="ltx_td ltx_align_left">
                  <span class="ltx_text" style="font-size:80%;">A or G or T</span>
                </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_center">
                  <span class="ltx_text" style="font-size:80%;">B</span>
                </th>
<td class="ltx_td ltx_align_left">
                  <span class="ltx_text" style="font-size:80%;">C or G or T</span>
                </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_center">
                  <span class="ltx_text" style="font-size:80%;">N</span>
                </th>
<td class="ltx_td ltx_align_left">
                  <span class="ltx_text" style="font-size:80%;">A or C or G or T</span>
                </td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">表 1.1: </span>塩基の縮重コード表記</figcaption>
</figure>
<div id="Ch1.S5.SS4.p2" class="ltx_para">
<p class="ltx_p">タンパクコード塩基配列の編集の際には、必ず読み枠と翻訳後のアミノ酸配列が変化しないように注意して下さい。読み枠がずれると、コドン位置ごとの異なるモデルの当てはめがうまくいきません。第2・3コドン位置と次のコドンの第1コドン位置を削除すると、読み枠はずれませんが、後になってアミノ酸配列に変換する必要が生じたときやコドン置換モデルを当てはめようとした場合にうまくいかなくなってしまいますし、ケアレスミスの元なのでこれも避けるべきです。</p>
</div>
<div id="Ch1.S5.SS4.p3" class="ltx_para">
<p class="ltx_p">配列の編集では、削除した座位がすぐに分かるように記録を残しておくとやり直したり削除した座位を確認したりする際に役立ち、ミスを防いだりミスに気付きやすくなります。実際に解析に用いる配列ファイルとは別に、削除した座位を<span class="ltx_text ltx_font_typewriter">[]</span>などで囲んだファイルを別に保存しておくとよいでしょう。グラフィカルインターフェイスを持った多重整列エディタは便利ですが、そのような記録を残す機能を持っていないものがほとんどでしょうから、個人的には画面内に収まるように配列を折り返したinterleaved形式で保存したファイルをテキストエディタで編集するのが最も良いと思います。多重整列エディタで編集したい場合は、少なくとも何も削除していないファイルも保存しておき、削除後のファイルの配列と比較すればすぐに削除した部分が分かるようにしておくべきでしょう。</p>
</div>
<div id="Ch1.S5.SS4.p4" class="ltx_para">
<p class="ltx_p">また、この先用いる解析ソフトでは、配列名には半角英数字とアンダースコア(<span class="ltx_text ltx_font_typewriter">_</span>)しか使わない方が無難です。他の文字列を用いていたら、必ず別の配列が同一の名前にならないように注意しながら削除しておきます。形質が最初の配列と同じであることをピリオド(<span class="ltx_text ltx_font_typewriter">.</span>)で表す方法がありますが、これも使わない方が安全です。対応したソフトで別形式で書き出すなどして無くしておきましょう。ファイル名にも注意が必要です。やはり半角英数字とアンダースコアしか使わないようにした方が良いでしょう。</p>
</div>
</section>
</section>
<section id="Ch1.S6" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1.6 </span>配列が完全一致するOTUの除去</h3>

<div id="Ch1.S6.p1" class="ltx_para">
<p class="ltx_p">系統解析では配列が完全に一致する複数のOTU (系統樹末端の生物およびその配列)を含んでいると、そのOTUが他のOTUより大きく評価されることになり、推定結果に悪影響を及ぼしてしまいます。これをnode density artifactと言います<cite class="ltx_cite"><a href="#bib.bib70" title="" class="ltx_ref">(Webster <span class="ltx_text ltx_font_italic">et al</span>., 2003; Venditti <span class="ltx_text ltx_font_italic">et al</span>., <a href="#bib.bib69" title="" class="ltx_ref">2006</a>)</a></cite>。そのため、完全一致する配列はただ1つを残して他は除いておく必要があります。Phylogears2の<span class="ltx_text ltx_font_typewriter">pgelimdupseq</span>コマンドを用いることで簡単に処理できます。以下のように用います。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgelimdupseq --type=DNA 入力ファイル 出力ファイル↓</span>
        </p>
<p class="ltx_p">アミノ酸配列では<span class="ltx_text ltx_font_typewriter">--type=DNA</span>の代わりに<span class="ltx_text ltx_font_typewriter">--type=AA</span>を指定して下さい。これによって完全一致する配列はただ1つを残して取り除かれます。残される配列の配列名(OTU名)は、除去された配列の名前を2連続のアンダースコア「<span class="ltx_text ltx_font_typewriter">__</span>」で連結したものとなります。FASTA・NEXUS・PHYLIP・extended PHYLIP・Treefinder形式の入力ファイルに対応しています。ただし、PHYLIP形式は配列名が10文字までしか使えませんので特殊な処理を行っています。</p>
</div>
<div id="Ch1.S6.p2" class="ltx_para">
<p class="ltx_p">ここで、縮重コード文字の取り扱いが問題になってきます。塩基配列では「<span class="ltx_text ltx_font_typewriter">A</span>または<span class="ltx_text ltx_font_typewriter">G</span>」という意味で「<span class="ltx_text ltx_font_typewriter">R</span>」を用います。「<span class="ltx_text ltx_font_typewriter">A</span>または<span class="ltx_text ltx_font_typewriter">C</span>または<span class="ltx_text ltx_font_typewriter">G</span>または<span class="ltx_text ltx_font_typewriter">T</span>」の場合は「<span class="ltx_text ltx_font_typewriter">N</span>」となります。この縮重コード文字がデータに含まれているときに、縮重コード文字をそのままにして全形質が一致しているものだけを完全一致配列とするのか、縮重コード文字を本来の意味通り「<span class="ltx_text ltx_font_typewriter">A</span>または<span class="ltx_text ltx_font_typewriter">G</span>」などと解釈して完全一致配列を探すのか、がまず問題となります。筆者の個人的な意見では後者が妥当であろうと思います。</p>
</div>
<div id="Ch1.S6.p3" class="ltx_para">
<p class="ltx_p">後者を採用した場合、残す配列では形質を「<span class="ltx_text ltx_font_typewriter">A</span>」とするのか「<span class="ltx_text ltx_font_typewriter">R</span>」とするのかがさらなる問題となります。例えば「<span class="ltx_text ltx_font_typewriter">AAA</span>」と「<span class="ltx_text ltx_font_typewriter">ARA</span>」という配列があった場合、これらは完全一致となりますが、どちらを残すべきかということです。「<span class="ltx_text ltx_font_typewriter">R</span>」が塩基配列決定の信頼性が低いために「<span class="ltx_text ltx_font_typewriter">R</span>」とされているなら、残すのは「<span class="ltx_text ltx_font_typewriter">AAA</span>」でよいでしょう。「<span class="ltx_text ltx_font_typewriter">R</span>」となっている原因がノイズであり、ノイズを捨てることは何ら問題ではないからです。しかし、核DNAを多数クローンで配列決定を行いコンセンサス配列をデータとしている、または核DNAをクローニングせずに直接配列決定して「<span class="ltx_text ltx_font_typewriter">A</span>」と「<span class="ltx_text ltx_font_typewriter">G</span>」の両方のシグナルが検出されたために「<span class="ltx_text ltx_font_typewriter">R</span>」としているのであれば、「<span class="ltx_text ltx_font_typewriter">ARA</span>」にすべきかもしれません。「<span class="ltx_text ltx_font_typewriter">R</span>」はノイズによるのではなく意味があるのですから。ただし、「<span class="ltx_text ltx_font_typewriter">R</span>」には意味があるというのであれば、(あまり好ましくありませんが)「<span class="ltx_text ltx_font_typewriter">AAA</span>」と「<span class="ltx_text ltx_font_typewriter">ARA</span>」はやはり両方残すべきということになるかもしれません。<span class="ltx_text ltx_font_typewriter">pgelimdupseq</span>は、標準では「<span class="ltx_text ltx_font_typewriter">AAA</span>」を残します。「<span class="ltx_text ltx_font_typewriter">ARA</span>」を残したい場合は<span class="ltx_text ltx_font_typewriter">--prefer=degenerate</span>というオプションを入力ファイル名の前に付けて実行して下さい。両方を残したい場合は<span class="ltx_text ltx_font_typewriter">--prefer=both</span>とします。筆者は<span class="ltx_text ltx_font_typewriter">pgelimdupseq</span>の標準設定を強く推奨します。なお、<span class="ltx_text ltx_font_typewriter">pgelimdupseq</span>はギャップを意味する「<span class="ltx_text ltx_font_typewriter">-</span>」を「<span class="ltx_text ltx_font_typewriter">?</span>」 (missing data,「<span class="ltx_text ltx_font_typewriter">-</span>または<span class="ltx_text ltx_font_typewriter">N</span>」の意)として取り扱います。ギャップを意味のある形質として取り扱うには、<span class="ltx_text ltx_font_typewriter">--gap=another</span>をオプションとして指定します。</p>
</div>
<div id="Ch1.S6.p4" class="ltx_para">
<p class="ltx_p">なお、完全一致しない場合でも、ごく近縁な配列が一部の系統でのみやたらと密にサンプリングされている場合にも、同一配列が複数登録されているのと同様の効果を発揮してしまいます。したがって、全種をサンプリングするのが必ずしも良くないこともあり得ます。理想的なのは、系統樹上の「分岐点密度」が全体に均一である、あるいは全ての枝の長さが均一であることです。実際にはほとんどそんなことはないでしょうが、できればそのようにタクソンサンプリングがなされることが望ましいでしょう。</p>
</div>
</section>
<section id="Ch1.S7" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1.7 </span>塩基・アミノ酸組成の均一性の検定とデータ改変による均一化</h3>

<div id="Ch1.S7.p1" class="ltx_para">
<p class="ltx_p">ほとんどの分子進化モデルでは、塩基組成やアミノ酸組成はOTU間で均一であることが仮定されています。ですから、解析対象のデータがその仮定を満たしているかどうかは解析結果に大きな影響を及ぼします。塩基組成やアミノ酸組成がOTU間で均一でない場合、本当は単系統ではないOTU群の単系統性が非常に強く支持されてしまうことがしばしばあります。そのような、仮定を満たしていないデータに基づいてあり得ない単系統性を見いだしている論文が公表されることが未だに後を絶ちません。データ配列において塩基組成・アミノ酸組成の均一性が棄却されないことを確認しておけば、そのような論文を公表せずに済むはずです。Kakusan4・Aminosanもモデル選択前にこの検定を行いますが、Phylogears2に含まれている<span class="ltx_text ltx_font_typewriter">pgtestcomposition</span>を用いることで、検定だけを行うことができます。</p>
</div>
<div id="Ch1.S7.p2" class="ltx_para">
<p class="ltx_p">組成の均一性を検証するにはいくつかの方法がありますが、<span class="ltx_text ltx_font_typewriter">pgtestcomposition</span>ではχ二乗統計量を用いた独立性の検定を利用します。「組成は均一である」が帰無仮説です。これはPAUP*<cite class="ltx_cite"><a href="#bib.bib61" title="" class="ltx_ref">(Swofford, 2003)</a></cite>の<span class="ltx_text ltx_font_typewriter">BaseFreqs</span>コマンドに実装されているのと同じ方法です。ただしPAUP*では塩基配列にしか適用できませんが<span class="ltx_text ltx_font_typewriter">pgtestcomposition</span>ではアミノ酸配列にも適用できます。また、PAUP*は「<span class="ltx_text ltx_font_typewriter">R</span>」なら「<span class="ltx_text ltx_font_typewriter">A</span>」と「<span class="ltx_text ltx_font_typewriter">G</span>」がそれぞれ0.5回出現などとしてカウントすることで、縮重コード文字を検定統計量の算出に利用しますが、<span class="ltx_text ltx_font_typewriter">pgtestcomposition</span>は縮重コード文字を一切用いません。この検定法よりも良いとされているBowkerの検定というものもあります<cite class="ltx_cite"><a href="#bib.bib2" title="" class="ltx_ref">(Ababneh <span class="ltx_text ltx_font_italic">et al</span>., 2006)</a></cite>が、その方法ではある条件下では<span class="ltx_text ltx_font_italic">p</span>値を算出できず、その条件を満たすデータがしばしばあるため今のところは独立性の検定を利用しています。<span class="ltx_text ltx_font_typewriter">pgtestcomposition</span>でこの検定を行うには、以下のようにコマンドを実行します。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgtestcomposition --type=DNA 入力ファイル 出力ファイル↓</span>
        </p>
<p class="ltx_p">アミノ酸配列では<span class="ltx_text ltx_font_typewriter">--type=DNA</span>を<span class="ltx_text ltx_font_typewriter">--type=AA</span>に置き換えて下さい。対応している入力ファイル形式はFASTA・NEXUS・PHYLIP・extended PHYLIP・Treefinderです。出力ファイルには以下のような情報が出力されます。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| Type of Nucleotides: 4</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| Number of Taxa: 8</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| Degree of Freedom: 21</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| Total Count: 15994</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| Chi-square Statistic: 3.62583123080048</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| p-value: 0.99999</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|               A       C       G       T       rtotal</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| OTU名       781     163     234     821         1999</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|          770.65  171.73  236.22  820.40</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| 略</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| ctotal     6166    1374    1890    6564        15994</span>
          </span>
</p>
<p class="ltx_p">もしも均一性が棄却されてしまった場合、データを改変することで無理矢理均一化してしまうか、組成の不均一性を許容するモデル<cite class="ltx_cite"><a href="#bib.bib10" title="" class="ltx_ref">(Blanquart and Lartillot, 2006, <a href="#bib.bib11" title="" class="ltx_ref">2008</a>)</a></cite>を適用した解析を行う必要があります。また、データによっては正確な<span class="ltx_text ltx_font_italic">p</span>値が算出できないものがあります<cite class="ltx_cite"><a href="#bib.bib16" title="" class="ltx_ref">(Cochran, 1954)</a></cite>。そのようなデータではファイルの末尾にその旨が出力されます。また、この方法では配列が長い場合には過剰に均一性が棄却されやすくなってしまいますので、そのようなデータの取り扱いには注意が必要です。</p>
</div>
<div id="Ch1.S7.p3" class="ltx_para">
<p class="ltx_p">タンパクコード塩基配列データの第3コドン位置や、多遺伝子座配列データのある1遺伝子座といった、データの一部分のみに範囲を絞って検定を行うこともできます。例えば以下のコマンドでは、入力ファイルの1～100塩基目の範囲だけで検定を行います。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgtestcomposition --type=DNA "1-100" 入力ファイル 出力ファイル↓</span>
        </p>
<p class="ltx_p">第3コドン位置のみを対象としたい場合には以下のようにします。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgtestcomposition --type=DNA "3-.\3" 入力ファイル 出力ファイル↓</span>
        </p>
<p class="ltx_p">ここで、<span class="ltx_text ltx_font_typewriter">3-.\3</span>は、3塩基目から末尾までの範囲において3塩基ごとに(2塩基間隔で)対象となる座位を選択するという意味です。なお、LinuxやMac OS Xなどのターミナル上では、<span class="ltx_text ltx_font_typewriter">3-.\3</span>をダブルクオートまたはシングルクオートで囲むか、<span class="ltx_text ltx_font_typewriter">3-.\\3</span>とタイプする必要があります。これは、ターミナル上ではクオートされていない<span class="ltx_text ltx_font_typewriter">\</span>は特殊な意味のある文字だからです。ただし<span class="ltx_text ltx_font_typewriter">\\</span>と記述することでコマンドに<span class="ltx_text ltx_font_typewriter">\</span>を含む文字列を渡すことができます。同様に、<span class="ltx_text ltx_font_typewriter">?</span>や<span class="ltx_text ltx_font_typewriter">*</span>もターミナルでは特殊な意味があるので、コマンドにそのまま渡すにはクオートしておくか<span class="ltx_text ltx_font_typewriter">\</span>を直前に付ける(これを「エスケープする」と言う)必要があります。</p>
</div>
<div id="Ch1.S7.p4" class="ltx_para">
<p class="ltx_p">組成の均一性が棄却されてしまった場合、データを改変することで無理矢理均一化することができます。代表的な方法にRYコーディング<cite class="ltx_cite"><a href="#bib.bib72" title="" class="ltx_ref">(Woese <span class="ltx_text ltx_font_italic">et al</span>., 1991)</a></cite>があります。RYコーディングは、塩基配列を対象としたデータ変換の方法です。塩基配列において組成が不均一なのは、ATとGCの比率がOTUによって異なるためであることがよくあります。このようなデータであっても、AGとCTの比率ははOTU間で均一になっている場合があります。これを利用すれば、形質状態を表す文字を「<span class="ltx_text ltx_font_typewriter">A</span>または<span class="ltx_text ltx_font_typewriter">G</span>」(つまり「<span class="ltx_text ltx_font_typewriter">R</span>」)を表す文字と、「<span class="ltx_text ltx_font_typewriter">T</span>または<span class="ltx_text ltx_font_typewriter">C</span>」(つまり「<span class="ltx_text ltx_font_typewriter">Y</span>」)を表す文字の2つだけにしてしまうことで、組成を均一化できます。この方法では<span class="ltx_text ltx_font_typewriter">AG</span>間、および<span class="ltx_text ltx_font_typewriter">TC</span>間の変異の情報は捨ててしまうことになりますが、従来の系統樹推定法をそのまま利用できます。Phylogears2では、<span class="ltx_text ltx_font_typewriter">pgrecodeseq</span>コマンドを用いることでこの処理が容易に可能です。以下のコマンドを実行することで、RYコーディングを適用した配列を得ることができます。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgrecodeseq --type=DNA "CG-TA" 入力ファイル 出力ファイル↓</span>
        </p>
<p class="ltx_p">このコマンドを実行すると、「<span class="ltx_text ltx_font_typewriter">C</span>」は「<span class="ltx_text ltx_font_typewriter">T</span>」へ、「<span class="ltx_text ltx_font_typewriter">G</span>」は「<span class="ltx_text ltx_font_typewriter">A</span>」へそれぞれ置換された配列が出力されます。このため、配列は「<span class="ltx_text ltx_font_typewriter">A</span>」と「<span class="ltx_text ltx_font_typewriter">T</span>」の2文字だけになります(ただし縮重コード文字や「<span class="ltx_text ltx_font_typewriter">-</span>」と「<span class="ltx_text ltx_font_typewriter">?</span>」は除く)。<span class="ltx_text ltx_font_typewriter">RY</span>の2文字になるわけではありませんが、効果は同じです。<span class="ltx_text ltx_font_typewriter">CG-TA</span>の代わりに<span class="ltx_text ltx_font_typewriter">C-T</span>を指定すれば、「<span class="ltx_text ltx_font_typewriter">C</span>」が「<span class="ltx_text ltx_font_typewriter">T</span>」へ置換されるだけなので、AGYコーディングということになります。対応している入力ファイル形式はFASTA・NEXUS・PHYLIP・extended PHYLIP・Treefinderです。アミノ酸配列に対して用いられるDayhoffコーディング<cite class="ltx_cite"><a href="#bib.bib26" title="" class="ltx_ref">(Hrdy <span class="ltx_text ltx_font_italic">et al</span>., 2004)</a></cite>というものもありますが、これは以下のように実行することで適用できます。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgrecodeseq --type=AA "STGPNEQKHVILYW-AAAADDDRRMMMFF" 入力ファイル 出力ファイル↓</span>
        </p>
<p class="ltx_p">これにより、出力される配列は「<span class="ltx_text ltx_font_typewriter">ADRMFC</span>」の6文字だけになります。変換後のデータはRAxML <cite class="ltx_cite"><a href="#bib.bib59" title="" class="ltx_ref">(Stamatakis, 2006)</a></cite>やTreefinder <cite class="ltx_cite"><a href="#bib.bib28" title="" class="ltx_ref">(Jobb <span class="ltx_text ltx_font_italic">et al</span>., 2004)</a></cite>、MrBayes <cite class="ltx_cite"><a href="#bib.bib52" title="" class="ltx_ref">(Ronquist and Huelsenbeck, 2003)</a></cite>で一般時間反転可能(GTR)モデルを適用して解析することができます。絶対にWAG <cite class="ltx_cite"><a href="#bib.bib71" title="" class="ltx_ref">(Whelan and Goldman, 2001)</a></cite>やJTT <cite class="ltx_cite"><a href="#bib.bib29" title="" class="ltx_ref">(Jones <span class="ltx_text ltx_font_italic">et al</span>., 1992)</a></cite>などの経験的置換モデルやそれらの+Fモデルを適用してはいけません。従って、Dayhoffコーディングを行ったデータではモデル選択は必要ありません。<span class="ltx_text ltx_font_typewriter">pgrecodeseq</span>は縮重コード文字も適切に処理するように作成してありますので、縮重コード文字の含まれている配列にもお使いいただけます。ただし、置換前の文字列と置換後の文字列には縮重コード文字を用いることはできませんのでご注意下さい。これはプログラム作成上の都合と、<span class="ltx_text ltx_font_typewriter">pgtestcomposition</span>が縮重コード文字を統計量の計算に用いないためです。</p>
</div>
<div id="Ch1.S7.p5" class="ltx_para">
<p class="ltx_p">タンパクコード塩基配列データの第3コドン位置や、多遺伝子座配列データのある1遺伝子座といった、データの一部分のみにこの処理を適用することもできます。範囲の指定方法は<span class="ltx_text ltx_font_typewriter">pgtestcomposition</span>と同様です。データの一部分にのみ均一化の処理を行った場合、処理した部分と処理していない部分は異なるパーティションとし、比例または分離モデルを適用する必要があります。そうしないと、塩基組成や置換速度のパラメータが正しく推定できなくなるためです。また、データの変換ができたら、<span class="ltx_text ltx_font_typewriter">pgtestcomposition</span>を用いて組成がOTU間で均一になっていることを確認してから実際の解析に用いるようにご注意下さい。</p>
</div>
<div id="Ch1.S7.p6" class="ltx_para">
<p class="ltx_p">なお、上記のようなRYコード化したデータをRAxMLで解析しようとすると、「<span class="ltx_text ltx_font_typewriter">C</span>」や「<span class="ltx_text ltx_font_typewriter">G</span>」が存在しない塩基配列データになってしまうので、解析がうまくいかなくなります。そのような場合は「<span class="ltx_text ltx_font_typewriter">AT</span>」を「<span class="ltx_text ltx_font_typewriter">01</span>」に置き換えて下さい。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgrecodeseq --type=ANY "ATMWSKVHDBN-01?????????" 入力ファイル 出力ファイル↓</span>
        </p>
<p class="ltx_p">Dayhoffコーディングの場合は、元のアミノ酸配列を以下のようにして数字へ変換します。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgrecodeseq --type=ANY "ARNDCQEGHILKMFPSTWYVX-01223220144145000554?" 入力ファイル 出力ファイル↓</span>
        </p>
<p class="ltx_p">ただし、これらの場合はRAxMLではMULTIGAMMAモデルを当てはめる必要があります(<span class="ltx_text ltx_font_typewriter">01</span>データの場合はBINGAMMAでも構いません)。<span class="ltx_text ltx_font_typewriter">-m</span>オプションやパーティションの設定ファイルで<span class="ltx_text ltx_font_typewriter">MULTIGAMMA</span>を指定して下さい。<span class="ltx_text ltx_font_typewriter">-K</span>オプションは<span class="ltx_text ltx_font_typewriter">GTR</span>にする必要がありますが、デフォルトでそうなっているはずです。万一<span class="ltx_text ltx_font_typewriter">MK</span>になっていたら<span class="ltx_text ltx_font_typewriter">GTR</span>に変更して下さい。<span class="ltx_text ltx_font_typewriter">GTR</span>では、ある座位の<span class="ltx_text ltx_font_typewriter">0</span>と別の座位の<span class="ltx_text ltx_font_typewriter">0</span>が同じものを意味することになります。<span class="ltx_text ltx_font_typewriter">MK</span>では、ある座位の<span class="ltx_text ltx_font_typewriter">0</span>と別の座位の<span class="ltx_text ltx_font_typewriter">0</span>が同じものを意味しないことになります。この設定は全てのパーティションに適用され、特定のパーティションでは<span class="ltx_text ltx_font_typewriter">GTR</span>、別のパーティションでは<span class="ltx_text ltx_font_typewriter">MK</span>といった設定にすることはできません。</p>
</div>
</section>
</section>
<section id="Ch2" class="ltx_chapter">
<h2 class="ltx_title ltx_title_chapter">
<span class="ltx_tag ltx_tag_chapter">第2章 </span>分子進化モデルの基礎</h2>

<div id="Ch2.p1" class="ltx_para">
<p class="ltx_p">分子進化モデルは塩基配列データに当てはめられる塩基置換モデル(nucleotide substitution model)と、アミノ酸配列データに当てはめられるアミノ酸置換モデル(amino acid substitution model)に大別されます。タンパクコード塩基配列データにおいて同義置換(synonymous substitution)と非同義置換(nonsynonymous substitution)を区別するコドン置換モデル(codon substitution model)というものもあります。コドン置換モデルはパラメータが多く計算が大変なのと対応しているソフトウェアが少ないため今のところあまり使われていませんが、よりリアルな確率過程を表しているため、将来的にはタンパクコード領域ではコドン置換モデルが多用されるようになっていく可能性は高いでしょう。しかし、ここでは塩基置換モデルとアミノ酸置換モデルに絞って説明を進めていきます。</p>
</div>
<section id="Ch2.S1" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2.1 </span>塩基置換モデル</h3>

<section id="Ch2.S1.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1.1 </span>塩基置換速度行列</h4>

<div id="Ch2.S1.SS1.p1" class="ltx_para">
<p class="ltx_p">塩基置換速度行列(nucleotide substitution rate matrix)は、座位(site)内における、形質状態(character state)間の移行速度の不均質性(heterogeneity)を表現するものです。表<a href="#Ch2.T1" title="表 2.1 ‣ 2.1.1 塩基置換速度行列 ‣ 2.1 塩基置換モデル ‣ 第2章 分子進化モデルの基礎 ‣ 分子系統学演習 データセットの作成から仮説検定まで" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.1</span></a>のように表すことができます。</p>
</div>
<figure id="Ch2.T1" class="ltx_table">
<table class="ltx_tabular ltx_centering ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                  <span class="ltx_text" style="font-size:80%;">From＼To</span>
                </th>
<th class="ltx_td ltx_align_center">
                  <span class="ltx_text" style="font-size:80%;">A</span>
                </th>
<th class="ltx_td ltx_align_center">
                  <span class="ltx_text" style="font-size:80%;">C</span>
                </th>
<th class="ltx_td ltx_align_center">
                  <span class="ltx_text" style="font-size:80%;">G</span>
                </th>
<th class="ltx_td ltx_align_center">
                  <span class="ltx_text" style="font-size:80%;">T</span>
                </th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r ltx_border_t">
                  <span class="ltx_text" style="font-size:80%;">A</span>
                </th>
<td class="ltx_td ltx_align_center ltx_border_t">
                  <span class="ltx_text" style="font-size:80%;">-</span>
                </td>
<td class="ltx_td ltx_align_center ltx_border_t">
                  <span class="ltx_text ltx_font_italic" style="font-size:80%;">RateAC FreqC</span>
                </td>
<td class="ltx_td ltx_align_center ltx_border_t">
                  <span class="ltx_text ltx_font_italic" style="font-size:80%;">RateAG FreqG</span>
                </td>
<td class="ltx_td ltx_align_center ltx_border_t">
                  <span class="ltx_text ltx_font_italic" style="font-size:80%;">RateAT FreqT</span>
                </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                  <span class="ltx_text" style="font-size:80%;">C</span>
                </th>
<td class="ltx_td ltx_align_center">
                  <span class="ltx_text ltx_font_italic" style="font-size:80%;">RateAC FreqA</span>
                </td>
<td class="ltx_td ltx_align_center">
                  <span class="ltx_text" style="font-size:80%;">-</span>
                </td>
<td class="ltx_td ltx_align_center">
                  <span class="ltx_text ltx_font_italic" style="font-size:80%;">RateCG FreqG</span>
                </td>
<td class="ltx_td ltx_align_center">
                  <span class="ltx_text ltx_font_italic" style="font-size:80%;">RateCT FreqT</span>
                </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                  <span class="ltx_text" style="font-size:80%;">G</span>
                </th>
<td class="ltx_td ltx_align_center">
                  <span class="ltx_text ltx_font_italic" style="font-size:80%;">RateAG FreqA</span>
                </td>
<td class="ltx_td ltx_align_center">
                  <span class="ltx_text ltx_font_italic" style="font-size:80%;">RateCG FreqC</span>
                </td>
<td class="ltx_td ltx_align_center">
                  <span class="ltx_text" style="font-size:80%;">-</span>
                </td>
<td class="ltx_td ltx_align_center">
                  <span class="ltx_text ltx_font_italic" style="font-size:80%;">RateGT FreqT</span>
                </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                  <span class="ltx_text" style="font-size:80%;">T</span>
                </th>
<td class="ltx_td ltx_align_center">
                  <span class="ltx_text ltx_font_italic" style="font-size:80%;">RateAT FreqA</span>
                </td>
<td class="ltx_td ltx_align_center">
                  <span class="ltx_text ltx_font_italic" style="font-size:80%;">RateCT FreqC</span>
                </td>
<td class="ltx_td ltx_align_center">
                  <span class="ltx_text ltx_font_italic" style="font-size:80%;">RateGT FreqG</span>
                </td>
<td class="ltx_td ltx_align_center">
                  <span class="ltx_text" style="font-size:80%;">-</span>
                </td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">表 2.1: </span>塩基置換速度行列</figcaption>
</figure>
<div id="Ch2.S1.SS1.p2" class="ltx_para">
<p class="ltx_p">ここで、<span class="ltx_text ltx_font_italic">RateXY FreqX</span>は塩基<span class="ltx_text ltx_font_typewriter">Y</span>から塩基<span class="ltx_text ltx_font_typewriter">X</span>への移行速度で、<span class="ltx_text ltx_font_italic">FreqX</span>は塩基<span class="ltx_text ltx_font_typewriter">X</span>の頻度です。ただし、<span class="ltx_text ltx_font_italic">RateXY = RateYX</span>とします(これを「時間反転可能」(time-reversible)と言います)。</p>
</div>
<div id="Ch2.S1.SS1.p3" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">RateAC = RateAG = RateAT = RateCG = RateCT = RateGT</span>であり、かつ<span class="ltx_text ltx_font_italic">FreqA = FreqC = FreqG = FreqT</span>のとき、最も単純なJC69モデル<cite class="ltx_cite"><a href="#bib.bib30" title="" class="ltx_ref">(Jukes and Cantor, 1969)</a></cite>となります。<span class="ltx_text ltx_font_italic">RateAG = RateCT ≠ RateAC = RateAT = RateCG = RateGT</span>であり、かつ<span class="ltx_text ltx_font_italic">FreqA = FreqC = FreqG = FreqT</span>なモデルはK80/K2Pモデル<cite class="ltx_cite"><a href="#bib.bib34" title="" class="ltx_ref">(Kimura, 1980)</a></cite>です。<span class="ltx_text ltx_font_italic">RateAC = RateAG = RateAT = RateCG = RateCT = RateGT</span>であり、かつ<span class="ltx_text ltx_font_italic">FreqA ≠ FreqC ≠ FreqG ≠ FreqT</span>なモデルはF81モデル<cite class="ltx_cite"><a href="#bib.bib21" title="" class="ltx_ref">(Felsenstein, 1981)</a></cite>と呼ばれています。<span class="ltx_text ltx_font_italic">RateAC ≠ RateAG ≠ RateAT ≠ RateCG ≠ RateCT ≠ RateGT</span>であり、かつ<span class="ltx_text ltx_font_italic">FreqA ≠ FreqC ≠ FreqG ≠ FreqT</span>なモデル<cite class="ltx_cite"><a href="#bib.bib65" title="" class="ltx_ref">(Tavaré, 1986)</a></cite>は一般時間反転可能(general time-reversibleを略してGTR)モデルと呼ばれています<cite class="ltx_cite"><a href="#bib.bib50" title="" class="ltx_ref">(Posada and Crandall, 1998)</a></cite>。他にも様々なモデルがありますが、全てGTRモデルの下位互換なモデルとなっています。</p>
</div>
<div id="Ch2.S1.SS1.p4" class="ltx_para">
<p class="ltx_p">この後説明する系統樹推定の際には、一般的に無根系統樹を仮定して系統樹推定を行います。そのため、分子進化モデルは時間反転可能なモデルでなくてはなりません(そうでないと尤度が定義できない)。これは、時間反転不能モデルは有根系統樹でしか適用できないのですが、そのためには数値計算の困難さと樹形空間の拡大などの問題があり現実的には難しいためと思われます。</p>
</div>
</section>
<section id="Ch2.S1.SS2" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1.2 </span>座位間の置換速度不均質性</h4>

<div id="Ch2.S1.SS2.p1" class="ltx_para">
<p class="ltx_p">座位(site)間における置換速度の不均質性(heterogeneity)があることが知られており、これを表すモデルがいくつか提案されています。これらはASRV (among-site rate variation)モデルと呼ばれています。</p>
</div>
<div id="Ch2.S1.SS2.p2" class="ltx_para">
<p class="ltx_p">配列データ内では、置換の滅多にない座位がほとんどであり、置換が頻発する座位は限られています。これにΓ分布を当てはめるものが提案されています<cite class="ltx_cite"><a href="#bib.bib73" title="" class="ltx_ref">(Yang, 1993)</a></cite>。しかし、連続的なΓ分布を当てはめるのは計算量が膨大になるため、Γ分布に基づいて任意の数に座位をカテゴリ分けするモデル<cite class="ltx_cite"><a href="#bib.bib74" title="" class="ltx_ref">(Yang, 1994)</a></cite>が最もよく利用されています。これを + G とか + dG (discrete Gammaの意)などと表記します。カテゴリ分けする数を含めて + dG4 などと表記することもあります。</p>
</div>
<div id="Ch2.S1.SS2.p3" class="ltx_para">
<p class="ltx_p">また、置換の起きない座位(invariable site)と置換が起きる座位(variable site)の2つにカテゴリ分けするモデル( + I と表記)や、 + G と + I を併用したモデルもあります。これらは一定の法則に従って自動的に行われるカテゴリ分けですが、解析者が任意のカテゴリ分け(partitioning)を指定することもできます( + SS (site specific rateの意)と表記)。異なるコドン位置(codon position)や遺伝子座などの置換速度は異なる可能性が高いので、これらがしばしばカテゴリとして指定されます。この場合、単に + SS と表記しても分かりづらいので、 + Codon Position Specific Rate とか + Gene Specific Rate と表記した方が良いでしょう。さらに、これらのカテゴリ内で + G や + I モデルを当てはめることも可能です(ただし、実際には + I モデルを併用できるソフトウェアは存在しません)。 + Codon Position Specific Rate と + G を併用する場合、コドン位置それぞれにΓ分布を当てはめることもできます( + 3 Different Gamma )し、共通のΓ分布を当てはめることも可能です( + 1 Shared/Common Gamma )。同様に、遺伝子座間でもそれぞれにΓ分布を当てはめる場合( + N Different Gamma )と共通のΓ分布を当てはめる場合( + 1 Shared/Common Gamma )があり得ます。隣接する座位間の置換速度の相関を + G モデルに取り入れた + adG (autocorrelated discrete Gammaの意)モデルもあります<cite class="ltx_cite"><a href="#bib.bib75" title="" class="ltx_ref">(Yang, 1995)</a></cite>。</p>
</div>
</section>
<section id="Ch2.S1.SS3" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1.3 </span>Mixed model</h4>

<div id="Ch2.S1.SS3.p1" class="ltx_para">
<p class="ltx_p">前節では座位(site)間での置換速度不均質性のみを考慮していましたが、塩基置換速度行列および置換速度不均質性の不均質性を考慮することも可能です。つまり、任意の座位のグループ＝パーティション(partition)ごとに異なる塩基置換速度行列、異なるASRVモデルを当てはめます。これはmixed modelと呼ばれています。論文によっては区分モデル(partitioned model)と呼んでいることもあります。これに対して、パーティション間に共通の塩基置換速度行列とASRVモデルを当てはめるものは非区分モデル(nonpartitioned model)と呼ばれます。</p>
</div>
<div id="Ch2.S1.SS3.p2" class="ltx_para">
<p class="ltx_p">Mixed modelには大きく分けて3つのモデルが含まれています。1つ目はパーティション間で平均置換速度が等しいと仮定した等速度モデル(partitioned equal mean rate model)で、2つ目はパーティション間での平均置換速度のばらつきを考慮した比例モデル(proportional model)で、もう1つはパーティション間で置換速度の変化が独立している分離モデル(separate model)です。比例モデルでは、パーティション間の置換速度比が系統樹上の全ての枝で共通になっていますが、分離モデルではパーティションごとに全く独立しています。等速度モデルでは枝長パラメータ数は非区分モデルと同じです。比例モデルでは枝長パラメータは増加しませんが、パーティション数-1個のパーティション間の枝長比=置換速度比パラメータの推定が必要になります。分離モデルは枝長パラメータがパーティション数倍の膨大な数となってしまいます。ASRVモデルの中で説明した + SS モデルは、パーティション間で置換速度行列もASRVモデルも共通にしつつ比例モデルを当てはめたのと同じものになります。分離モデルに対してパーティション間の置換速度比が系統樹上の全ての枝で共通という制約を課すと比例モデルになり、比例モデルに対してパーティション間の置換速度比が全て1:1という制約を課せば等速度モデルになる、という関係になっています。</p>
</div>
</section>
</section>
<section id="Ch2.S2" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2.2 </span>アミノ酸置換モデル</h3>

<section id="Ch2.S2.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2.1 </span>Empirical model</h4>

<div id="Ch2.S2.SS1.p1" class="ltx_para">
<p class="ltx_p">塩基置換速度行列は4x4の行列でしたが、アミノ酸置換速度行列は20x20の行列となるため、<span class="ltx_text ltx_font_italic">RateXY</span>と<span class="ltx_text ltx_font_italic">FreqX</span>の数は時間反転可能モデルでも 190 + 20 = 210 となり膨大です。そこで、既に系統関係の分かっている分類群間の系統樹において、大量のデータを用いてあらかじめ推定された<span class="ltx_text ltx_font_italic">RateXY FreqX</span>の値を用いたモデルをアミノ酸置換モデルとして用います。これらは、実際のデータから観測された「経験的な」ものなので、empirical modelと言います。核<cite class="ltx_cite"><a href="#bib.bib18" title="" class="ltx_ref">(Dayhoff <span class="ltx_text ltx_font_italic">et al</span>., 1978; Henikoff and Henikoff, <a href="#bib.bib25" title="" class="ltx_ref">1992</a>; Jones <span class="ltx_text ltx_font_italic">et al</span>., <a href="#bib.bib29" title="" class="ltx_ref">1992</a>; Müller and Vingron, <a href="#bib.bib46" title="" class="ltx_ref">2000</a>; Whelan and Goldman, <a href="#bib.bib71" title="" class="ltx_ref">2001</a>; Veerassamy <span class="ltx_text ltx_font_italic">et al</span>., <a href="#bib.bib68" title="" class="ltx_ref">2003</a>; Le and Gascuel, <a href="#bib.bib40" title="" class="ltx_ref">2008</a>)</a></cite>・ミトコンドリア<cite class="ltx_cite"><a href="#bib.bib5" title="" class="ltx_ref">(Adachi and Hasegawa, 1996; Cao <span class="ltx_text ltx_font_italic">et al</span>., <a href="#bib.bib13" title="" class="ltx_ref">1998</a>; Abascal <span class="ltx_text ltx_font_italic">et al</span>., <a href="#bib.bib3" title="" class="ltx_ref">2007</a>)</a></cite>・葉緑体<cite class="ltx_cite"><a href="#bib.bib6" title="" class="ltx_ref">(Adachi <span class="ltx_text ltx_font_italic">et al</span>., 2000)</a></cite>・レトロウィルス<cite class="ltx_cite"><a href="#bib.bib19" title="" class="ltx_ref">(Dimmic <span class="ltx_text ltx_font_italic">et al</span>., 2002; Nickle <span class="ltx_text ltx_font_italic">et al</span>., <a href="#bib.bib48" title="" class="ltx_ref">2007</a>)</a></cite>のアミノ酸配列用に様々なモデルが提案されています。<span class="ltx_text ltx_font_italic">RateXY</span>は既存のempirical modelの値を用い、アミノ酸頻度<span class="ltx_text ltx_font_italic">FreqX</span>はデータから推定するモデルも + F モデルと呼ばれて広く用いられています。</p>
</div>
</section>
<section id="Ch2.S2.SS2" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2.2 </span>Empirical mixture model</h4>

<div id="Ch2.S2.SS2.p1" class="ltx_para">
<p class="ltx_p">Empirical modelは所詮empirical modelに過ぎないため、たとえ選択されたとしても手元のデータに本当に適したモデルではない可能性が十分考えられます。だからと言って、20x20の行列のパラメータを推定しながら系統樹推定を行うのは現在のコンピュータの演算能力では困難ですし、近い将来も無理でしょう。そこで、複数のempirical modelを重み付け平均化するモデルが提案されています<cite class="ltx_cite"><a href="#bib.bib27" title="" class="ltx_ref">(Jobb, 2008; Le and Gascuel, <a href="#bib.bib40" title="" class="ltx_ref">2008</a>, <a href="#bib.bib41" title="" class="ltx_ref">2010</a>; Le <span class="ltx_text ltx_font_italic">et al</span>., <a href="#bib.bib42" title="" class="ltx_ref">2012</a>)</a></cite>。主に利用されているのは、<cite class="ltx_cite"><a href="#bib.bib42" title="" class="ltx_ref">Le <span class="ltx_text ltx_font_italic">et al</span>. (2012)</a></cite>のLG4MおよびLG4Xモデルです。平均化の際の重み付けはモデルのパラメータとしてデータから推定する(LG4X)か、あるいは座位間の置換速度不均質性に当てはめる4カテゴリ離散化Γ分布を利用して、異なる速度カテゴリに異なるアミノ酸置換確率行列を当てはめます(LG4M)。有効性が認識されるようになったため、最近になって多くのプログラムに実装されています。また、MrBayesではempirical modelを重み付け平均化するのではなく、model jumpingという方法によって解析中に適用するモデルを変更していきます<cite class="ltx_cite"><a href="#bib.bib53" title="" class="ltx_ref">(Ronquist <span class="ltx_text ltx_font_italic">et al</span>., 2005)</a></cite>。それによって、各モデルの適用された事後確率が得られます。また、モデル平均化(model averaging)によっても類似の効果を得られるかもしれませんが、上述の2つの実装では樹形探索を行いながら平均化パラメータを最適化する、もしくは適用するモデルを切り替えて最適化するというところが大きく異なります。</p>
</div>
</section>
<section id="Ch2.S2.SS3" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2.3 </span>Mixed model</h4>

<div id="Ch2.S2.SS3.p1" class="ltx_para">
<p class="ltx_p">塩基置換モデルと同様に、ソフトウェアによってはパーティションごとに異なるアミノ酸置換モデルを当てはめるmixed modelを適用することができます。枝長パラメータの扱いに応じて等速度モデル、比例モデルと分離モデルがあるのも同様です。</p>
</div>
</section>
</section>
<section id="Ch2.S3" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2.3 </span>より複雑なモデル</h3>

<div id="Ch2.S3.p1" class="ltx_para">
<p class="ltx_p">これまでのASRVモデルでは、座位間の置換速度不均質性はOTU間では均質であると仮定していました。つまり、置換の高速な座位は系統樹上で変化しないということです。しかし、実際には置換の高速な座位が系統ごとに異なることはあり得ます。そのように制約を緩めたモデルがCovarionモデルです<cite class="ltx_cite"><a href="#bib.bib67" title="" class="ltx_ref">(Tuffley and Steel, 1998)</a></cite>。また、前述のmixed modelでは、パーティションの切り方は<span class="ltx_text ltx_font_italic">a priori</span>に与えられていなくてはなりませんが、パーティションの切り方自体を自動最適化するモデルが提案されており<cite class="ltx_cite"><a href="#bib.bib49" title="" class="ltx_ref">(Pagel and Meade, 2004)</a></cite>、mixture modelなどと呼ばれています。mixture modelの中でも、いくつのパーティションに切るかを<span class="ltx_text ltx_font_italic">a priori</span>に指定する必要のないものがCATモデルとしてPhyloBayesというソフトウェアに実装されています<cite class="ltx_cite"><a href="#bib.bib39" title="" class="ltx_ref">(Lartillot and Philippe, 2004)</a></cite>。なお、RAxMLというソフトにもCATモデルというものが実装されていますが、名前が同じなだけで全くの別物です。こちらのCATモデルは、Γ分布を使わずに、座位を任意の数の速度カテゴリに分けて尤度を計算するASRVモデルです。+ G モデルの高速な近似法として用いられています。</p>
</div>
<div id="Ch2.S3.p2" class="ltx_para">
<p class="ltx_p">また、置換速度行列が系統樹上で変化することを許容するnonhomogeneous model <cite class="ltx_cite"><a href="#bib.bib10" title="" class="ltx_ref">(Blanquart and Lartillot, 2006, <a href="#bib.bib11" title="" class="ltx_ref">2008</a>)</a></cite>というものも提案されています。これらを突き詰めていくと、最終的には、全ての枝で、全ての座位で、何もかも異なるモデルに至ります。これをno-common mechanisms modelと言います。このモデルでは、置換速度行列はサンプルが1つしかないため最適化が不可能になり、<span class="ltx_text ltx_font_italic">RateXY</span>は全て等しく、<span class="ltx_text ltx_font_italic">FreqX</span>も全て等しいと仮定せざるを得なくなります。全ての座位が別パーティションになるので、ASRVモデルは意味をなしません。そうなると、最節約法による系統樹推定と一致する結果を導くことが証明されています<cite class="ltx_cite"><a href="#bib.bib66" title="" class="ltx_ref">(Tuffley and Steel, 1997)</a></cite>。そのため、no-common mechanisms modelは最節約法で適用されているモデルと言っても差し支えないのかもしれません。</p>
</div>
</section>
</section>
<section id="Ch3" class="ltx_chapter">
<h2 class="ltx_title ltx_title_chapter">
<span class="ltx_tag ltx_tag_chapter">第3章 </span>分子進化モデルの選択</h2>

<section id="Ch3.S1" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3.1 </span>モデル選択の必要性</h3>

<div id="Ch3.S1.p1" class="ltx_para">
<p class="ltx_p">モデルに階層性がある(単純なモデルは複雑なモデルの特殊な状況である)場合、尤度計算の際に当てはめるモデルは複雑なものほど当てはまりは良くなりますが、実際にはデータにはノイズが含まれており、ノイズにまでフィットしてしまっても意味が無いどころか有害ですらあります。例えばデータを同じ母集団から採取し直したときに当てはまりが大きく低下してしまうようなら、そのモデルは母集団のパラメータを表しているとは言えません。そこで、パラメータを無制限に増やすのではなく、パラメータ数の増大というコストと尤度の向上という利益のバランスを取る必要が出てきます。それを実現したのが<cite class="ltx_cite"><a href="#bib.bib7" title="" class="ltx_ref">Akaike (1974)</a></cite>によって提案された赤池情報量規準(Akaike information criterionを略してAIC)です。AICは尤度を<img src="mi/mi53.png" width="15" height="15" alt="">、パラメータ数を<img src="mi/mi60.png" width="13" height="15" alt="">としたときに以下の式で表されます。</p>
<table id="Ch3.E1" class="ltx_equation">

<tr class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_center_padleft"></td>
<td class="ltx_align_center"><img src="mi/mi47.png" width="141" height="17" alt=""></td>
<td class="ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(3.1)</span></td>
</tr>
</table>
<p class="ltx_p">このAICの値が最小となるモデルが最もバランスの取れたモデルであるということが理論的に導かれています。これを利用して最適なモデルを選択してやればよいわけです。しかし、AICはサンプルサイズが無限大の理想的なデータを前提とした近似によって導かれています。実際のデータはサンプルサイズ無限大ということはあり得ませんので、サンプルサイズが小さいときにAICがパラメータ数の増大コストを過小評価してしまうことを正規分布を仮定して補正したAICcが<cite class="ltx_cite"><a href="#bib.bib60" title="" class="ltx_ref">Sugiura (1978)</a></cite>によって提案されています。AICcはサンプルサイズを<img src="mi/mi63.png" width="14" height="10" alt="">としたときに以下のように表されます。</p>
<table id="Ch3.E2" class="ltx_equation">

<tr class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_center_padleft"></td>
<td class="ltx_align_center"><img src="mi/mi46.png" width="236" height="34" alt=""></td>
<td class="ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(3.2)</span></td>
</tr>
</table>
<p class="ltx_p">ここで、分子進化モデルの選択に対するAICcの適用には「正規分布を仮定して補正した」という点が問題になります。分子進化モデルの誤差構造が正規分布ではないからです。また、<img src="mi/mi62.png" width="69" height="17" alt="">が0以下のとき、AICcは算出することができません。これは、そのようなモデルはそのデータには適用すべきでないと考えるべきなのかもしれません。</p>
</div>
<div id="Ch3.S1.p2" class="ltx_para">
<p class="ltx_p">また、「ベイズ的」と言われているBICというものもあります<cite class="ltx_cite"><a href="#bib.bib56" title="" class="ltx_ref">(Schwarz, 1978)</a></cite>。これは以下の式で表されます。</p>
<table id="Ch3.E3" class="ltx_equation">

<tr class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_center_padleft"></td>
<td class="ltx_align_center"><img src="mi/mi52.png" width="177" height="17" alt=""></td>
<td class="ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(3.3)</span></td>
</tr>
</table>
<p class="ltx_p">このように規準が複数あると、どれを使えばいいのかという話になりますが、筆者は最尤系統樹推定で用いるモデルの選択にはAICかAICc、ベイジアン系統樹推定で用いるモデルの選択にはBICを使うことにしています。AICかAICcかは、それぞれ「サンプルサイズ無限大を前提としている」、「正規分布を仮定している」という問題があり、一長一短があります。筆者は全ての候補モデルでAICcが算出可能、つまり<img src="mi/mi61.png" width="99" height="17" alt="">であればAICcを、そうでなければAICを使うことにしています。</p>
</div>
<div id="Ch3.S1.p3" class="ltx_para">
<p class="ltx_p">本来、系統樹推定においては分子進化モデルの選択と系統樹の選択は同時に行われるべきですが、1つの分子進化モデルにおいてさえ、系統樹の選択は大変な労力を要します。そのため、全ての分子進化モデルでそうするのは非現実的です。そこで、とりあえずそれほど悪くはないであろうと考えられる「仮の」系統樹に樹形を固定して(ソフトによっては簡易な樹形探索も行う)、各分子進化モデルにおける最大化対数尤度を計算し、それに基づく情報量規準によって分子進化モデルの選択を行います。その後、選択された分子進化モデルを適用して系統樹の選択を行います。つまり、現状の分子系統樹推定は「多重モデル選択」となっているわけです。reversible jump MCMC (model jumping)などによりいつかは解決されるかもしれませんが、しばらくの間はこの方法が使われ続けることになるでしょう。</p>
</div>
<div id="Ch3.S1.p4" class="ltx_para">
<p class="ltx_p">この問題があるため、系統樹推定によって最終的に得られた系統樹でも、同じ分子進化モデルが選択されるのかを確認することが望ましいでしょう。もし異なるなら、選択された分子進化モデルを適用して再度系統樹推定を行う必要があります。ただ、何度やってもモデル選択結果と系統樹推定結果が一致しない可能性があります。その場合は複数の暫定最尤系統樹の中でモデル選択に用いた規準の値が最も小さいものを使うか、いずれにおいても共通している部分についてのみ考察するしかないでしょう。</p>
</div>
</section>
<section id="Ch3.S2" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3.2 </span>Kakusan4・Aminosanによる分子進化モデルの選択</h3>

<div id="Ch3.S2.p1" class="ltx_para">
<p class="ltx_p">Kakusan4・Aminosan <cite class="ltx_cite"><a href="#bib.bib64" title="" class="ltx_ref">(Tanabe, 2011)</a></cite>は、配列データに対して最適な置換モデルを選択し、RAxMLやMrBayes (MrBayes5D)用のモデル設定ファイルを書き出してくれるソフトウェアです。また、モデル選択に必要な尤度の計算はRAxML・PAUP*・baseml・Treefinderのいずれか(AminosanはRAxMLかTreefinderかcodeml)に丸投げして計算させますが、この際に並列化して各ソフトウェアを起動するため、マルチCPUやマルチコアCPUを搭載したコンピュータでは従来のソフトウェアよりも大幅に高速な処理が可能になっています。対応している入力データは、FASTA・NEXUS・PHYLIP・GenBankなどの配列ファイルです。モデル選択に利用できる情報量規準はAIC <cite class="ltx_cite"><a href="#bib.bib7" title="" class="ltx_ref">(Akaike, 1974)</a></cite>・AICc <cite class="ltx_cite"><a href="#bib.bib60" title="" class="ltx_ref">(Sugiura, 1978)</a></cite>・BIC <cite class="ltx_cite"><a href="#bib.bib56" title="" class="ltx_ref">(Schwarz, 1978)</a></cite>となっています。</p>
</div>
<div id="Ch3.S2.p2" class="ltx_para">
<p class="ltx_p">Kakusan4とAminosanは、以下のような処理を行っています。</p>
<ol id="Ch3.I1" class="ltx_enumerate">
<li id="Ch3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
              <span class="ltx_text" style="font-size:90%;">1.</span>
            </span> 
<div id="Ch3.I1.i1.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">χ二乗独立性の検定による塩基・アミノ酸頻度の均一性確認</span>
              </p>
</div>
</li>
<li id="Ch3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
              <span class="ltx_text" style="font-size:90%;">2.</span>
            </span> 
<div id="Ch3.I1.i2.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">固定する仮の系統樹を作成 (指定も可能)</span>
              </p>
<ul id="Ch3.I1.I1" class="ltx_itemize">
<li id="Ch3.I1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                    <span class="ltx_text ltx_font_bold" style="font-size:90%;">–</span>
                  </span> 
<div id="Ch3.I1.I1.i1.p1" class="ltx_para">
<p class="ltx_p">
                      <span class="ltx_text" style="font-size:90%;">JC69距離の近隣結合樹 (Kakusan4)</span>
                    </p>
</div>
</li>
<li id="Ch3.I1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                    <span class="ltx_text ltx_font_bold" style="font-size:90%;">–</span>
                  </span> 
<div id="Ch3.I1.I1.i2.p1" class="ltx_para">
<p class="ltx_p">
                      <span class="ltx_text" style="font-size:90%;">K83距離の近隣結合樹 (Aminosan)</span>
                    </p>
</div>
</li>
</ul>
</div>
</li>
<li id="Ch3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
              <span class="ltx_text" style="font-size:90%;">3.</span>
            </span> 
<div id="Ch3.I1.i3.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">領域・コドン位置ごとに候補モデルを当てはめて最大化対数尤度を求める</span>
              </p>
</div>
</li>
<li id="Ch3.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
              <span class="ltx_text" style="font-size:90%;">4.</span>
            </span> 
<div id="Ch3.I1.i4.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">領域・コドン位置ごとに情報量規準を算出してモデル選択</span>
              </p>
</div>
</li>
<li id="Ch3.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
              <span class="ltx_text" style="font-size:90%;">5.</span>
            </span> 
<div id="Ch3.I1.i5.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">領域・コドン位置ごとに選択されたモデルを適用した等速度・比例・分離モデルを全領域連結配列に当てはめて最大化対数尤度を求める</span>
              </p>
</div>
</li>
<li id="Ch3.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
              <span class="ltx_text" style="font-size:90%;">6.</span>
            </span> 
<div id="Ch3.I1.i6.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">情報量規準を算出して非区分・等速度・比例・分離モデルからのモデル選択を行う</span>
              </p>
</div>
</li>
</ol>
<p class="ltx_p">このように、一旦各領域・各コドン位置ごとのモデル選択を行ってから連結配列での非区分・等速度・比例・分離モデルからのモデル選択をしているため、ここでも多重モデル選択になっています。また、等速度・比例・分離モデルは本来、各領域・各コドン位置に全候補モデルを当てはめる全ての組み合わせからモデル選択すべきですが、計算量的に非現実的なので、各領域・各コドン位置のモデル選択で選ばれたモデルを用いた等速度・比例・分離モデルを当てはめることで妥協しています。</p>
</div>
<div id="Ch3.S2.p3" class="ltx_para">
<p class="ltx_p">Kakusan4・Aminosanには2つの動作モードがあります。1つ目は誰でも簡単に利用できる(つもりで作った)対話型の動作モードで、2つ目は自動処理に適したコマンドラインから操作する動作モードです。ここでは対話型の動作モードでの操作方法を説明していきます。主にKakusan4を用いて説明していきますが、Aminosanでは異なる点があれば適宜説明を加えていきます。また、現在のところAminosanはEmpirical mixture modelには対応していません。</p>
</div>
<section id="Ch3.S2.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2.1 </span>モデル選択の実行</h4>

<div id="Ch3.S2.SS1.p1" class="ltx_para">
<p class="ltx_p">いずれの環境においても、Kakusan4・Aminosanを起動すると標準で対話モードになります。対話モードでは最初に入力ファイルの名前を質問されます。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Kakusan4 4.0.2012.11.06</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">=======================================================================</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">This is a script to select nucleotide substitution model for multi-</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">partitioned data set. Official web site of this script is</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">http://www.fifthdimension.jp/products/kakusan/ .</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">To know script details, see above URL.</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">If you publish your study using Kakusan4, please cite the following.</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Tanabe AS (2011) "Kakusan4 and Aminosan: two programs for comparing</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">nonpartitioned, proportional, and separate models for combined</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">molecular phylogenetic analyses of multilocus sequence data",</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Molecular Ecology Resources, vol.11, pp.914-921.</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Copyright (C) 2006-2012  Akifumi S. Tanabe</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">This program is free software; you can redistribute it and/or modify</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">it under the terms of the GNU General Public License as published by</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">the Free Software Foundation; either version 2 of the License.</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">This program is distributed in the hope that it will be useful,</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">GNU General Public License for more details.</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">You should have received a copy of the GNU General Public License along</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">with this program; if not, write to the Free Software Foundation, Inc.,</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Parsing command line options...</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">No input files are specified.</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Entering interactive mode.</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Specified options are ignored.</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Specify an input file name.</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Note that you can use wild card.</span>
            </span>
</p>
<p class="ltx_p">Windows (Vista以外)・Mac OS X環境では、ここでファイルのアイコンを1つだけこのウィンドウにドロップすると、ファイルのフルパス名が入力されます。Windows Vistaでは、エクスプローラ上で<span class="ltx_text ltx_font_typewriter">Shift</span>キーを押しながらファイルアイコンを右クリックして<span class="ltx_text ltx_font_typewriter">パスとしてコピー</span>をしてから、タイトルバーを右クリックし、<span class="ltx_text ltx_font_typewriter">編集</span>の中にある<span class="ltx_text ltx_font_typewriter">貼り付け</span>を行って下さい。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Specify an input file name.</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Note that you can use wild card.</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">"C:\Users\akifumi\Desktop\SampleData\CYTBnuc_P.fas"↓</span>
            </span>
</p>
<p class="ltx_p">そのまま<span class="ltx_text ltx_font_typewriter">Enter</span>キーを押すとファイルがKakusan4・Aminosanに読み込まれます。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">"C:\Users\akifumi\Desktop\SampleData\CYTBnuc_P.fas"↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">"C:\Users\akifumi\Desktop\SampleData\CYTBnuc_P.fas" was accepted.</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Specify an input file name or just press enter to leave input file specification.</span>
            </span>
</p>
<p class="ltx_p">複数領域データなどの場合、領域ごとに別のファイルとして用意しておき、この操作を繰り返して全ファイルを読み込ませます。同一の遺伝子配列でも、タンパクコード領域とそうでない領域は必ず別のファイルに分けて下さい。タンパクコードでない領域の中で、イントロンと5’・3’の非翻訳領域は分けるべきかどうかは正直分かりません。場合によるでしょう。なお、タンパクコード領域塩基配列データではファイル名(拡張子は含まない)が必ず<span class="ltx_text ltx_font_typewriter">_P</span>で終わるようにして下さい。こうすることで、コドン位置ごとの置換速度の不均質性やコドン位置ごとに異なる塩基置換モデルを当てはめるmixed modelが検討されるようになります。また、複数領域データでは、各ファイルでの配列名が統一されていなくてはなりませんので注意して下さい。入力ファイルの指定の際には<span class="ltx_text ltx_font_typewriter">*</span>や<span class="ltx_text ltx_font_typewriter">?</span>といったワイルドカードが使えます。ワイルドカードを用いることで一度に多数のファイルを読み込ませることができます。</p>
</div>
<div id="Ch3.S2.SS1.p2" class="ltx_para">
<p class="ltx_p">また、Aminosanでは、ファイル名が<span class="ltx_text ltx_font_typewriter">_mt</span>で終わるようにすると、検討対象モデルをmtREV <cite class="ltx_cite"><a href="#bib.bib5" title="" class="ltx_ref">(Adachi and Hasegawa, 1996)</a></cite>・mtMam <cite class="ltx_cite"><a href="#bib.bib13" title="" class="ltx_ref">(Cao <span class="ltx_text ltx_font_italic">et al</span>., 1998)</a></cite>・mtArt <cite class="ltx_cite"><a href="#bib.bib3" title="" class="ltx_ref">(Abascal <span class="ltx_text ltx_font_italic">et al</span>., 2007)</a></cite>・mtZoa <cite class="ltx_cite"><a href="#bib.bib54" title="" class="ltx_ref">(Rota-Stabelli <span class="ltx_text ltx_font_italic">et al</span>., 2009)</a></cite>のみに制限できます。同様に<span class="ltx_text ltx_font_typewriter">_nc</span>でDayhoff <cite class="ltx_cite"><a href="#bib.bib18" title="" class="ltx_ref">(Dayhoff <span class="ltx_text ltx_font_italic">et al</span>., 1978)</a></cite>・JTT <cite class="ltx_cite"><a href="#bib.bib29" title="" class="ltx_ref">(Jones <span class="ltx_text ltx_font_italic">et al</span>., 1992)</a></cite>・BLOSUM62 <cite class="ltx_cite"><a href="#bib.bib25" title="" class="ltx_ref">(Henikoff and Henikoff, 1992)</a></cite>・VT <cite class="ltx_cite"><a href="#bib.bib46" title="" class="ltx_ref">(Müller and Vingron, 2000)</a></cite>・WAG <cite class="ltx_cite"><a href="#bib.bib71" title="" class="ltx_ref">(Whelan and Goldman, 2001)</a></cite>・PMB <cite class="ltx_cite"><a href="#bib.bib68" title="" class="ltx_ref">(Veerassamy <span class="ltx_text ltx_font_italic">et al</span>., 2003)</a></cite>・LG <cite class="ltx_cite"><a href="#bib.bib40" title="" class="ltx_ref">(Le and Gascuel, 2008)</a></cite>のみに、<span class="ltx_text ltx_font_typewriter">_cp</span>でcpREV <cite class="ltx_cite"><a href="#bib.bib6" title="" class="ltx_ref">(Adachi <span class="ltx_text ltx_font_italic">et al</span>., 2000)</a></cite>のみに、<span class="ltx_text ltx_font_typewriter">_rt</span>でrtREV <cite class="ltx_cite"><a href="#bib.bib19" title="" class="ltx_ref">(Dimmic <span class="ltx_text ltx_font_italic">et al</span>., 2002)</a></cite>・HIVb・HIVw <cite class="ltx_cite"><a href="#bib.bib48" title="" class="ltx_ref">(Nickle <span class="ltx_text ltx_font_italic">et al</span>., 2007)</a></cite>のみに検討モデルが絞られます。<span class="ltx_text ltx_font_typewriter">_モデル名</span>で特定モデルのみに絞ることもできます。ただし、 + F, + G, + I の適用は検討されます。なお、Aminosanが検討するDayhoff・JTTモデルは、<cite class="ltx_cite"><a href="#bib.bib37" title="" class="ltx_ref">Kosiol and Goldman (2005)</a></cite>によるDCMutバージョンと呼ばれる若干の改善が施されたものであることに注意して下さい。</p>
</div>
<div id="Ch3.S2.SS1.p3" class="ltx_para">
<p class="ltx_p">全てのデータファイルを読み込ませたら、何も入力せずに<span class="ltx_text ltx_font_typewriter">Enter</span>キーを押します。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Specify an input file name or just press enter to leave input file specification.</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">OK. Input file specification has terminated.</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Log, result and configuration files will be output to "C:\Users\akifumi\Desktop\</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">SampleData\CYTBnuc_P.fas.kakusan".</span>
            </span>
</p>
<p class="ltx_p">以上のメッセージの通り、最初に与えたファイルの存在するフォルダ内に「<span class="ltx_text ltx_font_typewriter">最初に与えたファイルのファイル名.kakusan</span>」という名前のフォルダ(Aminosanの場合は末尾は<span class="ltx_text ltx_font_typewriter">aminosan</span>になります)が作成され、そこに全ての結果が出力されます。続いて、どの系統樹推定ソフトウェア向けのモデル選択を行うのか尋ねてきます。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">OUTPUT OPTIONS</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Which is a target analysis software? (MrBayes/Treefinder/PAUP/PHYML/RAxML)</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">(default: RAxML)</span>
            </span>
</p>
<p class="ltx_p">この質問では、選択した系統樹推定ソフトウェア向けのモデル設定ファイルが出力されるように設定されます。タンパクコード領域配列データを入力してTreefinderかRAxMLかMrBayesを選択すると、コドン位置ごとに異なるモデルを当てはめるmixed modelの検討が強制的に有効になります。RAxMLの場合はコドン位置間で共通のモデルを当てはめることも強制的に検討されます。PAUP*またはPHYMLを選択した場合、全領域連結配列を区分せず共通なモデルを当てはめることが強制的に検討されます。これはPAUP*とPHYMLがmixed modelに対応していないからです。この後の質問は、これまでの返答によって内容が変化します。全ての質問に関して説明していきますが、表示されない質問がある場合がありますのでご注意下さい。</p>
</div>
<div id="Ch3.S2.SS1.p4" class="ltx_para">
<p class="ltx_p">次の質問は、コドン位置ごとに異なる塩基置換モデルを当てはめるmixed modelを検討するか否かに関するものです。ただし、タンパクコード領域データを入力していない場合や、強制的に検討される場合には質問が表示されません。また、当然ですがAminosanでもこの質問はされません。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">ANALYSIS OPTIONS</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">You input protein coding sequence.</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Do you want to consider partitioning of codon positions? (y/n)</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">(default: n)</span>
            </span>
</p>
<p class="ltx_p">この質問に<span class="ltx_text ltx_font_typewriter">y</span>と答えて<span class="ltx_text ltx_font_typewriter">Enter</span>キーを押せば、コドン位置ごとに最適な塩基置換モデルの選択が行われます。</p>
</div>
<div id="Ch3.S2.SS1.p5" class="ltx_para">
<p class="ltx_p">次の質問は、タンパクコード領域において全コドン位置を区分せず共通なモデルの検討を行うか否かに関するものです。ただし、タンパクコード領域データを入力していない場合や、コドン位置ごとに最適なモデル選択を行う設定が有効になっていない場合は表示されません。PAUP*やPHYML用の設定ファイル出力が有効になっている場合にも表示されません。もちろん、Aminosanでもこの質問はされません。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">You enabled partitioning of codon positions.</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Do you want to consider nonpartitioning of codon positions? (y/n)</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">If you say yes, applying nonpartitioned models to all-codon position-concatenate</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">d sequences will be considered on each locus.</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">(default: y)</span>
            </span>
</p>
<p class="ltx_p">この質問に<span class="ltx_text ltx_font_typewriter">n</span>と答えた場合、タンパクコード領域において全コドン位置に共通な非区分モデルの検討は行われません。<span class="ltx_text ltx_font_typewriter">y</span>と答えるか空欄のまま<span class="ltx_text ltx_font_typewriter">Enter</span>キーを押せば検討されます。</p>
</div>
<div id="Ch3.S2.SS1.p6" class="ltx_para">
<p class="ltx_p">次の質問は、複数領域データを与えている場合に、全領域連結配列に領域を区分しないモデルを当てはめることを検討するか否かに関するものです。複数領域データを与えていない場合や、PAUP*またはPHYML用の設定ファイル出力を有効にしている場合は強制的に有効になるので表示されません。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">You input multiple files.</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Do you want to consider nonpartitioning of loci? (y/n)</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">If you say yes, applying nonpartitioned models to all-loci-concatenated sequence</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">s will be considered.</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">(default: n)</span>
            </span>
</p>
<p class="ltx_p">この質問に<span class="ltx_text ltx_font_typewriter">y</span>と答えて<span class="ltx_text ltx_font_typewriter">Enter</span>キーを押せば、全領域連結配列に領域を区分しないモデルを当てはめることが検討されますが、<span class="ltx_text ltx_font_typewriter">n</span>と答えれば検討されません。</p>
</div>
<div id="Ch3.S2.SS1.p7" class="ltx_para">
<p class="ltx_p">次は複数領域データかタンパクコード領域データを与えたときに、全領域連結配列または全コドン位置連結配列における非区分・等速度・比例・分離モデル間の比較を行うかに関する質問です。この質問は複数領域データかタンパクコード領域データを与えていないと表示されません。PAUP*またはPHYML用設定ファイル出力を有効にしている場合も表示されません。また、RAxML用設定ファイル出力を有効にしている場合は比例モデルが検討されないので文言が異なります。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">You input multiple files and/or protein coding sequence.</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Do you want to compare nonpartitioned, partitionedequalmeanrate, proportional, a</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">nd separate models on all-loci concatenated sequences? (y/n)</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Note that this function needs Treefinder.</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">(default: y)</span>
            </span>
</p>
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">y</span>と答えるか、何も入力せずに<span class="ltx_text ltx_font_typewriter">Enter</span>キーを押せば非区分・等速度・比例・分離モデル間の比較が行われます。分離モデルの対数尤度は各領域の対数尤度の和なので簡単に求められますが、等速度モデル・比例モデルの尤度は実際に当てはめて計算しなくてはならないため、計算量が増加します。また、RAxML用設定ファイルの書き出しを有効にしている場合は非区分・等速度・分離モデルだけが検討され、比例モデルは検討されません。これはRAxMLが比例モデルに対応していないためです。この際の尤度の計算はRAxMLで行われます。RAxML以外のソフト用の設定ファイル書き出しを有効にしている場合、等速度モデル・比例モデルの尤度は次の質問の内容にかかわらずTreefinderで計算されます。そして、Treefinder以外で計算した尤度との互換性が厳密にあるのか何とも言えないので、他の尤度計算にTreefinder以外が使われていた場合はTreefinderで尤度を計算し直すためさらに計算量が増加します。また、RAxML・Treefinderが + SS モデルには対応していないためこれは比較対象に含まれていません。つまり、非区分モデルやコドン位置間非区分モデルが選択されなかったとしても、 + SS モデルを検討していないせいである可能性は残ります。</p>
</div>
<div id="Ch3.S2.SS1.p8" class="ltx_para">
<p class="ltx_p">次の質問は、モデル選択に用いる尤度の値をどのプログラムで計算させるかというものです。PAUP*・baseml (Aminosanではcodeml)・Treefinderのいずれかから選びます。この質問はPHYML用設定ファイル書き出しを有効にした場合しか表示されません。RAxML用設定ファイルの書き出しを有効にしている場合はこの質問は出ず、RAxMLで尤度が計算されます。PAUP*用設定ファイル書き出しを有効にしている場合はPAUP*で、MrBayes用設定ファイル書き出しを有効にしている場合はTreefinderで尤度が計算されます。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Which do you want to use the program for likelihood calculation? (baseml/tf/paup)</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">(default: baseml)</span>
            </span>
</p>
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">baseml</span>と答えれば、basemlが各モデルの尤度最大化に使われます。<span class="ltx_text ltx_font_typewriter">tf</span>と答えればTreefinderが、<span class="ltx_text ltx_font_typewriter">paup</span>と答えればPAUP*が用いられることになります。</p>
</div>
<div id="Ch3.S2.SS1.p9" class="ltx_para">
<p class="ltx_p">次の質問は、塩基頻度パラメータを持つモデルにおいて、各塩基頻度パラメータを最適化するか、それともデータから得られる観測値を用いるのかに関するものです。RAxML用設定ファイルを書き出す際にはこの質問は表示されず、パラメータの最適化は行われません。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Do you want to optimize the parameters of base composition? (y/n)</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">(default: n)</span>
            </span>
</p>
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">n</span>と答えるか、何も入力せずに<span class="ltx_text ltx_font_typewriter">Enter</span>キーを押すと、最適化が無効になり、データから得た観測値が用いられます。最適化は行われません。<span class="ltx_text ltx_font_typewriter">y</span>と答えると最適化が行われます。最適化を行うと時間はかかりますがより厳密な解析が行われます。しかし、塩基配列でデータが十分にある場合は最適化の効果はあまりありませんので無効にしても構わないでしょう。アミノ酸配列では形質状態が20もあるため、最適化した方が良いことも多いと思いますが、最適化ができるのはTreefinderで尤度を計算する場合のみです。その場合もTreefinderやMrBayes用の設定ファイルを出力させるときしかこの質問は表示されません。</p>
</div>
<div id="Ch3.S2.SS1.p10" class="ltx_para">
<p class="ltx_p">次に、座位間の置換速度不均質性に対する離散Γ分布の当てはめにおいて、離散化の際のカテゴリ数に関する質問がなされます。この質問もRAxML用設定ファイルを書き出す際には表示されません。RAxML用設定ファイルを書き出す際にはこの値は4に設定されます。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">How many rate categories of discrete gamma rate heterogeneity do you want to con</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">sider? (integer)</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">(default: 8)</span>
            </span>
</p>
<p class="ltx_p">この質問には、正の整数で答えます。少なくとも4以上の値を入力するようにして下さい。値を大きくするほど尤度は正確になりますが計算時間が延びていきます。</p>
</div>
<div id="Ch3.S2.SS1.p11" class="ltx_para">
<p class="ltx_p">次の質問は、ASRVに + I モデルの当てはめを検討するか否かに関するものです。PAUP*かTreefinderで尤度を計算する設定のときにのみ表示されます。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Do you want to consider invariant model for among-site rate variation? (y/n)</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">(default: n)</span>
            </span>
</p>
<p class="ltx_p">デフォルトでは<span class="ltx_text ltx_font_typewriter">n</span>ですが、検討させたい場合には<span class="ltx_text ltx_font_typewriter">y</span>と答えて下さい。</p>
</div>
<div id="Ch3.S2.SS1.p12" class="ltx_para">
<p class="ltx_p">次の質問は、領域・コドン位置ごとに異なる離散Γ分布の当てはめを行うモデルを検討するか否かに関するものです。なお、この質問は尤度最大化にbasemlを用いる場合にしか表示されません。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Do you want to consider N-GAM model for among-site rate variation? (y/n)</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Note that this model is very time-consuming.</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">(default: n)</span>
            </span>
</p>
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">y</span>と答えて<span class="ltx_text ltx_font_typewriter">Enter</span>キーを押せば、領域・コドン位置ごとに異なる離散Γ分布の当てはめを行うモデルが検討されますが、このモデルの尤度最大化には非常に時間がかかるため注意して下さい。この質問で<span class="ltx_text ltx_font_typewriter">n</span>と答えても、比例モデルや分離モデルで領域・コドン位置ごとに異なる離散Γ分布を当てはめるモデルは検討されます。</p>
</div>
<div id="Ch3.S2.SS1.p13" class="ltx_para">
<p class="ltx_p">次に、隣接座位間の置換速度自己相関を考慮した離散Γ分布の当てはめを行うモデルを検討するか否かに関する質問がなされます。なお、この質問は尤度最大化にbasemlを用いる場合にしか表示されません。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Do you want to consider autocorrelated discrete gamma model for among-site rate</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">variation? (y/n)</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Note that this model is very time-consuming.</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">(default: n)</span>
            </span>
</p>
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">y</span>と答えて<span class="ltx_text ltx_font_typewriter">Enter</span>キーを押せば、隣接座位間の置換速度自己相関を考慮した離散Γ分布の当てはめを行うモデルが候補モデルに含まれるようになりますが、このモデルの尤度最大化には非常に時間がかかるため注意して下さい。このモデルはデータによっては尤度の改善に大きな効果があるのですが、それ以上に計算に膨大な時間がかかってしまいます。計算時間がそれほど問題にならない小さめのデータセットでは有効にしてもよいでしょう。</p>
</div>
<div id="Ch3.S2.SS1.p14" class="ltx_para">
<p class="ltx_p">次に、領域ごとに異なる樹形を用いて尤度最大化を行うか、共通の樹形を用いるかの質問がなされます。なお、この質問は複数領域のデータを与えた場合にしか表示されません。また、非区分・等速度・比例・分離モデル間の比較を行う場合にはこの質問は表示されず、共通の樹形が使用されます。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Do you want to use different tree topology for parameter optimization on each lo</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">cus? (y/n)</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">(default: n)</span>
            </span>
</p>
<p class="ltx_p">この質問に<span class="ltx_text ltx_font_typewriter">y</span>と答えて<span class="ltx_text ltx_font_typewriter">Enter</span>キーを押せば、各領域で異なる樹形に基づいてモデル選択が行われますが、<span class="ltx_text ltx_font_typewriter">n</span>と答えるか、何も入力せずに<span class="ltx_text ltx_font_typewriter">Enter</span>キーを押した場合は全領域連結配列データから生成された樹形に基づいてモデル選択が行われます。領域間の不調和(incongruence)について検討する場合には<span class="ltx_text ltx_font_typewriter">y</span>と答えて下さい。樹形は次の質問で樹形ファイルを指定しない限り、JC69距離(AminosanではK83距離 <cite class="ltx_cite"><a href="#bib.bib35" title="" class="ltx_ref">(Kimura, 1983)</a></cite>)に基づいて近隣結合法(neighbor-joining <cite class="ltx_cite"><a href="#bib.bib55" title="" class="ltx_ref">(Saitou and Nei, 1987)</a></cite>)によって生成されます。対話モードではなくコマンドラインから用いる場合は他の方法も用いることができます。</p>
</div>
<div id="Ch3.S2.SS1.p15" class="ltx_para">
<p class="ltx_p">次に、尤度最大化に用いる樹形を指定するか否かに関する質問です。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">If you want to give tree(s) for parameter optimization, specify an input file na</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">me.
Otherwise, just press enter.</span>
            </span>
</p>
<p class="ltx_p">もしも尤度最大化に用いる樹形を指定したい場合には、ここでNewickかNEXUS形式の樹形ファイルを指定して下さい。その必要が無ければ、そのまま<span class="ltx_text ltx_font_typewriter">Enter</span>キーを押して下さい。</p>
</div>
<div id="Ch3.S2.SS1.p16" class="ltx_para">
<p class="ltx_p">最後に、同時に起動するプロセスの数に関する質問がなされます。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">How many processes do you want to run simultaneously? (integer)</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">(default: 1)</span>
            </span>
</p>
<p class="ltx_p">ここで、任意の正の整数を入力して<span class="ltx_text ltx_font_typewriter">Enter</span>キーを押すと、入力した数だけプロセスが同時起動されます。指定する値は、基本的にはお使いのPCが搭載しているCPU(コア)の数と同数にして下さい。そうすることで、PCの演算能力を最大限に生かすことができます。</p>
</div>
<div id="Ch3.S2.SS1.p17" class="ltx_para">
<p class="ltx_p">以上の全ての質問に答え終えると、以下のような表示がなされます。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">All configurations have been completed.</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Just press enter to run!</span>
            </span>
</p>
<p class="ltx_p">心の準備ができたら<span class="ltx_text ltx_font_typewriter">Enter</span>を押して解析を始めて下さい。解析は場合によっては長時間かかってしまいますが、気長に待っていて下さい。</p>
</div>
</section>
<section id="Ch3.S2.SS2" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2.2 </span>モデル選択結果を見る</h4>

<div id="Ch3.S2.SS2.p1" class="ltx_para">
<p class="ltx_p">既に述べた通り、最初に与えたファイルの存在するフォルダ内に「<span class="ltx_text ltx_font_typewriter">最初に与えたファイルのファイル名.kakusan</span>」(Aminosanからの出力では末尾は<span class="ltx_text ltx_font_typewriter">aminosan</span>)という名前のフォルダ(以降、「出力フォルダ」と呼びます)が作成され、そこに全ての結果が出力されます。下図のように、出力フォルダ内には<span class="ltx_text ltx_font_typewriter">Chisq</span>・<span class="ltx_text ltx_font_typewriter">Results</span>・<span class="ltx_text ltx_font_typewriter">MrBayes</span>・<span class="ltx_text ltx_font_typewriter">PAUP</span>・<span class="ltx_text ltx_font_typewriter">PHYML</span>・<span class="ltx_text ltx_font_typewriter">RAxML</span>・<span class="ltx_text ltx_font_typewriter">Treefinder</span>・<span class="ltx_text ltx_font_typewriter">Scores</span>・<span class="ltx_text ltx_font_typewriter">Logs</span>というフォルダが作成され、さらにその中に様々なファイルが出力されます。なお、指定していないソフトウェアのフォルダは作成されません。</p>
<ul id="Ch3.I2" class="ltx_itemize">
<li id="Ch3.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                <span class="ltx_text" style="font-size:90%;">•</span>
              </span> 
<div id="Ch3.I2.i1.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">出力フォルダ</span>
                </p>
<ul id="Ch3.I2.I1" class="ltx_itemize">
<li id="Ch3.I2.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                      <span class="ltx_text ltx_font_bold" style="font-size:90%;">–</span>
                    </span> 
<div id="Ch3.I2.I1.i1.p1" class="ltx_para">
<p class="ltx_p">
                        <span class="ltx_text" style="font-size:90%;">Chisq</span>
                      </p>
<ul id="Ch3.I2.I1.I1" class="ltx_itemize">
<li id="Ch3.I2.I1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I1.i1.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">chisq_partition.txt (各領域のχ二乗検定の結果)</span>
                            </p>
</div>
</li>
<li id="Ch3.I2.I1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I1.i2.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">…</span>
                            </p>
</div>
</li>
</ul>
</div>
</li>
<li id="Ch3.I2.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                      <span class="ltx_text ltx_font_bold" style="font-size:90%;">–</span>
                    </span> 
<div id="Ch3.I2.I1.i2.p1" class="ltx_para">
<p class="ltx_p">
                        <span class="ltx_text" style="font-size:90%;">Results</span>
                      </p>
<ul id="Ch3.I2.I1.I2" class="ltx_itemize">
<li id="Ch3.I2.I1.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I2.i1.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">partition_criterion.txt (各領域におけるモデル選択の結果)</span>
                            </p>
</div>
</li>
<li id="Ch3.I2.I1.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I2.i2.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">whole_criterion_comparemix.txt (連結配列における非区分・等速度・比例・分離モデルからの選択結果)</span>
                            </p>
</div>
</li>
<li id="Ch3.I2.I1.I2.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I2.i3.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">…</span>
                            </p>
</div>
</li>
</ul>
</div>
</li>
<li id="Ch3.I2.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                      <span class="ltx_text ltx_font_bold" style="font-size:90%;">–</span>
                    </span> 
<div id="Ch3.I2.I1.i3.p1" class="ltx_para">
<p class="ltx_p">
                        <span class="ltx_text" style="font-size:90%;">MrBayes</span>
                      </p>
<ul id="Ch3.I2.I1.I3" class="ltx_itemize">
<li id="Ch3.I2.I1.I3.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I3.i1.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">partition_criterion_xxx.nex (各領域データと選択されたモデルを適用するコマンドの書かれたNEXUSファイル)</span>
                            </p>
</div>
</li>
<li id="Ch3.I2.I1.I3.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I3.i2.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">…</span>
                            </p>
</div>
</li>
</ul>
</div>
</li>
<li id="Ch3.I2.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                      <span class="ltx_text ltx_font_bold" style="font-size:90%;">–</span>
                    </span> 
<div id="Ch3.I2.I1.i4.p1" class="ltx_para">
<p class="ltx_p">
                        <span class="ltx_text" style="font-size:90%;">PAUP</span>
                      </p>
<ul id="Ch3.I2.I1.I4" class="ltx_itemize">
<li id="Ch3.I2.I1.I4.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I4.i1.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">partition_criterion.nex (各領域データと選択されたモデルを適用するコマンドの書かれたNEXUSファイル)</span>
                            </p>
</div>
</li>
<li id="Ch3.I2.I1.I4.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I4.i2.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">…</span>
                            </p>
</div>
</li>
</ul>
</div>
</li>
<li id="Ch3.I2.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                      <span class="ltx_text ltx_font_bold" style="font-size:90%;">–</span>
                    </span> 
<div id="Ch3.I2.I1.i5.p1" class="ltx_para">
<p class="ltx_p">
                        <span class="ltx_text" style="font-size:90%;">PHYML</span>
                      </p>
<ul id="Ch3.I2.I1.I5" class="ltx_itemize">
<li id="Ch3.I2.I1.I5.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I5.i1.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">partition.phy (各領域データ)</span>
                            </p>
</div>
</li>
<li id="Ch3.I2.I1.I5.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I5.i2.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">partition_criterion_singlesearch.bat (単一の樹形探索を行うバッチファイル)</span>
                            </p>
</div>
</li>
<li id="Ch3.I2.I1.I5.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I5.i3.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">partition_criterion_shotgunsearch.bat (ショットガン樹形探索を行うバッチファイル)</span>
                            </p>
</div>
</li>
<li id="Ch3.I2.I1.I5.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I5.i4.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">partition_criterion_bootstrap.bat (ブートストラップ解析を行うバッチファイル)</span>
                            </p>
</div>
</li>
<li id="Ch3.I2.I1.I5.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I5.i5.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">partition_criterion_shotgunbootstrap.bat (ショットガンブートストラップ解析を行うバッチファイル)</span>
                            </p>
</div>
</li>
<li id="Ch3.I2.I1.I5.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I5.i6.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">…</span>
                            </p>
</div>
</li>
</ul>
</div>
</li>
<li id="Ch3.I2.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                      <span class="ltx_text ltx_font_bold" style="font-size:90%;">–</span>
                    </span> 
<div id="Ch3.I2.I1.i6.p1" class="ltx_para">
<p class="ltx_p">
                        <span class="ltx_text" style="font-size:90%;">RAxML</span>
                      </p>
<ul id="Ch3.I2.I1.I6" class="ltx_itemize">
<li id="Ch3.I2.I1.I6.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I6.i1.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">partition.phy (各領域データ)</span>
                            </p>
</div>
</li>
<li id="Ch3.I2.I1.I6.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I6.i2.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">partition_criterion_xxx.partition (各領域データに選択されたモデルを適用する設定ファイル)</span>
                            </p>
</div>
</li>
<li id="Ch3.I2.I1.I6.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I6.i3.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">partition_criterion_xxx_singlesearch.bat (単一の樹形探索を行うバッチファイル)</span>
                            </p>
</div>
</li>
<li id="Ch3.I2.I1.I6.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I6.i4.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">partition_criterion_xxx_shotgunsearch.bat (ショットガン樹形探索を行うバッチファイル)</span>
                            </p>
</div>
</li>
<li id="Ch3.I2.I1.I6.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I6.i5.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">partition_criterion_xxx_bootstrap.bat (ブートストラップ解析を行うバッチファイル)</span>
                            </p>
</div>
</li>
<li id="Ch3.I2.I1.I6.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I6.i6.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">…</span>
                            </p>
</div>
</li>
</ul>
</div>
</li>
<li id="Ch3.I2.I1.i7" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                      <span class="ltx_text ltx_font_bold" style="font-size:90%;">–</span>
                    </span> 
<div id="Ch3.I2.I1.i7.p1" class="ltx_para">
<p class="ltx_p">
                        <span class="ltx_text" style="font-size:90%;">Treefinder</span>
                      </p>
<ul id="Ch3.I2.I1.I7" class="ltx_itemize">
<li id="Ch3.I2.I1.I7.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I7.i1.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">partition_xxx.tf (各領域データ)</span>
                            </p>
</div>
</li>
<li id="Ch3.I2.I1.I7.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I7.i2.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">partition_criterion_xxx.model (各領域データに選択されたモデルを適用する設定ファイル)</span>
                            </p>
</div>
</li>
<li id="Ch3.I2.I1.I7.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I7.i3.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">partition_criterion_xxx.rates (比例・分離を指定する設定ファイル)</span>
                            </p>
</div>
</li>
<li id="Ch3.I2.I1.I7.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I7.i4.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">partition_criterion_comparemodels.tl (非区分・比例・分離モデル間の比較を行うTreefinder Languageスクリプト)</span>
                            </p>
</div>
</li>
<li id="Ch3.I2.I1.I7.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I7.i5.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">partition_criterion_xxx_singlesearch.tl (単一の樹形探索を行うTreefinder Languageスクリプト)</span>
                            </p>
</div>
</li>
<li id="Ch3.I2.I1.I7.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I7.i6.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">partition_criterion_xxx_shotgunsearch.tl (ショットガン樹形探索を行うTreefinder Languageスクリプト)</span>
                            </p>
</div>
</li>
<li id="Ch3.I2.I1.I7.i7" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I7.i7.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">partition_criterion_xxx_bootstrap.tl (ブートストラップ解析を行うTreefinder Languageスクリプト)</span>
                            </p>
</div>
</li>
<li id="Ch3.I2.I1.I7.i8" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I7.i8.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">…</span>
                            </p>
</div>
</li>
</ul>
</div>
</li>
<li id="Ch3.I2.I1.i8" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                      <span class="ltx_text ltx_font_bold" style="font-size:90%;">–</span>
                    </span> 
<div id="Ch3.I2.I1.i8.p1" class="ltx_para">
<p class="ltx_p">
                        <span class="ltx_text" style="font-size:90%;">Scores</span>
                      </p>
<ul id="Ch3.I2.I1.I8" class="ltx_itemize">
<li id="Ch3.I2.I1.I8.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I8.i1.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">partition_model.txt (各領域における各モデルの最大化対数尤度)</span>
                            </p>
</div>
</li>
<li id="Ch3.I2.I1.I8.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I8.i2.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">…</span>
                            </p>
</div>
</li>
</ul>
</div>
</li>
<li id="Ch3.I2.I1.i9" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                      <span class="ltx_text ltx_font_bold" style="font-size:90%;">–</span>
                    </span> 
<div id="Ch3.I2.I1.i9.p1" class="ltx_para">
<p class="ltx_p">
                        <span class="ltx_text" style="font-size:90%;">Logs (その他のログファイルの出力されるフォルダ)</span>
                      </p>
<ul id="Ch3.I2.I1.I9" class="ltx_itemize">
<li id="Ch3.I2.I1.I9.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                            <span class="ltx_text" style="font-size:90%;">*</span>
                          </span> 
<div id="Ch3.I2.I1.I9.i1.p1" class="ltx_para">
<p class="ltx_p">
                              <span class="ltx_text" style="font-size:90%;">…</span>
                            </p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">partition</span>はパーティション名(入力ファイル名)、<span class="ltx_text ltx_font_typewriter">criterion</span>はモデル選択規準、<span class="ltx_text ltx_font_typewriter">xxx</span>は非区分・等速度・比例・分離モデルの適用状況を示しています。全領域連結配列は<span class="ltx_text ltx_font_typewriter">whole</span>という名前のパーティションとなっています。非Windows環境ではバッチファイルの代わりにシェルスクリプト(拡張子は<span class="ltx_text ltx_font_typewriter">.bat</span>でなく<span class="ltx_text ltx_font_typewriter">.sh</span>)が作成されます。</p>
</div>
<div id="Ch3.S2.SS2.p2" class="ltx_para">
<p class="ltx_p">χ二乗検定の結果(<span class="ltx_text ltx_font_typewriter">chisq_partition.txt</span>)の内容は、<span class="ltx_text ltx_font_typewriter">pgtestcomposition</span>の出力と同じ形式です。<span class="ltx_text ltx_font_italic">p</span>値が0.05以下のとき、OTU間の塩基・アミノ酸組成に有意な差があると考えられます。ただし、この<span class="ltx_text ltx_font_italic">p</span>値が信頼できるデータには条件があり、それを満たしていない場合は末尾にその旨を示すメッセージが出ています。</p>
</div>
<div id="Ch3.S2.SS2.p3" class="ltx_para">
<p class="ltx_p">ここで、塩基・アミノ酸組成がOTU間で均一でなくてはならないパーティションは、適用するモデルによって異なります。後述する非区分・等速度・比例・分離モデルの比較において、遺伝子座間非区分・コドン位置間非区分モデルが選択されていた場合、<span class="ltx_text ltx_font_typewriter">whole</span>パーティションの組成だけが均一でなくてはなりません。<span class="ltx_text ltx_font_typewriter">whole</span>パーティション全体に対して共通の置換速度行列が適用されるためです。遺伝子座間区分・コドン位置間区分モデルが選択されていた場合、区分したそれぞれのパーティションの組成が均一でなくてはなりません。それぞれで異なる置換速度行列が適用されるためです。つまり、共通の置換速度行列の適用範囲で組成が均一でなくてはならないということです。</p>
</div>
<div id="Ch3.S2.SS2.p4" class="ltx_para">
<p class="ltx_p">もしも塩基・アミノ酸組成に有意な差があったのであれば、データ改変による均一化を検討して下さい。他にも、系統樹上で組成が変化することを許容する不均質モデル<cite class="ltx_cite"><a href="#bib.bib10" title="" class="ltx_ref">(Blanquart and Lartillot, 2006, <a href="#bib.bib11" title="" class="ltx_ref">2008</a>)</a></cite>の適用を検討するのも良いですが、このモデルを適用できるnhPhyloBayesはかなり解析が遅いので、大規模データに適用するのは難しいと思います。</p>
</div>
<div id="Ch3.S2.SS2.p5" class="ltx_para">
<p class="ltx_p">次に、各領域・コドン位置のモデル選択結果(<span class="ltx_text ltx_font_typewriter">partition_criterion.txt</span>)をテキストエディタで開いてみると以下のような内容となっています。ただし設定ファイル書き出し対象のソフトによって検討されるモデルは異なります。例えばRAxMLではGTR_Gammaしか検討されません。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| model                             criterion  weight                -LnL  nparam</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| SYM_GeneCodonPos1Gamma   5.237279083000e+004 0.98496 2.606139541500e+004    125</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| J2ef_GeneCodonPos1Gamma  5.238115467800e+004 0.01504 2.606757733900e+004    123</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| SYM_Gamma                5.288409574800e+004 0.00000 2.631904787400e+004    123</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| 以下略</span>
            </span>
</p>
<p class="ltx_p">左から順に、モデル名、情報量規準の値、Akaike weight、-LnLの値、パラメータ数となっています。<span class="ltx_text ltx_font_typewriter">GeneCodonPos1Gamma</span>というのは、領域間・コドン位置間に異なる速度を当てはめた上で、領域・コドン位置に共通のΓ分布モデルを当てはめたものです。AICcやBICに基づいたモデル選択の結果では、上記の内容に加えてサンプルサイズの値が記述されています。AICcとBICの計算に用いるサンプルサイズの値は複数考えられるため、それぞれをサンプルサイズに用いてモデル選択を行った結果が出力されています。各出力ファイルで使われているサンプルサイズは以下のようになっています。</p>
<ul class="ltx_itemize">
<li id="Ch3.I3.ix1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                <span class="ltx_text" style="font-size:90%;">AICc1・BIC1:</span>
              </span> 
<div id="Ch3.I3.ix1.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">系統樹上での最小塩基置換数(最節約樹長)</span>
                </p>
</div>
</li>
<li id="Ch3.I3.ix2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                <span class="ltx_text" style="font-size:90%;">AICc2・BIC2:</span>
              </span> 
<div id="Ch3.I3.ix2.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">各座位における最小塩基置換数の合計</span>
                </p>
</div>
</li>
<li id="Ch3.I3.ix3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                <span class="ltx_text" style="font-size:90%;">AICc3・BIC3:</span>
              </span> 
<div id="Ch3.I3.ix3.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">各座位における形質状態の合計</span>
                </p>
</div>
</li>
<li id="Ch3.I3.ix4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                <span class="ltx_text" style="font-size:90%;">AICc4・BIC4:</span>
              </span> 
<div id="Ch3.I3.ix4.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">座位数(配列長)</span>
                </p>
</div>
</li>
<li id="Ch3.I3.ix5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                <span class="ltx_text" style="font-size:90%;">AICc5・BIC5:</span>
              </span> 
<div id="Ch3.I3.ix5.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">変異のある座位数</span>
                </p>
</div>
</li>
<li id="Ch3.I3.ix6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                <span class="ltx_text" style="font-size:90%;">AICc6・BIC6:</span>
              </span> 
<div id="Ch3.I3.ix6.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">座位数×配列数</span>
                </p>
</div>
</li>
</ul>
<p class="ltx_p">最もよく使われているサンプルサイズはAICc4・BIC4の「座位数」です。</p>
</div>
<div id="Ch3.S2.SS2.p6" class="ltx_para">
<p class="ltx_p">ここで重要なのは、<span class="ltx_text ltx_font_bold">このファイルで最上位になっているモデルが実際の解析で適用されるとは限らない</span>ということです。というのも、ここでは比較に用いた候補モデル全ての順位が示されているのであって、たとえ最上位でも解析ソフトの側が対応していなければ適用できないからです。実際に適用されるモデルは、必ず解析ソフトで用いる設定ファイルを直接開いて確認して下さい。</p>
</div>
<div id="Ch3.S2.SS2.p7" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">Results</span>フォルダに作成される<span class="ltx_text ltx_font_typewriter">whole_criterion_comparemix.txt</span>は、連結配列における非区分・等速度・比例・分離モデル間の比較結果です。内容は以下のようなものです。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| model                                     criterion                -LnL  nparam</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| Separate_CodonProportional       1.286036307191e+004 6.373181535953e+003     57</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| Proportional_CodonProportional   1.286895735412e+004 6.385478677060e+003     49</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| Separate_CodonSeparate           1.288258125450e+004 6.352290627248e+003     89</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| Proportional_CodonNonpartitioned 1.401815088065e+004 6.983075440327e+003     26</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| Separate_CodonNonpartitioned     1.402149556766e+004 6.976747783830e+003     34</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| Nonpartitioned                   1.413466486467e+004 7.049332432334e+003     18</span>
            </span>
</p>
<p class="ltx_p">このファイル内のモデルはそれぞれ以下のようなものです。</p>
<ul id="Ch3.I4" class="ltx_itemize">
<li id="Ch3.I4.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                <span class="ltx_text" style="font-size:90%;">•</span>
              </span> 
<div id="Ch3.I4.i1.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">領域間分離・コドン位置間比例モデル</span>
                </p>
</div>
</li>
<li id="Ch3.I4.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                <span class="ltx_text" style="font-size:90%;">•</span>
              </span> 
<div id="Ch3.I4.i2.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">領域間比例・コドン位置間比例モデル</span>
                </p>
</div>
</li>
<li id="Ch3.I4.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                <span class="ltx_text" style="font-size:90%;">•</span>
              </span> 
<div id="Ch3.I4.i3.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">領域間分離・コドン位置間分離モデル</span>
                </p>
</div>
</li>
<li id="Ch3.I4.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                <span class="ltx_text" style="font-size:90%;">•</span>
              </span> 
<div id="Ch3.I4.i4.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">領域間比例・コドン位置間非区分モデル</span>
                </p>
</div>
</li>
<li id="Ch3.I4.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                <span class="ltx_text" style="font-size:90%;">•</span>
              </span> 
<div id="Ch3.I4.i5.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">領域間分離・コドン位置間非区分モデル</span>
                </p>
</div>
</li>
<li id="Ch3.I4.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_itemize">
                <span class="ltx_text" style="font-size:90%;">•</span>
              </span> 
<div id="Ch3.I4.i6.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">非区分モデル</span>
                </p>
</div>
</li>
</ul>
<p class="ltx_p">上記は等速度モデル非対応の旧バージョンの出力ファイルなので等速度モデルが登場しませんが、最新版ではPartitionedEqualMeanRateという名前で等速度モデルがリストに現れます。なお、Kakusan4・AminosanはMrBayes (MrBayes5D)とTreefinder用の非区分・等速度・比例・分離モデルを適用する設定ファイルを書き出すことができますが、Kakusan4・Aminosanが複数領域データにおいて実際に行っているのは、既に述べたように「それぞれの領域」での最適モデルの選択と、それぞれの領域で選択されたモデルを用いた非区分・等速度・比例・分離モデル間の比較だけです。これは、領域ごとに当てはめるモデルが多数あるとき、その組み合わせはさらに多数になってしまい、全ての比較を現実的な時間で処理することが不可能だからです。ただし、分離モデルはただそれぞれの領域で最大化した対数尤度を足し合わせたものですので、モデル選択にAICを用いる場合は全ての組み合わせで正攻法で尤度を計算してモデル選択した結果と完全に一致します。AICcやBICは相加的ではないため完全には一致しない可能性があります。</p>
</div>
<div id="Ch3.S2.SS2.p8" class="ltx_para">
<p class="ltx_p">Kakusan4・Aminosanでは、このようにして選択された分離モデルに対して全ての領域・コドン位置で枝長が比例するように制約を課すことで比例モデルの設定ファイルを作成しています。当然、実際には領域・コドン位置間で枝ごとの置換速度のパターンが異なる場合には、部分的に分離モデルを適用し部分的に比例モデルを当てはめたモデルがより良い可能性はありますが、そのような比較は行っていませんし設定ファイルも作成されません。また、非区分・等速度・比例・分離モデル間の比較をTreefinderで行っている場合、Treefinderが対応していないモデルは比較対象に入っていません。比較対象に入っていないモデルがベストである可能性は常に残っていることに注意して下さい。</p>
</div>
</section>
</section>
</section>
<section id="Ch4" class="ltx_chapter">
<h2 class="ltx_title ltx_title_chapter">
<span class="ltx_tag ltx_tag_chapter">第4章 </span>最尤系統樹推定</h2>

<section id="Ch4.S1" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4.1 </span>最尤系統樹推定とは何か</h3>

<div id="Ch4.S1.p1" class="ltx_para">
<p class="ltx_p">今更ではありますが、そもそも尤度とは「あるモデルが正しいと仮定した状況で手元のデータが得られる確率」のことです。これは、データに対するモデルの当てはまりの良さを表します。ここで、10回のコイントスを行って表が1回、裏が9回出たときの状況を考えましょう。すると、「このコインを使ったコイントスでは表と裏が1:9の比率で出る」というモデルの尤度<img src="mi/mi56.png" width="22" height="17" alt="">は以下のようになります。</p>
<table id="A0.S3.EGx1" class="ltx_equationgroup ltx_eqn_eqnarray">

<tr id="Ch4.E1" class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right">
                    <img src="mi/mi43.png" width="22" height="17" alt="">
                  </td>
<td class="ltx_td ltx_align_center">
                    <img src="mi/mi39.png" width="17" height="9" alt="">
                  </td>
<td class="ltx_td ltx_align_left">
                    <img src="mi/mi44.png" width="94" height="46" alt="">
                  </td>
<td class="ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(4.1)</span></td>
</tr>
<tr class="ltx_align_baseline">
<td class="ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right"></td>
<td class="ltx_td ltx_align_center">
                    <img src="mi/mi39.png" width="17" height="9" alt="">
                  </td>
<td class="ltx_td ltx_align_left">
                    <img src="mi/mi36.png" width="48" height="14" alt="">
                  </td>
<td class="ltx_eqn_center_padright"></td>
</tr>
</table>
<p class="ltx_p">「このコインを使ったコイントスでは表と裏が等確率で出る」というモデルの尤度<img src="mi/mi54.png" width="22" height="17" alt="">は以下のようになります。</p>
<table id="A0.S3.EGx2" class="ltx_equationgroup ltx_eqn_eqnarray">

<tr id="Ch4.E2" class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right">
                    <img src="mi/mi41.png" width="22" height="17" alt="">
                  </td>
<td class="ltx_td ltx_align_center">
                    <img src="mi/mi39.png" width="17" height="9" alt="">
                  </td>
<td class="ltx_td ltx_align_left">
                    <img src="mi/mi45.png" width="53" height="46" alt="">
                  </td>
<td class="ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(4.2)</span></td>
</tr>
<tr class="ltx_align_baseline">
<td class="ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right"></td>
<td class="ltx_td ltx_align_center">
                    <img src="mi/mi39.png" width="17" height="9" alt="">
                  </td>
<td class="ltx_td ltx_align_left">
                    <img src="mi/mi35.png" width="64" height="14" alt="">
                  </td>
<td class="ltx_eqn_center_padright"></td>
</tr>
</table>
<p class="ltx_p">このように、<img src="mi/mi55.png" width="61" height="17" alt="">であることから、前者のモデルの方が当てはまりが良いことになります。ただし、前者は「表と裏が1:9の比率」ということをデータから推定していると考えられますので、パラメータが1つありますが、後者にはデータから推定しているパラメータがありませんので、AICは以下のようになります。</p>
<table id="A0.S3.EGx3" class="ltx_equationgroup ltx_eqn_eqnarray">

<tr id="Ch4.E3" class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right">
                    <img src="mi/mi51.png" width="41" height="17" alt="">
                  </td>
<td class="ltx_td ltx_align_center">
                    <img src="mi/mi39.png" width="17" height="9" alt="">
                  </td>
<td class="ltx_td ltx_align_left">
                    <img src="mi/mi33.png" width="288" height="42" alt="">
                  </td>
<td class="ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(4.3)</span></td>
</tr>
<tr class="ltx_align_baseline">
<td class="ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right"></td>
<td class="ltx_td ltx_align_center">
                    <img src="mi/mi39.png" width="17" height="9" alt="">
                  </td>
<td class="ltx_td ltx_align_left">
                    <img src="mi/mi38.png" width="33" height="14" alt="">
                  </td>
<td class="ltx_eqn_center_padright"></td>
</tr>
<tr id="Ch4.E4" class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right">
                    <img src="mi/mi49.png" width="41" height="17" alt="">
                  </td>
<td class="ltx_td ltx_align_center">
                    <img src="mi/mi39.png" width="17" height="9" alt="">
                  </td>
<td class="ltx_td ltx_align_left">
                    <img src="mi/mi34.png" width="209" height="42" alt="">
                  </td>
<td class="ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(4.4)</span></td>
</tr>
<tr class="ltx_align_baseline">
<td class="ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right"></td>
<td class="ltx_td ltx_align_center">
                    <img src="mi/mi39.png" width="17" height="9" alt="">
                  </td>
<td class="ltx_td ltx_align_left">
                    <img src="mi/mi37.png" width="41" height="14" alt="">
                  </td>
<td class="ltx_eqn_center_padright"></td>
</tr>
</table>
<p class="ltx_p">ここでも<img src="mi/mi58.png" width="98" height="17" alt="">であることから、やはり前者のモデルの方が良いということになります。</p>
</div>
<div id="Ch4.S1.p2" class="ltx_para">
<p class="ltx_p">最尤系統樹推定は、分子進化モデルは固定(パラメータ値はそうでない)にして、最も尤度が高くなるような系統モデル=系統樹を選択するというものです。系統モデルは枝長パラメータと樹形から成りますが、検討すべき樹形数は配列数=系統樹の端点数=OTU (operational taxonomic unit)数に応じて劇的に膨れ上がってしまいます。そのため最尤系統樹推定では、網羅的探索(exhaustive search)は計算時間から見て非現実的です。そこで、ほとんどの場合は発見的探索(heuristic search)を行います。これは、近隣結合法(neighbor-joining <cite class="ltx_cite"><a href="#bib.bib55" title="" class="ltx_ref">(Saitou and Nei, 1987)</a></cite>)や段階的配列付加法(stepwise/sequential sequence addition <cite class="ltx_cite"><a href="#bib.bib62" title="" class="ltx_ref">(Swofford and Begle, 1993)</a></cite>)などで生成した初期系統樹(initial/starting tree)と、それを枝交換(branch swapping)によって樹形改変(topology rearrangement)してできる系統樹の尤度を計算し、より尤度の高い系統樹が見つかればそれを初期系統樹としてまた同じことを繰り返す、というものです。</p>
</div>
</section>
<section id="Ch4.S2" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4.2 </span>RAxMLによる発見的探索</h3>

<div id="Ch4.S2.p1" class="ltx_para">
<p class="ltx_p">最尤系統樹推定に用いられるソフトは各種ありますが、ここでは比較的高速なRAxML <cite class="ltx_cite"><a href="#bib.bib59" title="" class="ltx_ref">(Stamatakis, 2006)</a></cite>を用いて説明していきます。ただし、RAxMLは塩基配列データでは置換速度行列はGTRモデルしか使えない上、分離モデルは使えるものの比例モデルはサポートしていません。RAxMLの詳しい使い方はver.7.0.4のマニュアルに書かれていますが内容が古いので、最新版で<span class="ltx_text ltx_font_typewriter">-h</span>オプションを付けて実行したときに表示されるメッセージを参照するようにして下さい。</p>
</div>
<div id="Ch4.S2.p2" class="ltx_para">
<p class="ltx_p">Kakusan4・Aminosanで分子進化モデルの選択を行った場合、出力フォルダ下の<span class="ltx_text ltx_font_typewriter">RAxML</span>フォルダに
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">partition_criterion_xxx_singlesearch.bat
<br class="ltx_break"></span>というファイルが作成されているはずです。<span class="ltx_text ltx_font_typewriter">partition</span>はパーティション名、<span class="ltx_text ltx_font_typewriter">criterion</span>はモデル選択規準、<span class="ltx_text ltx_font_typewriter">xxx</span>はmixed modelの適用状況を示しています。連結配列データは<span class="ltx_text ltx_font_typewriter">whole</span>という名前のパーティションとなっています。非Windows環境では拡張子は<span class="ltx_text ltx_font_typewriter">.bat</span>ではなく<span class="ltx_text ltx_font_typewriter">.sh</span>となっていますのでご注意下さい。作成されるファイルは入力されたデータが複数領域データか、タンパクコード領域データかによって異なりますが、例えば、
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">whole_AIC_separate_codonseparate_singlesearch.bat
<br class="ltx_break"></span>(AICをモデル選択規準として領域・コドン位置ごとに選ばれたモデルを分離モデルとして連結配列に当てはめて樹形探索を行うバッチファイル)
<br class="ltx_break">とか
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">whole_AIC_codonseparate_singlesearch.bat
<br class="ltx_break"></span>(AICをモデル選択規準としてコドン位置ごとに選ばれたモデルを分離モデルとして連結配列に当てはめて樹形探索を行うバッチファイル)
<br class="ltx_break">とか
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">whole_AIC_nonpartitioned_singlesearch.bat
<br class="ltx_break"></span>(AICをモデル選択規準として選ばれた非区分モデルを配列全体に当てはめて樹形探索を行うバッチファイル)
<br class="ltx_break">といったファイルが出力されているはずです。タンパクコード領域配列では
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">whole_AIC_nonpartitioned_singlesearch.bat
<br class="ltx_break"></span>は
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">whole_AIC_codonnonpartitioned_singlesearch.bat
<br class="ltx_break"></span>という名前で出力されています。ただし、タンパクコード領域において全コドン位置に共通なモデルの検討を行わない設定でKakusan4によるモデル選択を行った場合はこのファイルは出力されません。</p>
</div>
<div id="Ch4.S2.p3" class="ltx_para">
<p class="ltx_p">上述のことから分かるように、同じパーティションのデータに対して、多くのモデルの当てはめ方があり得ます。上記の例では分離モデルしか挙げていませんが、等速度モデルも利用可能です。どの当てはめ方が最も適しているかはデータによって異なります。どのモデルを当てはめればよいかは第<a href="#Ch3.S2.SS2" title="3.2.2 モデル選択結果を見る ‣ 3.2 Kakusan4・Aminosanによる分子進化モデルの選択 ‣ 第3章 分子進化モデルの選択 ‣ 分子系統学演習 データセットの作成から仮説検定まで" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2.2</span></a>節をご覧下さい。</p>
</div>
<div id="Ch4.S2.p4" class="ltx_para">
<p class="ltx_p">適切なファイルを選んだら、Windows上ではバッチファイルを直接実行すれば解析が行われ、結果が<span class="ltx_text ltx_font_typewriter">RAxML_*</span>というファイル名で保存されます。Windows以外の環境ではターミナル上で</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; sh ファイル名↓</span>
        </p>
<p class="ltx_p">というコマンドを実行すれば解析が走ります。</p>
</div>
<div id="Ch4.S2.p5" class="ltx_para">
<p class="ltx_p">これらをそのまま実行すると、CPUを1個しか利用しない解析が行われます。このため、より高速に処理したい場合はこのファイルを編集する必要があります。このファイルをテキストエディタで開くと、以下のような内容になっています。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| raxmlHPC -n partition_criterion_xxx_singlesearch -s partition.phy -f d -p 1234 -m GTRGAMMA</span>
        </p>
<p class="ltx_p">これが実行される解析コマンドで、<span class="ltx_text ltx_font_typewriter">raxmlHPC</span>がコマンド名、それ以降がオプションとなっています。ここで、<span class="ltx_text ltx_font_typewriter">raxmlHPC</span>を<span class="ltx_text ltx_font_typewriter">raxmlHPC-PTHREADS</span>に置換し、オプションに<span class="ltx_text ltx_font_typewriter">-T 8</span>を加えると、CPUは8個使用されます。また、よほど古いCPUでない限り、SSE3という拡張命令に対応しているはずです。この拡張命令を使うと、「複数のデータへの同内容の処理」が1命令で行えるため、適した処理では計算が高速になります。<span class="ltx_text ltx_font_typewriter">raxmlHPC-PTHREADS-SSE3</span>を実行すれば、この拡張命令が利用されるため、処理が高速化します。ごく最近のCPUでは、AVX命令とかAVX2命令というより強力な拡張命令が利用できます。これらを利用するにはそれぞれ<span class="ltx_text ltx_font_typewriter">raxmlHPC-PTHREADS-AVX</span>・<span class="ltx_text ltx_font_typewriter">raxmlHPC-PTHREADS-AVX2</span>を実行して下さい。ただし、Windows版は高速化しないかもしれません。</p>
</div>
<div id="Ch4.S2.p6" class="ltx_para">
<p class="ltx_p">非常にOTUが多いデータセットの場合、1度の発見的探索では尤度の山の第1峰に到達できないことが多くなります。OTUが多いと、それだけ探索空間が広がり、尤度の山も頂上付近がなだらかながらも凹凸がある状態になります。それぞれの峰の頂点は距離があるため容易に移動できません。そのため、1度の探索では第2峰やそれ以下の峰の頂点を尤度の最高点と誤認してしまいます。そこで、初期系統樹を多数用意し、それらからの発見的探索を行なって、全ての探索結果の中から最も尤度の大きいものを採用します。これを行うのが
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">*_shotgunsearch.bat
<br class="ltx_break"></span>という名前のバッチファイルです。このファイルの内容も上記と同様の方法で編集することで高速化できます。標準では初期系統樹の数、つまり発見的探索の回数は10回になっています。<span class="ltx_text ltx_font_typewriter">-N 10</span>というオプションで指定されています。この値を変えることで探索回数を変更可能です。OTUが多いほどこの値を大きくして下さい。</p>
</div>
<div id="Ch4.S2.p7" class="ltx_para">
<p class="ltx_p">どちらの解析でも、最尤系統樹は<span class="ltx_text ltx_font_typewriter">RAxML_bestTree.*</span>という名前で保存されます。</p>
</div>
</section>
<section id="Ch4.S3" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4.3 </span>RAxMLによるブートストラップ解析</h3>

<div id="Ch4.S3.p1" class="ltx_para">
<p class="ltx_p">樹形の信頼性(credibility)を検討するために、ブートストラップリサンプリング(bootstrap resampling)したデータを用いて系統樹推定を繰り返すことで、各内分枝(internal/interior branch)の再現率を得ます。これが系統樹推定におけるブートストラップ解析です<cite class="ltx_cite"><a href="#bib.bib22" title="" class="ltx_ref">(Felsenstein, 1985)</a></cite>。</p>
</div>
<div id="Ch4.S3.p2" class="ltx_para">
<p class="ltx_p">Kakusan4でモデル選択を行った場合は、出力フォルダ下の<span class="ltx_text ltx_font_typewriter">RAxML</span>フォルダにある
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">partition_criterion_xxx_bootstrap.bat
<br class="ltx_break"></span>を実行して下さい。この解析も、発見的探索と同様に高速化できます。標準では反復数は100に設定されています。<span class="ltx_text ltx_font_typewriter">-N 100</span>というオプションで指定されていますので、この値を変えることで反復数を変更できます。解析が終わると、各反復での最尤系統樹が<span class="ltx_text ltx_font_typewriter">RAxML_bootstrap.*</span>というファイルとして保存されています。これだけでは多数の系統樹があるだけで信頼性がわかりません。そこで、Phylogears2の<span class="ltx_text ltx_font_typewriter">pgsumtree</span>コマンドを使って、元データの最尤系統樹に見られた各内分枝の出現頻度をカウントし、百分率にして系統樹上の各枝に数値をマッピングします。これは以下のように実行して下さい。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgsumtree --mode=MAP --treefile=RAxML_bestTree.* RAxML_bootstrap.* 出力ファイル名↓</span>
        </p>
<p class="ltx_p">出力ファイルはFigTreeで開くことができます。<span class="ltx_text ltx_font_typewriter">pgsumtree</span>を使用すると、ブートストラップ解析の結果をより詳細に分析することができます。詳しくは第<a href="#Ch6.S4" title="6.4 内分枝出現頻度の分析 ‣ 第6章 系統樹の編集・統計と可視化 ‣ 分子系統学演習 データセットの作成から仮説検定まで" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.4</span></a>節をご覧下さい。</p>
</div>
</section>
</section>
<section id="Ch5" class="ltx_chapter">
<h2 class="ltx_title ltx_title_chapter">
<span class="ltx_tag ltx_tag_chapter">第5章 </span>ベイジアン系統樹推定</h2>

<div id="Ch5.p1" class="ltx_para">
<p class="ltx_p">マルコフ連鎖モンテカルロ法(Markov chain Monte Carlo略してMCMC)を用いたベイジアン系統樹推定(Bayesian phylogenetic inference)は、近年普及してきていますが、まだパラメータ設定や収束(convergence)判定には一定の知識が必要です。ここではMCMCについて簡単に説明した上で、MrBayes <cite class="ltx_cite"><a href="#bib.bib52" title="" class="ltx_ref">(Ronquist and Huelsenbeck, 2003)</a></cite>の改造版であるMrBayes5Dによる系統樹推定と、Tracerを用いた収束判定について説明します。</p>
</div>
<section id="Ch5.S1" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5.1 </span>メトロポリス・ヘイスティングス法</h3>

<div id="Ch5.S1.p1" class="ltx_para">
<p class="ltx_p">MrBayes (MrBayes5D)が行うMCMCは、メトロポリス・ヘイスティングス法(Metropolis-Hastings algorithm <cite class="ltx_cite"><a href="#bib.bib44" title="" class="ltx_ref">(Metropolis <span class="ltx_text ltx_font_italic">et al</span>., 1953; Hastings, <a href="#bib.bib24" title="" class="ltx_ref">1970</a>)</a></cite>)と呼ばれるMCMCです。この方法は、以下のような手順でパラメータを最適化していくものです。</p>
<ol id="Ch5.I1" class="ltx_enumerate">
<li id="Ch5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
              <span class="ltx_text" style="font-size:90%;">1.</span>
            </span> 
<div id="Ch5.I1.i1.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">全てのパラメータの初期値を適当に決定する</span>
              </p>
</div>
</li>
<li id="Ch5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
              <span class="ltx_text" style="font-size:90%;">2.</span>
            </span> 
<div id="Ch5.I1.i2.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">パラメータを適当に選択する</span>
              </p>
</div>
</li>
<li id="Ch5.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
              <span class="ltx_text" style="font-size:90%;">3.</span>
            </span> 
<div id="Ch5.I1.i3.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">選択されたパラメータを事前分布から導かれる提案分布に従って変更する、ことを提案する</span>
              </p>
</div>
</li>
<li id="Ch5.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
              <span class="ltx_text" style="font-size:90%;">4.</span>
            </span> 
<div id="Ch5.I1.i4.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">パラメータ変更後の尤度を計算する</span>
              </p>
</div>
</li>
<li id="Ch5.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
              <span class="ltx_text" style="font-size:90%;">5.</span>
            </span> 
<div id="Ch5.I1.i5.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">尤度が変更前より良くなっていれば提案を100%受理し、良くなっていなくても一定のルールで受理する</span>
              </p>
</div>
</li>
<li id="Ch5.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
              <span class="ltx_text" style="font-size:90%;">6.</span>
            </span> 
<div id="Ch5.I1.i6.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">2へ戻る</span>
              </p>
</div>
</li>
<li id="Ch5.I1.i7" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_enumerate">
              <span class="ltx_text" style="font-size:90%;">7.</span>
            </span> 
<div id="Ch5.I1.i7.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">以上の処理を継続しつつ、一定の間隔でモデルをサンプリングする</span>
              </p>
</div>
</li>
</ol>
<p class="ltx_p">この処理がある程度進むと定常状態(steady state)に入ります。定常状態に入る前のサンプルを捨て(burn-in)、残ったサンプルを事後分布(posterior distribution)からのサンプルと見なして事後確率(posterior probability)を得ます。</p>
</div>
</section>
<section id="Ch5.S2" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5.2 </span>MrBayes5Dによる系統樹推定</h3>

<div id="Ch5.S2.p1" class="ltx_para">
<p class="ltx_p">MrBayes5Dは現在最もよく利用されているベイジアン系統樹推定用ソフトウェアMrBayesを拡張し、より多くのアミノ酸置換モデルを使えるようにしたものです。塩基配列データの解析にはオリジナルとの違いはありません。計算も高速で多くのモデルに対応しており、MPIによる並列化にも対応しています。以下の説明のほとんどはオリジナルのMrBayesにも適用できます。塩基配列データの解析を行う場合は、本家のMrBayesの方が高速でパラメータの自動チューニングなどにも対応しているため、そちらをお使い下さい。</p>
</div>
<div id="Ch5.S2.p2" class="ltx_para">
<p class="ltx_p">Kakusan4・Aminosanで分子進化モデルの選択を行った場合、出力フォルダの<span class="ltx_text ltx_font_typewriter">MrBayes</span>フォルダ内にあるNEXUSファイルを読み込むことで容易に選択されたモデルを適用した解析が可能です。<span class="ltx_text ltx_font_typewriter">MrBayes</span>フォルダには
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">partition_criterion_xxx.nex
<br class="ltx_break"></span>というファイルが作成されているはずです。<span class="ltx_text ltx_font_typewriter">partition</span>はパーティション名、<span class="ltx_text ltx_font_typewriter">criterion</span>はモデル選択規準、<span class="ltx_text ltx_font_typewriter">xxx</span>は非区分・比例・分離モデルの適用状況を示しています。全領域連結配列は<span class="ltx_text ltx_font_typewriter">whole</span>という名前のパーティションとなっています。作成されるファイルは入力されたデータが複数遺伝子座データか、タンパクコード領域データかによって異なりますが、例えば、
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">whole_BIC4_proportional_codonproportional.nex
<br class="ltx_break"></span>(配列長(座位数)をサンプルサイズとしたBICをモデル選択規準として領域・コドン位置ごとに選ばれたモデルを比例モデルとして連結配列に当てはめる設定を適用するNEXUSファイル)
<br class="ltx_break">とか
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">whole_BIC4_codonproportional.nex
<br class="ltx_break"></span>(配列長(座位数)をサンプルサイズとしたBICをモデル選択規準としてコドン位置ごとに選ばれたモデルを比例モデルとして連結配列に当てはめる設定を適用するNEXUSファイル)
<br class="ltx_break">とか
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">whole_BIC4_nonpartitioned.nex
<br class="ltx_break"></span>(配列長(座位数)をサンプルサイズとしたBICをモデル選択規準として選ばれたモデルを連結配列に当てはめる設定を適用するNEXUSファイル)
<br class="ltx_break">といったファイルが出力されているはずです。タンパクコード領域配列では
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">whole_BIC4_nonpartitioned.nex
<br class="ltx_break"></span>は
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">whole_BIC4_codonnonpartitioned.nex
<br class="ltx_break"></span>という名前で出力されています。ただし、タンパクコード領域において全コドン位置に共通なモデルの検討を行わない設定でKakusan4によるモデル選択を行った場合はこのファイルは出力されません。</p>
</div>
<div id="Ch5.S2.p3" class="ltx_para">
<p class="ltx_p">このように、同じパーティションのデータに対して、多くのモデルの当てはめ方があり得ます。どの当てはめ方が最も適しているかはデータによって異なります。Kakusan4・Aminosanによる非区分・比例・分離モデルの比較結果を参考にしてどのモデルを適用するか＝どのファイルを用いるかを適宜選択して下さい。ただし、尤度計算に用いているTreefinderが対応していないために検討していないモデルもあるので、この結果を過度に信用しない方が良いかもしれません。MrBayes5Dは分離モデルにも対応しているため、分離モデルを適用するNEXUSファイルも出力されていますが、MrBayes5Dはあまり分離モデルを適用した解析を得意としていません(樹形探索範囲が狭くなる)。分離モデルが選択されてしまった場合には、RAxMLによる最尤系統樹推定を推奨します。</p>
</div>
<div id="Ch5.S2.p4" class="ltx_para">
<p class="ltx_p">MrBayes5Dで以上のファイルを用いてMCMCを実行するには、以下のようにコマンドを実行します。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; mrbayes5d -i partition_criterion_xxx.nex↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">MrBayes &gt; MCMC↓</span>
          </span>
</p>
<p class="ltx_p">これでMCMCは走り始めます(<span class="ltx_text ltx_font_typewriter">NGen</span>オプションで指定しない限り1,000,000ステップ)が、どれだけMCMCを走らせ続けるかが問題です。こちらに関しては次節をお読み下さい。</p>
</div>
</section>
<section id="Ch5.S3" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5.3 </span>Tracerによる収束判定と有効サンプルサイズの推定</h3>

<div id="Ch5.S3.p1" class="ltx_para">
<p class="ltx_p">MCMCで難しいのは、「収束しているか」と「収束後のサンプル数は十分か」の判断です。これを補助してくれるのがTracerです。MrBayes5DもASDSFという収束判断の参考になる値を出力してくれますが、あまり当てにならないので気にしなくていいでしょう。ASDSFは標準設定では1,000ステップごとに計算されますが、この計算が案外重いので、<span class="ltx_text ltx_font_typewriter">MCMC</span>コマンドのオプションに<span class="ltx_text ltx_font_typewriter">DiagnFreq=10000</span> (10,000ステップごとにASDSFを計算する)などと付けることでこの計算の頻度を変更してやると良いかもしれません。もしくは、<span class="ltx_text ltx_font_typewriter">MCMCDiagn=No</span>をオプションとして与えることで最初からASDSFの計算をしないようにしてもいいでしょう。<span class="ltx_text ltx_font_typewriter">NRuns=1</span>として同時に走らせるMCMCを1つに制限した場合もASDSFは計算されません。</p>
</div>
<div id="Ch5.S3.p2" class="ltx_para">
<p class="ltx_p">まず、MrBayes5DでMCMCを走らせて、以下のメッセージがでたところで、MrBayes5DはそのままにしてTracerを起動します。<span class="ltx_text ltx_font_typewriter">MCMC</span>実行時に<span class="ltx_text ltx_font_typewriter">NGen</span>オプションで指定しない限り1,000,000ステップの時点で表示されるはずです。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">MrBayes &gt; MCMC↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">中略</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Continue with analysis? (yes/no):</span>
          </span>
</p>
<p class="ltx_p">Tracerが起動したら、<span class="ltx_text ltx_font_typewriter">File</span>メニューの<span class="ltx_text ltx_font_typewriter">Import Trace File...</span>からMrBayes5Dに読み込ませているNEXUSファイルのあるフォルダにある<span class="ltx_text ltx_font_typewriter">NEXUSファイル名.run1.p</span>を指定して読み込ませます。同様に<span class="ltx_text ltx_font_typewriter">NEXUSファイル名.run2.p</span>も読み込ませます。現在のバージョンでは左側ペインへのファイルのドラッグアンドドロップによってファイルを読み込ませることも可能になっています。2つのファイルの読み込みが終わったら、左上の<span class="ltx_text ltx_font_typewriter">Trace Files</span>ペインで2つのファイル名を選択して反転表示状態にします。複数ファイルを選択するには<span class="ltx_text ltx_font_typewriter">Ctrl</span>か<span class="ltx_text ltx_font_typewriter">Shift</span>キーを押しながらファイル名を左クリックして下さい。</p>
</div>
<div id="Ch5.S3.p3" class="ltx_para">
<p class="ltx_p">ここで読み込ませた2つのファイルは、MrBayes5Dが同時に2つ(標準設定の場合)走らせているMCMCのそれぞれのモデルのパラメータ値などが保存されているログファイルです。この2つのMCMCで、パラメータが定常状態に入っているか、近い値に収束しているかをTracerで図示することで判断しようということです。</p>
</div>
<div id="Ch5.S3.p4" class="ltx_para">
<p class="ltx_p">さて、この状態で、右側ペインのタブを<span class="ltx_text ltx_font_typewriter">Trace</span>にして折れ線グラフを表示させます。そして、右下の<span class="ltx_text ltx_font_typewriter">Colour by</span>を<span class="ltx_text ltx_font_typewriter">Trace File</span>に、<span class="ltx_text ltx_font_typewriter">Legend</span>を<span class="ltx_text ltx_font_typewriter">None</span>以外にして下さい。すると、2つのMCMCの折れ線グラフが色分け表示されます(図<a href="#Ch5.F1" title="図 5.1 ‣ 5.3 Tracerによる収束判定と有効サンプルサイズの推定 ‣ 第5章 ベイジアン系統樹推定 ‣ 分子系統学演習 データセットの作成から仮説検定まで" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.1</span></a>)。左下の<span class="ltx_text ltx_font_typewriter">Traces</span>ペインで反転表示させるパラメータを変更していくと、右ペインの折れ線グラフもそれに応じて変化していきます。このプロットを見て各パラメータが定常状態(steady state)に入っているかを検討して下さい。もし定常状態に入っていそうもないようであれば、MCMCを継続して下さい。MCMCが中断したら、再度ファイルの読み込みをし直して定常状態に入るまで繰り返して下さい。</p>
</div>
<figure id="Ch5.F1" class="ltx_figure">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">図 5.1: </span>Tracerによる収束判定 — 右側のプロットでは対数尤度のステップごとの変化を表示しています。この例では70万ステップ付近で2つのMCMCがパラメータ空間内で同程度の尤度の場所に収束していると考えられます。その後の波形の乱れも一定していることから、定常状態に入っていると考えてよいでしょう。</figcaption><img src="x6.png" id="Ch5.F1.g1" class="ltx_graphics ltx_centering" width="677" height="473" alt="">
</figure>
<div id="Ch5.S3.p5" class="ltx_para">
<p class="ltx_p">定常状態には入っても、2つのMCMCが異なる局所最適解に収束してしまっている場合、両方のMCMCがより尤度の高い方へと収束するまで解析を続ける必要があります。しかし、あまりに尤度の谷が深いといつまで経っても同じところへ収束しないことがあります。そのような場合、とりあえず尤度の高い方だけが最適解付近に収束していると見なしておき、サンプル数が十分量(後述)の半分程度になるまで解析を続けます。その上で、各種出力ファイルの名前を変更してから何度も同じ解析を実行してやります。そして、2つ以上のMCMCが同じ値に収束しているものの中で、最も尤度の高いものを本当に収束しているものとして結果に採用します。</p>
</div>
<div id="Ch5.S3.p6" class="ltx_para">
<p class="ltx_p">パラメータが定常状態に入っていると確認できたら、収束後のサンプル数が十分かどうかを検討しましょう。まず、左上の<span class="ltx_text ltx_font_typewriter">Trace Files</span>ペインの<span class="ltx_text ltx_font_typewriter">Burn-In</span> (収束前で捨てるサンプル数)を適切な値に設定して下さい。この値は解析開始から定常状態に入るまでのステップ数で指定しますが、ログファイルには第1ステップの結果が入っているため、最初の1,000,000ステップをburn-inするには、この値を1,000,100に設定します。ただし、これは標準の100ステップに1回のサンプリング頻度に設定している(<span class="ltx_text ltx_font_typewriter">SampleFreq=100</span>)場合で、1,000ステップに1回に設定している場合には1,001,000にします。つまり、burn-inしたいステップ数に<span class="ltx_text ltx_font_typewriter">SampleFreq</span>の値を加えた値にするということです。ここで、MrBayes5Dの機能上の制約により、解析結果の要約(summarize)するには全ファイルの<span class="ltx_text ltx_font_typewriter">Burn-In</span>を等しくしておく必要があります。ただし、MrBayes5Dの要約機能を利用せずに第<a href="#Ch5.S4" title="5.4 解析結果の要約 ‣ 第5章 ベイジアン系統樹推定 ‣ 分子系統学演習 データセットの作成から仮説検定まで" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.4</span></a>節の方法で要約するのならばその必要はありません。</p>
</div>
<div id="Ch5.S3.p7" class="ltx_para">
<p class="ltx_p">全ファイルの<span class="ltx_text ltx_font_typewriter">Burn-In</span>を適切に設定できたら、左上<span class="ltx_text ltx_font_typewriter">Trace Files</span>ペインで<span class="ltx_text ltx_font_typewriter">Combined</span>を含む全ての項目が反転表示された状態にして下さい。また、右側ペインのタブを<span class="ltx_text ltx_font_typewriter">Marginal Density</span>に設定して事後確率密度を表示させます。そして、右下の<span class="ltx_text ltx_font_typewriter">Colour by</span>を<span class="ltx_text ltx_font_typewriter">Trace File</span>に、<span class="ltx_text ltx_font_typewriter">Legend</span>を<span class="ltx_text ltx_font_typewriter">None</span>以外にして下さい。すると、各MCMCと全MCMCから得られたパラメータの事後確率密度が色分け表示されます(図<a href="#Ch5.F2" title="図 5.2 ‣ 5.3 Tracerによる収束判定と有効サンプルサイズの推定 ‣ 第5章 ベイジアン系統樹推定 ‣ 分子系統学演習 データセットの作成から仮説検定まで" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.2</span></a>)。左下の<span class="ltx_text ltx_font_typewriter">Traces</span>ペインで反転表示させるパラメータを変更していくと、右ペインの密度曲線もそれに応じて変化していきます。このプロットを見てMCMC間で同様の密度曲線となっていることを確認して下さい。さらに、左下<span class="ltx_text ltx_font_typewriter">Traces</span>ペインのESS (effective sample size, 有効サンプルサイズ <cite class="ltx_cite"><a href="#bib.bib32" title="" class="ltx_ref">(Kass <span class="ltx_text ltx_font_italic">et al</span>., 1998)</a></cite>)の値を見ます。これが全て100、できれば200を超えるようにして下さい。100を下回るようならMCMCをさらに継続してサンプル数を増やす必要があります。</p>
</div>
<figure id="Ch5.F2" class="ltx_figure">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">図 5.2: </span>Tracerによる有効サンプルサイズの推定 — 右側のプロットは樹長の密度曲線を示しています。各MCMCの密度曲線に極端なずれがないことを確認します。また、左下ペインのESSが全て100以上になるまでMCMCを継続します。</figcaption><img src="x7.png" id="Ch5.F2.g1" class="ltx_graphics ltx_centering" width="677" height="473" alt="">
</figure>
<div id="Ch5.S3.p8" class="ltx_para">
<p class="ltx_p">各パラメータの要約統計量を見るには、右側ペインのタブを<span class="ltx_text ltx_font_typewriter">Estimates</span>にした状態で、左下<span class="ltx_text ltx_font_typewriter">Traces</span>ペインのパラメータをクリックして下さい。右側のペイン上部に表示されます。</p>
</div>
<section id="Ch5.S3.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3.1 </span>収束しやすくする・有効サンプルサイズを大きくする方法</h4>

<div id="Ch5.S3.SS1.p1" class="ltx_para">
<p class="ltx_p">MCMCでは、間隔を空けてモデルをサンプルすることで、各サンプルは独立したものとしてみなしています。しかし、独立性が低いとESSの値は小さくなります。ESSは、実際のサンプル数ではなく、サンプル間の独立性を考慮した「実質的なサンプル数」を示しています。提案(proposal)の受理率(acceptance rate)が低かったり、状態交換(state exchange)の成立が少ないと、サンプル間の独立性が下がり、ESSが小さくなります。そのようなMCMCでは、尤度の改善も進みにくいために収束に時間がかかるようになってしまいます。</p>
</div>
<div id="Ch5.S3.SS1.p2" class="ltx_para">
<p class="ltx_p">これを解決するには、2つのアプローチがあります。それは、サンプル間の独立性が低かろうがなんだろうがとにかく長くMCMCを続けてESSを十分な数にするという方法と、サンプル間の独立性を上げてステップ数当たりのESSを大きくする方法です。ESSの不足が少しだけであれば、解析を続けるだけで済む前者の方法を採るのが良いでしょう。しかし、絶望的なまでにステップ数当たりのESSが小さくとてもESSが十分になるまではやっていられないということであれば、設定を変えて解析をやり直すしかありません。</p>
</div>
<div id="Ch5.S3.SS1.p3" class="ltx_para">
<p class="ltx_p">受理率は、MCMCを停止したときに表示されますのでその値を見てどの提案の受理率が低いのかを確認します。以下のように表示されているはずです。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Acceptance rates for the moves in the "cold" chain:</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">With prob. Chain accepted changes to</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">1.23 % param. 1 (state frequencies) with Dirichlet proposal</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">以下略</span>
            </span>
</p>
<p class="ltx_p">この値が低く、ESSがとても確保できないものをメモしておき、<span class="ltx_text ltx_font_typewriter">Props</span>コマンドを使って設定を変更します。MCMCの最中でも、Tracerでパラメータ値の変遷を表示させることでパラメータの最適化の進行とかき乱れの良さを確認できます。横軸をステップ数、縦軸をパラメータ値とするプロットにおいて、上下に激しく乱れておらず矩形波になっているものがあれば、そのパラメータの最適化が進んでいないか、かき乱れが良くないと考えられます。受理率が高くても、提案頻度が低すぎて矩形波になることもあります。Tracerによる確認方法ではそれを発見可能ですので、こちらの方法の方がおすすめです。<span class="ltx_text ltx_font_typewriter">Props</span>コマンドは、以下のように用います。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">MrBayes &gt; Props↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">中略</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Select a parameter to change (1 - 36; 0 to exit; 37 to zero all proposal rates): 26↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># 変更するパラメータを選択</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Proposal 26: Change (rate multiplier) with Dirichlet proposal</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># 提案頻度は変更しないときは空欄のままEnter</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">New proposal rate (&lt;return&gt; to keep old = 1.000):↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># 提案の過激さを変更する</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">New Dirichlet parameter (&lt;return&gt; to keep old = 500.000): 50000↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">中略</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># 設定変更を終了する</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Select a parameter to change (1 - 36; 0 to exit; 37 to zero all proposal rates): 0↓</span>
            </span>
</p>
<p class="ltx_p">proposal rateはそのパラメータの変更が提案される相対頻度で、値を大きくするとより変更の提案される頻度が高くなります。提案の受理率が高くても提案頻度が低い場合はこの値を変更します。提案の受理率が低すぎるのであれば、提案頻度を上げるよりももう一方の値(提案の過激さを決定する)を変更した方が良いでしょう。この値は、大きいほど過激な提案がされたり、逆に小さいほど過激な提案がされたりとパラメータによって意味が変わりますので、MrBayesのマニュアルを見て大きくするか小さくするかを考えて下さい。多くの場合、提案が過激すぎて十中八九受理されないパラメータ値が提案されてしまっていることが多いでしょうから、提案を穏当にする方向へ値を変更すると良いでしょう。設定後に<span class="ltx_text ltx_font_typewriter">MCMC</span>コマンドでMCMCを走らせ始めることで設定の適用されたMCMCを走らせることができます。MCMCの途中で変更することはできません。</p>
</div>
<div id="Ch5.S3.SS1.p4" class="ltx_para">
<p class="ltx_p">複数領域データやタンパクコード領域データでは、比例・分離モデルやコドン位置ごとに異なる置換速度を当てはめるモデルが適用されていることが多いと思います。しかし、MrBayes5Dでは比例モデルを適用しているときにパーティションごとの置換速度パラメータ(rate multiplier)を提案するDirichlet proposalの受理率が異常に低くなることがしばしばあります。デフォルトではDirichlet parameter (提案の過激さを示す。小さいほど過激な提案がなされる)は1000 (純正のMrBayesでは500)に設定されていますが、もっと大きな値にして提案を穏当にしてやることで改善できることがあります。比例関係にあるパーティション数が多い時にこの問題が起きやすいようです。また逆に、デフォルト値では提案が穏当すぎて最適化が進まず、収束に時間がかかってしまうこともあり得ます。</p>
</div>
<div id="Ch5.S3.SS1.p5" class="ltx_para">
<p class="ltx_p">MrBayes5Dは、同時に2つのMCMCを走らせていると書きましたが、その2つのMCMCのそれぞれはさらに4つのMCMCを同時に走らせています。4つの中には乱数の乱れ(temperature)が大きい＝より過激な提案がなされる高温系列(heated chain)が3つ(temperatureは異なる)と、乱数の乱れが最も小さい低温系列(cold chain)が1つあり、MCMCからのサンプリングはこの低温系列から行われています。各系列間ではモデル状態の交換が一定の頻度で試行されます。これをMetropolis-coupled MCMC、略してMC<img src="mi/mi64.png" width="11" height="17" alt="">と言います。パラレル・テンパリング法と呼ぶこともあります。こうすることで、より早く収束し、かき乱れが良くなるため、少ないステップ数で大きなESSを得られます。状態交換(state exchange)の試行が成立するかどうかは<cite class="ltx_cite"><a href="#bib.bib44" title="" class="ltx_ref">Metropolis <span class="ltx_text ltx_font_italic">et al</span>. (1953)</a></cite>および<cite class="ltx_cite"><a href="#bib.bib24" title="" class="ltx_ref">Hastings (1970)</a></cite>のルールに従って決定されます。これは前述のパラメータ変更に関しても同じです。</p>
</div>
<div id="Ch5.S3.SS1.p6" class="ltx_para">
<p class="ltx_p">MCMCを停止すると表示されるメッセージの中に以下のようなものがあります。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Chain swap information for run 1:</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">1     2     3     4</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--------------------------</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">1 |        0.07  0.01  0.01</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">2 | 10293        0.04  0.03</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">3 |  9928 10392        0.05</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">4 | 10394  9827  9919</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">中略</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Upper diagonal: Proportion of successful state exchanges between chains</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">Lower diagonal: Number of attempted state exchanges between chains</span>
            </span>
</p>
<p class="ltx_p">これが状態交換試行の回数と交換の成立率です。1が低温系列で、2～4は順に温度が高くなっていく高温系列を示しています。温度の隣接した系列間の交換成立率が上記のように低い場合、温度の間隔(標準では0.2)を狭くしてやることで交換成立をしやすくすることで改善できる可能性があります。これは以下のようなコマンドで設定可能です。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">MrBayes &gt; MCMCP Temp=0.15↓</span>
          </p>
<p class="ltx_p">この設定後に<span class="ltx_text ltx_font_typewriter">MCMC</span>コマンドでMCMCを走らせ始めると、上記の設定が適用されたMCMCになります。</p>
</div>
</section>
</section>
<section id="Ch5.S4" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5.4 </span>解析結果の要約</h3>

<div id="Ch5.S4.p1" class="ltx_para">
<p class="ltx_p">MCMCを停止したら、そのままでは何らかの意味を見出すのは難しいので、その結果を要約する必要があります。まず初めに、burn-in (収束前で捨てるサンプル数)を決めます。前述したTracerとは違い、ここでのburn-inは解析開始からのステップ数ではなく、サンプル数です。つまり、100ステップに1回サンプルする設定(標準設定)で最初の1,000,000ステップを捨てるには、burn-inは10,001にします(MrBayes5Dは初期状態＝第1ステップを保存するため1多くなる)。最初の何ステップを捨てるべきかを判断する方法は第<a href="#Ch5.S3" title="5.3 Tracerによる収束判定と有効サンプルサイズの推定 ‣ 第5章 ベイジアン系統樹推定 ‣ 分子系統学演習 データセットの作成から仮説検定まで" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.3</span></a>節で説明しています。次に、MrBayes5Dが生成する<span class="ltx_text ltx_font_typewriter">.t</span>ファイルから要約を行います。MrBayes5Dの<span class="ltx_text ltx_font_typewriter">SumT</span>コマンドを用いる方法と、Phylogears2を用いる方法があります。後者は複数のMCMCでburn-inの値が異なる場合にも対応できます。</p>
</div>
<div id="Ch5.S4.p2" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">SumT</span>コマンドを用いて要約を行う場合、MrBayes5DにNEXUSデータファイルを読み込ませた後、以下のようにコマンドを実行します。<span class="ltx_text ltx_font_typewriter">integer</span>にはburn-inするサンプル数を入力します。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">MrBayes &gt; SumT BurnIn=integer↓</span>
        </p>
<p class="ltx_p">これで<span class="ltx_text ltx_font_typewriter">.con</span>ファイルと<span class="ltx_text ltx_font_typewriter">.parts</span>ファイルが作成されます。<span class="ltx_text ltx_font_typewriter">.con</span>はMCMCからのサンプル系統樹群から生成された多数決合意樹で、枝長は互換性のある系統樹群での平均値です。内分枝(internal/interior branch)の出現頻度はこのファイルにも書かれていますが、<span class="ltx_text ltx_font_typewriter">.parts</span>をテキストエディタで開くと、対立する内分枝も含めた支持率が書かれています。</p>
</div>
<div id="Ch5.S4.p3" class="ltx_para">
<p class="ltx_p">Phylogears2を用いる場合、まずはPhylogears2の<span class="ltx_text ltx_font_typewriter">pgsplicetree</span>で必要な系統樹だけを取り出します。以下のようにコマンドを実行します。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgsplicetree from-to 入力ファイル 出力ファイル↓</span>
        </p>
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">from-to</span>には取り出す系統樹の番号を入力します。<span class="ltx_text ltx_font_typewriter">10002-.</span>などと指定します。これは、10,002本目の系統樹から最後の系統樹までを出力ファイルに取り出すという意味です。これで、最初の10,001本の系統樹はburn-inされることになります。<span class="ltx_text ltx_font_typewriter">-500-.</span>と指定すれば、最後から500本目の系統樹から最後の系統樹までを出力ファイルに取り出すことができます。複数の<span class="ltx_text ltx_font_typewriter">.t</span>ファイルがある場合(標準設定では2つできます)、以上の処理を全ての<span class="ltx_text ltx_font_typewriter">.t</span>ファイルに対して行った後、<span class="ltx_text ltx_font_typewriter">pgjointree</span>で出力したファイルを結合します。以下のようにコマンドを実行して下さい。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgjointree 入力ファイル1 入力ファイル2 出力ファイル↓</span>
        </p>
<p class="ltx_p">入力ファイル名は3つ以上指定することも可能です。このファイルを<span class="ltx_text ltx_font_typewriter">pgsumtree</span>に与えて出力を得ます。<span class="ltx_text ltx_font_typewriter">pgsumtree</span>の使い方は第<a href="#Ch6.S4" title="6.4 内分枝出現頻度の分析 ‣ 第6章 系統樹の編集・統計と可視化 ‣ 分子系統学演習 データセットの作成から仮説検定まで" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.4</span></a>節をご覧下さい。</p>
</div>
<div id="Ch5.S4.p4" class="ltx_para">
<p class="ltx_p">その他の各種パラメータの要約は第<a href="#Ch5.S3" title="5.3 Tracerによる収束判定と有効サンプルサイズの推定 ‣ 第5章 ベイジアン系統樹推定 ‣ 分子系統学演習 データセットの作成から仮説検定まで" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.3</span></a>節をご参照下さい。</p>
</div>
</section>
<section id="Ch5.S5" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5.5 </span>MrBayes5D MPI版による並列計算</h3>

<div id="Ch5.S5.p1" class="ltx_para">
<p class="ltx_p">インストール方法のところで述べたように、MrBayes5DはMPIによる並列化版<cite class="ltx_cite"><a href="#bib.bib8" title="" class="ltx_ref">(Altekar <span class="ltx_text ltx_font_italic">et al</span>., 2004)</a></cite>があり、これを用いることで大規模な解析を高速に行うことができます。<span class="ltx_text ltx_font_typewriter">~/</span>にmrbayes5d-mpiとして実行ファイルがあるとすると、起動するには以下のようにコマンドを実行します。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; mpirun -np 利用するCPU数 ~/mrbayes5d-mpi -i NEXUSファイル名↓</span>
        </p>
<p class="ltx_p">なお、MPIフレームワークとしてLAM/MPIをインストールした場合は<span class="ltx_text ltx_font_typewriter">mpirun</span>で起動する前に<span class="ltx_text ltx_font_typewriter">lamboot -v</span>を実行しておく必要があります。解析後は<span class="ltx_text ltx_font_typewriter">lamhalt</span>を実行しておきます。起動後は通常版と同様に扱うことができますが、<span class="ltx_text ltx_font_typewriter">Props</span>コマンドによる提案に関する各種パラメータの変更を正常に行うことができません。そのため、これらのパラメータを変更したい場合は、ソースコードに書かれているパラメータを直接書き換え、そのソースから作成した実行ファイルを用いる必要があります。当該箇所は<span class="ltx_text ltx_font_typewriter">mcmc.c</span>の<span class="ltx_text ltx_font_typewriter">SetUpMoveTypes</span>関数にあります。</p>
</div>
<div id="Ch5.S5.p2" class="ltx_para">
<p class="ltx_p">MrBayes5Dでは、標準では4系列(NChains)<img src="mi/mi59.png" width="17" height="15" alt="">2セット(NRuns)で合計8系列のMCMCが実行されます。この状態では最大で8つまでしかCPUを用いることができません。1つの系列に複数のCPUを割り当てることができないためです。大量のCPUがあっても、1つの系列当たりの解析を高速化することはできません。系列数を増加させて温度間隔を狭くすることで系列間の状態交換試行が成立しやすくすることはできますが、劇的に高速化したりはしません。逆に1ステップ当たりの状態交換試行数(NSwaps)を増やさないと、交換の絶対数が減ってしまって系列間の混合具合が悪くなってしまいます。NRunsを増やしても、必要なサンプル数を確保するためのステップ数を小さくすることはできますが、計算そのものを高速化はできません。大量のCPUを用いた高速化が必要な場合は、ExaBayes <cite class="ltx_cite"><a href="#bib.bib4" title="" class="ltx_ref">(Aberer <span class="ltx_text ltx_font_italic">et al</span>., 2014)</a></cite>をご利用下さい。</p>
</div>
</section>
</section>
<section id="Ch6" class="ltx_chapter">
<h2 class="ltx_title ltx_title_chapter">
<span class="ltx_tag ltx_tag_chapter">第6章 </span>系統樹の編集・統計と可視化</h2>

<section id="Ch6.S1" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6.1 </span>クレード・単系統・側系統・多系統・祖先的・派生的</h3>

<div id="Ch6.S1.p1" class="ltx_para">
<p class="ltx_p">ここではよく使う用語の定義を説明しておきます。</p>
</div>
<div id="Ch6.S1.p2" class="ltx_para">
<p class="ltx_p">まず、クレード(clade)についてです。クレードとは、系統樹上で複数のOTUが所属する部分系統樹のことです。ただし、有根系統樹と無根系統樹ではやや意味が異なります。無根系統樹では、ある内分枝(internal/interior branch)の一方の端点に接続されている部分系統樹をクレードと言いますが、有根系統樹では内分枝の根から遠い側の端点に接続されている部分系統樹を指します。つまり、有根系統樹上のクレードが根点を含むことはありません。</p>
</div>
<div id="Ch6.S1.p3" class="ltx_para">
<p class="ltx_p">次に、単系統(monophyly)・側系統(paraphyly)・多系統(polyphyly)です。有根系統樹上で、クレードを形成する分類群を単系統群(monophyletic group)と呼びます。これに対して、メンバーを全て含んでいる最小のクレード内にメンバーでない単系統群を含み、かつ全メンバーに共通の祖先とそこから各OTUまでの枝に当たる生物がその分類群に分類されるような分類群を側系統群(paraphyletic group)と言います。例えば魚類や両生類、爬虫類は側系統群です。メンバーを全て含んでいる最小のクレード内にメンバーでない単系統群を含み、かつ全メンバーに共通の祖先とそこから各OTUまでの枝に当たる生物のいずれかがその分類群に分類されないのが多系統群です。この定義では、共通祖先と共通祖先から各OTUまでの枝に当たる生物の形質状態が問題になり、特定できない状況ではこれらの言葉は使わないようにすべきだと思います。</p>
</div>
<div id="Ch6.S1.p4" class="ltx_para">
<p class="ltx_p">念のため図<a href="#Ch6.F1" title="図 6.1 ‣ 6.1 クレード・単系統・側系統・多系統・祖先的・派生的 ‣ 第6章 系統樹の編集・統計と可視化 ‣ 分子系統学演習 データセットの作成から仮説検定まで" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.1</span></a>のような有根系統樹の場合を考えましょう。この系統樹では、(TaxonA, TaxonB)・(TaxonC, TaxonD)・(TaxonA, TaxonB, TaxonC, TaxonD)は単系統群です。(TaxonA, TaxonB, TaxonC)・(TaxonA, TaxonB, TaxonD)・(TaxonA, TaxonC, TaxonD)・(TaxonB, TaxonC, TaxonD)は、根点に当たる共通祖先と根点から各OTUまでの枝が同一分類群に分類されるなら側系統群です。(TaxonA, TaxonC)・(TaxonA, TaxonD)・(TaxonB, TaxonC)・(TaxonB, TaxonD)は、共通祖先(根点)か根点から各OTUまでの枝のどこかが同一分類群でないなら多系統で、同一分類群であると言えるなら側系統群です。</p>
</div>
<figure id="Ch6.F1" class="ltx_figure">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">図 6.1: </span>単系統・側系統・多系統の例</figcaption><img src="x4.png" id="Ch6.F1.g1" class="ltx_graphics ltx_centering" width="677" height="258" alt="">
</figure>
<div id="Ch6.S1.p5" class="ltx_para">
<p class="ltx_p">最後に、祖先的(ancestral/plesiomorphic)・派生的(derived/apomorphic)という言葉に関する注意点です。この言葉は二つの意味で使われています。一つは特定の形質(やそれを有するOTU・単系統群)を指して実際により古くからあるものを祖先的、新しいものを派生的と言っている場合です。もう一つは、単に有根系統樹上でより根に近い(間にある分岐数が少ない)ものを祖先的、遠いものを派生的と言っている場合があります。この二つを混同しないように注意が必要です。というのも、根に近い単系統群の形質が祖先的であるとは限らないからです。</p>
</div>
</section>
<section id="Ch6.S2" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6.2 </span>系統樹ファイルの形式と相互変換</h3>

<div id="Ch6.S2.p1" class="ltx_para">
<p class="ltx_p">系統樹のファイル形式は主にPHYLIP/Newick形式とNEXUS形式があります。PHYLIP/Newick形式は以下のようなものです。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| 3</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| (TaxonA:0.1,TaxonB:0.1,(TaxonC:0.1,TaxonD:0.1):0.1);</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| (TaxonA:0.1,TaxonC:0.1,(TaxonB:0.1,TaxonD:0.1):0.1);</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| (TaxonA:0.1,TaxonD:0.1,(TaxonB:0.1,TaxonC:0.1):0.1);</span>
          </span>
</p>
<p class="ltx_p">最初の行はファイル中の系統樹の本数を示していますが、これは省略されていることもあります。コロン(<span class="ltx_text ltx_font_typewriter">:</span>)の後ろの数字は枝長を示しています。PHYLIP形式は、OTU名に使用できる文字数が10文字までである点がNewick形式との違いです。これに対して、NEXUS形式は以下のようになっています。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| #NEXUS</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| Begin Trees;</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|   tree tree_1 = [&amp;U] (TaxonA:0.1,TaxonB:0.1,(TaxonC:0.1,TaxonD:0.1):0.1);</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|   tree tree_2 = [&amp;U] (TaxonA:0.1,TaxonC:0.1,(TaxonB:0.1,TaxonD:0.1):0.1);</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|   tree tree_3 = [&amp;U] (TaxonA:0.1,TaxonD:0.1,(TaxonB:0.1,TaxonC:0.1):0.1);</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| End;</span>
          </span>
</p>
<p class="ltx_p">系統樹部分の体裁はほとんど同じですが、Treesブロック内に書かれています。<span class="ltx_text ltx_font_typewriter">[&amp;U]</span>は、系統樹が無根系統樹であることを示しています。有根系統樹では<span class="ltx_text ltx_font_typewriter">[&amp;R]</span>になります。この記述は省略可能です。また、下記のようにTranslateコマンドを用いて系統樹内のOTU名を数字に置き換えているものもあります。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| #NEXUS</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| Begin Trees;</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|   Translate</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|     1 TaxonA,</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|     2 TaxonB,</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|     3 TaxonC,</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|     4 TaxonD;</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|   tree tree_1 = [&amp;U] (1:0.1,2:0.1,(3:0.1,4:0.1):0.1);</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|   tree tree_2 = [&amp;U] (1:0.1,3:0.1,(2:0.1,4:0.1):0.1);</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">|   tree tree_3 = [&amp;U] (1:0.1,4:0.1,(2:0.1,3:0.1):0.1);</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| End;</span>
          </span>
</p>
<p class="ltx_p">大量の系統樹を1ファイルに保存するときにはこちらの形式の方が容量は小さくなるでしょう。</p>
</div>
<section id="Ch6.S2.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2.1 </span>Phylogears2による変換</h4>

<div id="Ch6.S2.SS1.p1" class="ltx_para">
<p class="ltx_p">Phylogears2には、系統樹ファイル形式を変換することができる<span class="ltx_text ltx_font_typewriter">pgconvtree</span>コマンドが含まれています。PHYLIP/Newick・NEXUSに加えてTreefinderのTL Report形式を読み込み、Newick/PHYLIPかNEXUS形式へ書き出すことができます。使い方は下記のようになります。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgconvtree --output=Newick 入力ファイル 出力ファイル↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgconvtree --output=NEXUS 入力ファイル 出力ファイル↓</span>
            </span>
</p>
<p class="ltx_p">Translateコマンドを使用しているNEXUS形式を読み込むことはできますが、書き出すことはできませんので注意して下さい。</p>
</div>
</section>
</section>
<section id="Ch6.S3" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6.3 </span>系統樹の有根化と樹形の変形</h3>

<section id="Ch6.S3.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3.1 </span>Phylogears2による有根化と樹形改変</h4>

<div id="Ch6.S3.SS1.p1" class="ltx_para">
<p class="ltx_p">現在開発中です。</p>
</div>
</section>
</section>
<section id="Ch6.S4" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6.4 </span>内分枝出現頻度の分析</h3>

<div id="Ch6.S4.p1" class="ltx_para">
<p class="ltx_p">そもそも系統樹は複数の系統仮説の集合体です。
たとえば、図<a href="#Ch6.F2" title="図 6.2 ‣ 6.4 内分枝出現頻度の分析 ‣ 第6章 系統樹の編集・統計と可視化 ‣ 分子系統学演習 データセットの作成から仮説検定まで" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.2</span></a>aの最尤系統樹には図<a href="#Ch6.F2" title="図 6.2 ‣ 6.4 内分枝出現頻度の分析 ‣ 第6章 系統樹の編集・統計と可視化 ‣ 分子系統学演習 データセットの作成から仮説検定まで" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.2</span></a>b, cのような系統仮説が含まれています。
つまり図<a href="#Ch6.F2" title="図 6.2 ‣ 6.4 内分枝出現頻度の分析 ‣ 第6章 系統樹の編集・統計と可視化 ‣ 分子系統学演習 データセットの作成から仮説検定まで" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.2</span></a>b, cの系統仮説は互いに矛盾せず同時に成立し得る＝互換性がある、と言えます。
また、系統樹そのものもまた多数の互換性のある系統仮説が同時に成立するという系統仮説です。
系統仮説の実体は系統樹上に現れる内分枝(他の枝とのみ接している枝)なので、図<a href="#Ch6.F2" title="図 6.2 ‣ 6.4 内分枝出現頻度の分析 ‣ 第6章 系統樹の編集・統計と可視化 ‣ 分子系統学演習 データセットの作成から仮説検定まで" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.2</span></a>b–eのように系統仮説もまた系統樹として表現することができます。</p>
</div>
<figure id="Ch6.F2" class="ltx_figure">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">図 6.2: </span>系統樹と系統仮説 — aの系統樹を分解するとb, cの系統仮説になります。aで点線・破線の内分枝はb, cの同じ線の内分枝に対応しています。b–eの系統仮説間の矢印は黒塗りが互換性あり、白抜きが互換性無しということを意味します。</figcaption><img src="x8.png" id="Ch6.F2.g1" class="ltx_graphics ltx_centering" width="675" height="318" alt="">
</figure>
<div id="Ch6.S4.p2" class="ltx_para">
<p class="ltx_p">多数決合意樹を見れば、最も多く出現する系統仮説＝内分枝は分かりますが、それらと矛盾する内分枝の再現率は分かりません。そこで、Phylogears2に含まれている<span class="ltx_text ltx_font_typewriter">pgsumtree</span>を用いることで、ブートストラップ解析やMCMCで現れた全ての内分枝の出現頻度を得ることができます。</p>
</div>
<div id="Ch6.S4.p3" class="ltx_para">
<p class="ltx_p">まず、コマンドプロンプトやターミナルを起動して、ブートストラップ解析の各反復から得られた系統樹(第<a href="#Ch4.S3" title="4.3 RAxMLによるブートストラップ解析 ‣ 第4章 最尤系統樹推定 ‣ 分子系統学演習 データセットの作成から仮説検定まで" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>節に従って解析した場合は<span class="ltx_text ltx_font_typewriter">RAxML_bootstrap.*</span>というファイル)またはMCMCの結果が保存してあるフォルダに移動します。そして、以下のようにコマンドを実行します。なお、<span class="ltx_text ltx_font_typewriter">--mode=CONSENSE</span>にすれば、多数決合意樹を出力させることもできます。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgsumtree --mode=ALL 入力ファイル 出力ファイル↓</span>
        </p>
<p class="ltx_p">解析結果は入力ファイルと同じ形式の系統樹ファイルとなっています。仮にNewick形式のファイルを入力ファイルとして与えて開いたとすると、下記のようになっているはずです。この例は16OTUのデータで100反復のブートストラップ解析結果を<span class="ltx_text ltx_font_typewriter">pgsumtree</span>で解析したものです。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| [majorhypothesis_1] ((TaxonA,TaxonB,TaxonC,TaxonD,TaxonE,TaxonF,TaxonG,TaxonH,TaxonI,TaxonJ,TaxonK,TaxonL,TaxonM,TaxonN)100.0,(TaxonO,TaxonP));</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| [majorhypothesis_2] ((TaxonA,TaxonO,TaxonP,TaxonB,TaxonC,TaxonD,TaxonE,TaxonF,TaxonG,TaxonH,TaxonI,TaxonJ,TaxonM,TaxonN)100.0,(TaxonK,TaxonL));</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| [majorhypothesis_3] ((TaxonA,TaxonB,TaxonC,TaxonD,TaxonE,TaxonF,TaxonH,TaxonI,TaxonJ,TaxonK,TaxonL,TaxonM)100.0,(TaxonO,TaxonP,TaxonG,TaxonN));</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| [majorhypothesis_4] ((TaxonA,TaxonO,TaxonP,TaxonB,TaxonE,TaxonF,TaxonG,TaxonH,TaxonI,TaxonJ,TaxonK,TaxonL,TaxonM,TaxonN)100.0,(TaxonC,TaxonD));</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| [majorhypothesis_5] ((TaxonA,TaxonO,TaxonP,TaxonC,TaxonD,TaxonF,TaxonG,TaxonH,TaxonI,TaxonJ,TaxonK,TaxonL,TaxonM,TaxonN)98.0,(TaxonB,TaxonE));</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| [majorhypothesis_6] ((TaxonA,TaxonO,TaxonP,TaxonB,TaxonC,TaxonD,TaxonE,TaxonF,TaxonH,TaxonI,TaxonJ,TaxonK,TaxonL,TaxonM)85.0,(TaxonG,TaxonN));</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| 略</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| [minorhypothesis_1] ((TaxonA,TaxonO,TaxonP,TaxonB,TaxonE,TaxonF,TaxonG,TaxonH,TaxonJ,TaxonK,TaxonL,TaxonM,TaxonN)25.0,(TaxonC,TaxonD,TaxonI));</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| [minorhypothesis_2] ((TaxonA,TaxonB,TaxonC,TaxonD,TaxonE,TaxonF,TaxonH,TaxonI,TaxonJ,TaxonK,TaxonL)21.0,(TaxonO,TaxonP,TaxonG,TaxonM,TaxonN));</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| [minorhypothesis_3] ((TaxonA,TaxonB,TaxonC,TaxonD,TaxonE,TaxonF,TaxonH,TaxonI,TaxonK,TaxonL,TaxonM)17.0,(TaxonO,TaxonP,TaxonG,TaxonJ,TaxonN));</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| [minorhypothesis_4] ((TaxonA,TaxonH,TaxonJ)15.0,(TaxonO,TaxonP,TaxonB,TaxonC,TaxonD,TaxonE,TaxonF,TaxonG,TaxonI,TaxonK,TaxonL,TaxonM,TaxonN));</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| [minorhypothesis_5] ((TaxonA,TaxonO,TaxonP,TaxonB,TaxonE,TaxonF,TaxonG,TaxonH,TaxonJ,TaxonK,TaxonL,TaxonN)14.0,(TaxonC,TaxonD,TaxonI,TaxonM));</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| [minorhypothesis_6] ((TaxonA,TaxonC,TaxonD,TaxonM)12.0,(TaxonO,TaxonP,TaxonB,TaxonE,TaxonF,TaxonG,TaxonH,TaxonI,TaxonJ,TaxonK,TaxonL,TaxonN));</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| 略</span>
          </span>
</p>
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">majorhypothesis</span>は多数決合意樹に出力された内分枝を表す系統樹で、全て互いに互換性があります。<span class="ltx_text ltx_font_typewriter">minorhypothesis</span>は多数決合意樹とは矛盾する内分枝＝非互換な仮説を表す系統樹で、<span class="ltx_text ltx_font_typewriter">majorhypothesis</span>のいずれか1つ以上の系統仮説と非互換な仮説群です。<span class="ltx_text ltx_font_typewriter">minorhypothesis</span>の仮説間は互換性があるものも無いものも混じっています。いずれも系統樹にも出現頻度が含まれています。85%の確率で出現した<span class="ltx_text ltx_font_typewriter">majorhypothesis_6</span>という系統仮説は、TaxonGとTaxonNからなるクレードと、それ以外のOTUからなるクレードとを隔てる内分枝であることを表しています。これと非互換な系統仮説を探すには、<span class="ltx_text ltx_font_typewriter">minorhypothesis</span>の中から探せばいいわけです。ただ、目視で探すのは面倒なので、それよりは多少楽で確実な方法を用意してあります。まずは<span class="ltx_text ltx_font_typewriter">pgsplicetree</span>コマンドを用いて<span class="ltx_text ltx_font_typewriter">majorhypothesis_6</span>だけを別ファイル(仮に<span class="ltx_text ltx_font_typewriter">majorhypothesis_6.nwk</span>とする)に取り出します。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgsplicetree 6 入力ファイル majorhypothesis_6.nwk↓</span>
        </p>
<p class="ltx_p">その上で、以下のようにしてこの出力ファイル内の系統樹と非互換な系統仮説をブートストラップ解析やMCMCの結果から探し出します。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgsumtree --mode=ALLi --treefile=majorhypothesis_6.nwk 入力ファイル 出力ファイル↓</span>
        </p>
<p class="ltx_p">出力結果をテキストエディタで開くと以下のようになっています。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| [majorincompatible_1_of_tree_1] ((TaxonA,TaxonB,TaxonC,TaxonD,TaxonE,TaxonF,TaxonH,TaxonI,TaxonJ,TaxonK,TaxonL,TaxonM,TaxonN)8.0,(TaxonO,TaxonP,TaxonG));</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| [minorincompatible_1_of_tree_1] ((TaxonA,TaxonB,TaxonC,TaxonD,TaxonE,TaxonF,TaxonG,TaxonH,TaxonI,TaxonJ,TaxonK,TaxonL,TaxonM)7.0,(TaxonO,TaxonP,TaxonN));</span>
          </span>
</p>
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">majorincompatible_N_of_tree_K</span>は、入力ファイル内で見られる系統仮説の中で、<span class="ltx_text ltx_font_typewriter">--treefile</span>オプションで指定した系統樹ファイルのK番目の系統樹と非互換なもので、かつN番目に出現頻度の高いものです。Nが2以上のものもあるかもしれませんが、これはN=1の系統仮説と互換性があるということです。<span class="ltx_text ltx_font_typewriter">minorincompatible</span>は<span class="ltx_text ltx_font_typewriter">majorincompatible</span>のどれか1つ以上の仮説と非互換な仮説であることを表しています。<span class="ltx_text ltx_font_typewriter">majorincompatible</span>の仮説間では互換性がありますが、<span class="ltx_text ltx_font_typewriter">minorincompatible</span>の仮説間では互換性があったり無かったりします。<span class="ltx_text ltx_font_typewriter">majorincompatible_1</span>は非互換な仮説の中で出現頻度最大なので第2位の仮説と言えるでしょう。<span class="ltx_text ltx_font_typewriter">minorincompatible_1</span>は第3位の仮説と考えられます。第4位以下の仮説を探すには、1位から3位までの全ての仮説のいずれとも非互換な仮説を探さなくてはなりませんが、まだその方法は用意していません。出現頻度はブートストラップ解析の反復数・MCMCのサンプル数が小さいとかなり変動しますので、第2位の仮説が本当に第2位かどうかはよく検討する必要があります。</p>
</div>
</section>
</section>
<section id="Ch7" class="ltx_chapter">
<h2 class="ltx_title ltx_title_chapter">
<span class="ltx_tag ltx_tag_chapter">第7章 </span>仮説検定</h2>

<div id="Ch7.p1" class="ltx_para">
<p class="ltx_p">第<a href="#Ch6.S4" title="6.4 内分枝出現頻度の分析 ‣ 第6章 系統樹の編集・統計と可視化 ‣ 分子系統学演習 データセットの作成から仮説検定まで" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.4</span></a>節で述べたようにして非互換な系統仮説を探すことができます。また、過去の論文から非互換な系統仮説を得られることもあるでしょう。いずれかの仮説を厳密に棄却できるかどうかを検討するには、各系統仮説を制約として課した系統樹推定の結果を比較します。ここではRAxMLによる制約付き最尤系統樹推定とMrBayes5Dを用いた制約付きベイジアン系統樹推定の方法と、制約付き最尤系統樹推定の結果に基づいたKH・SH・AU検定、Bayes factorによる仮説比較について説明します。</p>
</div>
<section id="Ch7.S1" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7.1 </span>RAxMLによる樹形制約付き最尤系統樹推定</h3>

<div id="Ch7.S1.p1" class="ltx_para">
<p class="ltx_p">RAxMLで樹形制約(topological constraint)を課した系統樹推定を行うには、まず制約となる系統樹を作成する必要があります。例えば、TaxonA～TaxonEの5 OTUのデータでTaxonAとTaxonBの単系統性(monophyly)を制約として課す場合、以下のような系統樹ファイルを用意します。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| ((TaxonA,TaxonB),TaxonC,TaxonD,TaxonE);</span>
        </p>
<p class="ltx_p">以下のようにしても無根系統樹として見れば意味は同じです。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| ((TaxonA,TaxonB),(TaxonC,TaxonD,TaxonE));</span>
        </p>
<p class="ltx_p">TaxonAとTaxonBの単系統性だけでなく、さらにTaxonAとTaxonBとTaxonCの単系統性も課すには、以下のようなファイルにします。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| (((TaxonA,TaxonB),TaxonC),TaxonD,TaxonE);</span>
        </p>
<p class="ltx_p">このように、「特定の系統仮説を満たす」樹形制約を正の制約(positive constraint)と言います。正の制約下の系統樹推定では、その系統仮説と互換性のある系統樹の中でベストな系統樹を探索することになります。「特定の系統仮説を満たさない」という制約もあり、これを負の制約(negative constraint)と呼びます。負の制約下の系統樹推定では、その系統仮説と互換性の無い系統樹の中でベストな系統樹を探索することになります。RAxMLは負の制約に対応していないため、単系統「でない」という制約を課すことができません。しかし、ブートストラップ解析結果から得られる内分枝出現頻度を見れば、その負の制約下で最も尤度の高い樹形を含む正の制約＝第2位の系統仮説が推定できます(必ずこうなるわけではありませんが)ので、それを課した樹形探索を行うことで対処することができます。</p>
</div>
<div id="Ch7.S1.p2" class="ltx_para">
<p class="ltx_p">制約を表す系統樹ファイルが用意できたら、
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">partition_criterion_xxx_shotgunsearch.bat
<br class="ltx_break"></span>をテキストエディタで開いて編集し、オプションに<span class="ltx_text ltx_font_typewriter">-g 樹形制約の系統樹ファイル</span>を加えて下さい。これで制約を課した最尤系統樹推定が行われます。また、<span class="ltx_text ltx_font_typewriter">-n</span>オプションの文字列も変更して下さい。このオプションは出力ファイルの拡張子を指定するものです。例えば<span class="ltx_text ltx_font_typewriter">-n constrainedML</span>とした場合、制約付き最尤系統樹は<span class="ltx_text ltx_font_typewriter">RAxML_bestTree.constrainedML</span>という名前になります。編集したら念のため別名で保存し、実行して下さい。</p>
</div>
</section>
<section id="Ch7.S2" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7.2 </span>CONSELによる仮説検定</h3>

<div id="Ch7.S2.p1" class="ltx_para">
<p class="ltx_p">複数の系統仮説を比較したいとき、それぞれの仮説を制約として課した最尤系統樹推定によって得られた制約下の最尤系統樹を比較してやることで、どの仮説が他の仮説より良いか、それは有意な違いかを調べることができます。また、特定の単系統性を検証したいときは、その単系統性の制約下の最尤系統樹と、その単系統性とは矛盾する仮説、即ち負の制約下の最尤系統樹とを比較してやればよいでしょう。ここではブートストラップリサンプリングを応用した検定法の実行方法について説明します。</p>
</div>
<section id="Ch7.S2.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.2.1 </span>KH・SH・AU検定</h4>

<div id="Ch7.S2.SS1.p1" class="ltx_para">
<p class="ltx_p">ブートストラップリサンプリングによって、複数の系統樹間で尤度の差が有意と言えるのか否かを調べる方法がKishino-Hasegawa検定(KH test)です<cite class="ltx_cite"><a href="#bib.bib36" title="" class="ltx_ref">(Kishino and Hasegawa, 1989)</a></cite>。しかし、この方法では3つ以上の系統樹を比較する場合に多重検定となってしまい第1種の過誤(有意な差は無いのに誤検出する)が増大してしまうため、その抑制を行う補正を加えたのがShimodaira-Hasegawa検定(SH test)です<cite class="ltx_cite"><a href="#bib.bib58" title="" class="ltx_ref">(Shimodaira and Hasegawa, 1999)</a></cite>。ただし、この方法では逆に第2種の過誤(有意な差があるのに検出できない)が増大してしまいます。そこで、近似的に不偏な検定(approximately unbiased (AU) test)は、マルチスケールブートストラップ法を用いてさらに高度な補正を行うことでこれをある程度解決しています<cite class="ltx_cite"><a href="#bib.bib57" title="" class="ltx_ref">(Shimodaira, 2002)</a></cite>。</p>
</div>
<div id="Ch7.S2.SS1.p2" class="ltx_para">
<p class="ltx_p">CONSELでこれらの検定を行うには、あらかじめ比較する系統樹を最尤法で推定しておきます。これまでの説明の通りに解析を行っていれば、<span class="ltx_text ltx_font_typewriter">RAxML_bestTree.*</span>というファイルができているはずです。まずはこれらを<span class="ltx_text ltx_font_typewriter">pgjointree</span>で結合します。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgjointree 入力ファイル1 入力ファイル2 出力ファイル↓</span>
          </p>
<p class="ltx_p">比較したい系統樹が3つ以上ある場合は3つ以上入力ファイルを指定して下さい。ファイルが用意できたら、
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">partition_criterion_xxx_singlesearch.bat
<br class="ltx_break"></span>をテキストエディタで開いて編集します。<span class="ltx_text ltx_font_typewriter">-f</span>オプションが<span class="ltx_text ltx_font_typewriter">-f d</span>になっていると思いますが、これを<span class="ltx_text ltx_font_typewriter">-f G</span>にします。さらにオプションに<span class="ltx_text ltx_font_typewriter">-z 比較する系統樹のファイル</span>を加えて下さい。また、<span class="ltx_text ltx_font_typewriter">-n</span>オプションの文字列も変更して下さい。このオプションは出力ファイルの拡張子を指定するものです。例えば<span class="ltx_text ltx_font_typewriter">-n calcsitewiseLL</span>とした場合、座位ごとの尤度が<span class="ltx_text ltx_font_typewriter">RAxML_perSiteLLs.calcsitewiseLL</span>という名前のファイルに保存されます。編集したら念のため別名で保存し、実行して下さい。計算が終わったら、出力された<span class="ltx_text ltx_font_typewriter">RAxML_perSiteLLs.calcsitewiseLL</span>のファイル名を<span class="ltx_text ltx_font_typewriter">RAxML_perSiteLLs.calcsitewiseLL.sitelh</span>に変更して下さい。これは、CONSELが入力ファイルの拡張子を<span class="ltx_text ltx_font_typewriter">.sitelh</span>と仮定しているためです。</p>
</div>
<div id="Ch7.S2.SS1.p3" class="ltx_para">
<p class="ltx_p">座位ごとの尤度のファイルが用意できたら、CONSELの<span class="ltx_text ltx_font_typewriter">makermt</span>コマンドでマルチスケールブートストラップリサンプリングを行います。これは以下のように実行します。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; makermt --puzzle RAxML_perSiteLLs.calcsitewiseLL↓</span>
          </p>
<p class="ltx_p">入力ファイル名には拡張子を付けないことに注意して下さい。マルチスケールブートストラップリサンプリングが正常に終わっていれば、<span class="ltx_text ltx_font_typewriter">RAxML_perSiteLLs.calcsitewiseLL.rmt</span>というファイルができています。</p>
</div>
<div id="Ch7.S2.SS1.p4" class="ltx_para">
<p class="ltx_p">次に、下記のように<span class="ltx_text ltx_font_typewriter">consel</span>コマンドで<span class="ltx_text ltx_font_italic">p</span>値を計算して下さい。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; consel RAxML_perSiteLLs.calcsitewiseLL↓</span>
          </p>
<p class="ltx_p">これで<span class="ltx_text ltx_font_typewriter">RAxML_perSiteLLs.calcsitewiseLL.pv</span>というファイルができますが、このファイルは人間が見ても意味不明です。これを意味がわかるように表示するのが<span class="ltx_text ltx_font_typewriter">catpv</span>です。以下のように実行して下さい。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; catpv RAxML_perSiteLLs.calcsitewiseLL↓</span>
          </p>
<p class="ltx_p">結果は以下のように表示されます。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># reading RAxML_perSiteLLs.calcsitewiseLL.pv</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># rank item    obs     au     np |     bp     pp     kh     sh    wkh    wsh |</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">#    1    1   -8.4  0.887  0.882 |  0.879  1.000  0.885  0.885  0.885  0.885 |</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">#    2    2    8.4  0.113  0.118 |  0.121 2e-004  0.115  0.115  0.115  0.115 |</span>
            </span>
</p>
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">rank</span>は尤度による順位、<span class="ltx_text ltx_font_typewriter">item</span>は系統樹ファイル中での順序、<span class="ltx_text ltx_font_typewriter">obs</span>は対数尤度の差、<span class="ltx_text ltx_font_typewriter">au</span>はAU検定の<span class="ltx_text ltx_font_typewriter">p</span>値、<span class="ltx_text ltx_font_typewriter">np</span>はマルチスケールブートストラップリサンプリングから推定された尤度最大となる確率、<span class="ltx_text ltx_font_typewriter">bp</span>は通常のブートストラップリサンプリングを行なって推定された尤度最大となる確率、<span class="ltx_text ltx_font_typewriter">pp</span>はベイジアン事後確率、<span class="ltx_text ltx_font_typewriter">kh</span>はKH検定の<span class="ltx_text ltx_font_typewriter">p</span>値、<span class="ltx_text ltx_font_typewriter">sh</span>はSH検定の<span class="ltx_text ltx_font_typewriter">p</span>値、<span class="ltx_text ltx_font_typewriter">wkh</span>はweighted-KH検定の<span class="ltx_text ltx_font_typewriter">p</span>値、<span class="ltx_text ltx_font_typewriter">wsh</span>はweighted-SH検定の<span class="ltx_text ltx_font_typewriter">p</span>値となっています。</p>
</div>
</section>
</section>
<section id="Ch7.S3" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7.3 </span>MrBayes5Dによる樹形制約付きベイジアン系統樹推定</h3>

<div id="Ch7.S3.p1" class="ltx_para">
<p class="ltx_p">RAxMLと同様に、TaxonA～TaxonEの5 OTUのデータでTaxonAとTaxonBの単系統性(monophyly)を制約として課す場合を考えましょう。その場合、以下のようなコマンドをNEXUSデータファイル読み込み後に実行することで樹形探索に制約が課されるようになります。コマンドをNEXUSファイルのMrBayesブロックに記述しても結構です(行末にはセミコロンを付加する必要があります)。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">MrBayes &gt; Constraint monophyly1 100=TaxonA TaxonB↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">MrBayes &gt; PrSet TopologyPr=Constraints(monophyly1)↓</span>
          </span>
</p>
<p class="ltx_p">さらにTaxonAとTaxonBとTaxonCの単系統性も強制する場合は以下のようにします。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">MrBayes &gt; Constraint monophyly1 100=TaxonA TaxonB↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">MrBayes &gt; Constraint monophyly2 100=TaxonA TaxonB TaxonC↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">MrBayes &gt; PrSet TopologyPr=Constraints(monophyly1,monophyly2)↓</span>
          </span>
</p>
<p class="ltx_p">MrBayes5DもRAxMLと同様に負の制約には対応していません。負の制約を課したい場合には内分枝出現頻度から負の制約を正の制約へ読み替えることで対処する必要があります。</p>
</div>
</section>
<section id="Ch7.S4" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7.4 </span>Bayes factorに基づく仮説比較</h3>

<div id="Ch7.S4.p1" class="ltx_para">
<p class="ltx_p">複数の系統仮説を比較したいとき、それぞれの仮説を制約として課した解析結果を比較してやることでどちらの仮説が正しいかを検証することができます。ベイズ統計学では、そのような目的にBayes factor <cite class="ltx_cite"><a href="#bib.bib31" title="" class="ltx_ref">(Kass and Raftery, 1995)</a></cite>というものを用います。これは周辺尤度(marginal likelihood)の比に当たります。</p>
</div>
<div id="Ch7.S4.p2" class="ltx_para">
<p class="ltx_p">多くの分子系統学の論文では、MCMCにおける対数尤度の調和平均(harmonic mean)を周辺尤度の推定値としてBayes factorを算出しますが、この方法ではBayes factorが安定せず、同じ解析を別々に実行してどちらも同じところへ収束していても、どちらか一方を支持してしまう結果を得てしまうことがよくあります。十分に安定したBayes factorを得るには、非常に長いMCMCを走らせなくてはなりません。そこでTracerには、ブートストラップリサンプリングを応用して少ないサンプルからでも高精度にBayes factorを算出する機能が実装されています<cite class="ltx_cite"><a href="#bib.bib47" title="" class="ltx_ref">(Newton and Raftery, 1994)</a></cite>。この機能を用いることで、現実的な計算量でBayes factorを利用した仮説選択が可能です。ここでは、樹形制約1を課したNEXUSファイル<span class="ltx_text ltx_font_typewriter">constraint1.nex</span>の解析結果と、樹形制約2を課したNEXUSファイル<span class="ltx_text ltx_font_typewriter">constraint2.nex</span>の解析結果を比較する場合を考えます。</p>
</div>
<div id="Ch7.S4.p3" class="ltx_para">
<p class="ltx_p">MCMCが終わっていれば、<span class="ltx_text ltx_font_typewriter">constraint1.nex.run1.p</span>と<span class="ltx_text ltx_font_typewriter">constraint1.nex.run2.p</span>、<span class="ltx_text ltx_font_typewriter">constraint2.nex.run1.p</span>、<span class="ltx_text ltx_font_typewriter">constraint2.nex.run2.p</span>の4つのファイルができているはずです。それぞれのburn-inを決定し(ただしステップ数ではなくサンプル数)、Phylogears2の<span class="ltx_text ltx_font_typewriter">pgmbburninparam</span>コマンドで2つのburn-in済のログファイルを作成します。それぞれのburn-inを10001、20001、15001、15001、作成するファイルは<span class="ltx_text ltx_font_typewriter">constraint1_param.txt</span>と<span class="ltx_text ltx_font_typewriter">constraint2_param.txt</span>だとしておくと、コマンドプロンプトかターミナルで以下のようにします。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgmbburninparam --burnin=10001 constraint1.nex.run1.p constraint1_param.txt↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgmbburninparam --burnin=20001 --append constraint1.nex.run2.p constraint1_param.txt↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgmbburninparam --burnin=15001 constraint2.nex.run1.p constraint2_param.txt↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pgmbburninparam --burnin=15001 --append constraint2.nex.run2.p constraint2_param.txt↓</span>
          </span>
</p>
<p class="ltx_p">これで、それぞれの樹形制約を課した解析結果のburn-in済ログファイルが作成できます。</p>
</div>
<div id="Ch7.S4.p4" class="ltx_para">
<p class="ltx_p">次に、Tracerを起動し、<span class="ltx_text ltx_font_typewriter">File</span>メニューの<span class="ltx_text ltx_font_typewriter">Import Trace File...</span>から<span class="ltx_text ltx_font_typewriter">constraint1_param.txt</span>と<span class="ltx_text ltx_font_typewriter">constraint2_param.txt</span>を読み込ませます。そして、左上<span class="ltx_text ltx_font_typewriter">Trace Files</span>ペインで<span class="ltx_text ltx_font_typewriter">Burn-In</span>を両方とも0にしてから、両ファイルを選択して反転表示状態にし、<span class="ltx_text ltx_font_typewriter">Analysis</span>メニューの<span class="ltx_text ltx_font_typewriter">Calculate Bayes Factors...</span>からダイアログを呼び出します。ダイアログでは、<span class="ltx_text ltx_font_typewriter">Likelihood trace</span>を<span class="ltx_text ltx_font_typewriter">LnL</span>に、<span class="ltx_text ltx_font_typewriter">Calculate harmonic mean only (no smoothing)</span>のチェックを外し、<span class="ltx_text ltx_font_typewriter">Bootstrap replicates</span>を1000以上に設定し、計算を実行します。計算が終わると表が示されるので、<span class="ltx_text ltx_font_typewriter">Show</span>を<span class="ltx_text ltx_font_typewriter">ln Bayes Factors</span>に設定します。<span class="ltx_text ltx_font_typewriter">Trace</span>列が対立仮説のファイル名、対数Bayes factorの値の列名が帰無仮説のファイル名となっています。対数Bayes factorの値から、表<a href="#Ch7.T1" title="表 7.1 ‣ 7.4 Bayes factorに基づく仮説比較 ‣ 第7章 仮説検定 ‣ 分子系統学演習 データセットの作成から仮説検定まで" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.1</span></a>の基準で仮説の優劣を判断します<cite class="ltx_cite"><a href="#bib.bib31" title="" class="ltx_ref">(Kass and Raftery, 1995)</a></cite>。</p>
</div>
<figure id="Ch7.T1" class="ltx_table">
<table class="ltx_tabular ltx_centering ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left">
                <span class="ltx_text" style="font-size:80%;">対数Bayes factor</span>
              </th>
<th class="ltx_td ltx_align_left">
                <span class="ltx_text" style="font-size:80%;">帰無仮説に対して対立仮説が</span>
              </th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<td class="ltx_td ltx_align_left ltx_border_tt">
                <span class="ltx_text" style="font-size:80%;">1～3</span>
              </td>
<td class="ltx_td ltx_align_left ltx_border_tt">
                <span class="ltx_text" style="font-size:80%;">より優れている</span>
              </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_left">
                <span class="ltx_text" style="font-size:80%;">3～5</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text" style="font-size:80%;">強く支持されている</span>
              </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_left">
                <span class="ltx_text" style="font-size:80%;">5～</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text" style="font-size:80%;">非常に強く支持されている</span>
              </td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">表 7.1: </span>Bayes factorの値と仮説間の優劣</figcaption>
</figure>
<div id="Ch7.S4.p5" class="ltx_para">
<p class="ltx_p">この方法にも多重比較の問題はあるはずですが、これまでのところそのための補正方法などは普及していません。</p>
</div>
<div id="Ch7.S4.p6" class="ltx_para">
<p class="ltx_p">前述の通り、MrBayes5Dは2つのMCMCを同時に走らせています。この2つのMCMC間でもBayes factorを算出することができます。もしその2つのMCMCがパラメータ空間上の同じ辺りに収束しているのなら、そのBayes factorによってどちらか一方が支持されることはないはずです。というわけで、「Bayes factorによってどちらか一方への支持が得られてしまう」か否かを収束判定に用いることもできるでしょう。ただ、この方法では「収束していない」ということは分かりますが、「収束している」ということは言えないので注意して下さい。</p>
</div>
</section>
</section>
<section id="Ch8" class="ltx_chapter">
<h2 class="ltx_title ltx_title_chapter">
<span class="ltx_tag ltx_tag_chapter">第8章 </span>参考書籍</h2>

<div id="Ch8.p1" class="ltx_para">
<p class="ltx_p">最後に、いくつか参考書籍を挙げておきます。</p>
</div>
<section id="Ch8.S1" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8.1 </span>分子系統学</h3>

<div id="Ch8.S1.p1" class="ltx_para">
<p class="ltx_p">まず、分子系統学と分子系統解析に関する情報がまとまっている本としては以下の3冊が良いと思います。</p>
</div>
<section id="Ch8.S1.SSx1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">分子進化と分子系統学</h4>

<div id="Ch8.S1.SSx1.p1" class="ltx_para">
<dl id="Ch8.I1" class="ltx_description">
<dt id="Ch8.I1.ix1"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">著者</span>
              </span></dt>
<dd>
<div id="Ch8.I1.ix1.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">根井正利, Sudhir Kumar</span>
                </p>
</div>
</dd>
<dt id="Ch8.I1.ix2"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">出版社</span>
              </span></dt>
<dd>
<div id="Ch8.I1.ix2.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">培風館</span>
                </p>
</div>
</dd>
<dt id="Ch8.I1.ix3"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">ISBN13</span>
              </span></dt>
<dd>
<div id="Ch8.I1.ix3.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">978-4563078010</span>
                </p>
</div>
</dd>
</dl>
<p class="ltx_p">分子進化学を黎明期から支えてこられた根井先生とKumar博士が書かれた本の邦訳です。日本語で分子系統学について幅広く説明されています。分子系統学を体系的に概観するには英語でもこれを上回る本はほとんど無いと思います。</p>
</div>
</section>
<section id="Ch8.S1.SSx2" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">分子系統学への統計的アプローチ－計算分子進化学</h4>

<div id="Ch8.S1.SSx2.p1" class="ltx_para">
<dl id="Ch8.I2" class="ltx_description">
<dt id="Ch8.I2.ix1"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">著者</span>
              </span></dt>
<dd>
<div id="Ch8.I2.ix1.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">Ziheng Yang</span>
                </p>
</div>
</dd>
<dt id="Ch8.I2.ix2"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">出版社</span>
              </span></dt>
<dd>
<div id="Ch8.I2.ix2.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">共立出版</span>
                </p>
</div>
</dd>
<dt id="Ch8.I2.ix3"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">ISBN13</span>
              </span></dt>
<dd>
<div id="Ch8.I2.ix3.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">978-4320056770</span>
                </p>
</div>
</dd>
</dl>
<p class="ltx_p">分子系統解析法開発の第一人者Yang博士が書かれた本の邦訳。最尤法・ベイズ法や、最先端のトピックスまで扱われた良書です。</p>
</div>
</section>
<section id="Ch8.S1.SSx3" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">Inferring Phylogenies</h4>

<div id="Ch8.S1.SSx3.p1" class="ltx_para">
<dl id="Ch8.I3" class="ltx_description">
<dt id="Ch8.I3.ix1"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">著者</span>
              </span></dt>
<dd>
<div id="Ch8.I3.ix1.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">Joseph Felsenstein</span>
                </p>
</div>
</dd>
<dt id="Ch8.I3.ix2"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">出版社</span>
              </span></dt>
<dd>
<div id="Ch8.I3.ix2.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">Sinauer Associates Inc.</span>
                </p>
</div>
</dd>
<dt id="Ch8.I3.ix3"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">ISBN13</span>
              </span></dt>
<dd>
<div id="Ch8.I3.ix3.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">978-0878931774</span>
                </p>
</div>
</dd>
</dl>
<p class="ltx_p">分子系統解析に最尤法やブートストラップ法を導入したFelsenstein博士による系統樹推定法を網羅的に解説した決定版的書籍です。</p>
</div>
</section>
<section id="Ch8.S1.SSx4" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">The Phylogenetic Handbook: A Practical Approach to Phylogenetic Analysis and Hypothesis Testing</h4>

<div id="Ch8.S1.SSx4.p1" class="ltx_para">
<dl id="Ch8.I4" class="ltx_description">
<dt id="Ch8.I4.ix1"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">編者</span>
              </span></dt>
<dd>
<div id="Ch8.I4.ix1.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">Philippe Lemey, Marco Salemi, Anne-Mieke Vandamme</span>
                </p>
</div>
</dd>
<dt id="Ch8.I4.ix2"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">出版社</span>
              </span></dt>
<dd>
<div id="Ch8.I4.ix2.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">Cambridge University Press</span>
                </p>
</div>
</dd>
<dt id="Ch8.I4.ix3"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">ISBN13</span>
              </span></dt>
<dd>
<div id="Ch8.I4.ix3.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">978-0521730716</span>
                </p>
</div>
</dd>
</dl>
<p class="ltx_p">タイトルから分かる通り英語です。とは言え、ソフトウェアの使用方法の解説部分は、使いながら見ればさほど難しいものではないと思います。旧版から大幅に改訂され最新のソフトウェアまでカバーしています。</p>
</div>
</section>
</section>
<section id="Ch8.S2" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8.2 </span>統計学</h3>

<div id="Ch8.S2.p1" class="ltx_para">
<p class="ltx_p">分子系統学は、ある種の「超」応用統計学です。ですから、当然統計学の知識が役に立つ、というか必要になってきます。この本で触れている方法に関連する統計解析法について書かれている本を紹介します。</p>
</div>
<section id="Ch8.S2.SSx1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">モデル選択－予測・検定・推定の交差点</h4>

<div id="Ch8.S2.SSx1.p1" class="ltx_para">
<dl id="Ch8.I5" class="ltx_description">
<dt id="Ch8.I5.ix1"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">著者</span>
              </span></dt>
<dd>
<div id="Ch8.I5.ix1.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">下平英寿, 伊藤 秀一, 久保川達也, 竹内啓</span>
                </p>
</div>
</dd>
<dt id="Ch8.I5.ix2"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">出版社</span>
              </span></dt>
<dd>
<div id="Ch8.I5.ix2.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">岩波書店</span>
                </p>
</div>
</dd>
<dt id="Ch8.I5.ix3"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">ISBN13</span>
              </span></dt>
<dd>
<div id="Ch8.I5.ix3.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">978-4000068437</span>
                </p>
</div>
</dd>
</dl>
<p class="ltx_p">AICの導出過程やKH・SH・AU検定までも説明されています。これらの検定法を使われる方は是非ご一読下さい。</p>
</div>
</section>
<section id="Ch8.S2.SSx2" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">ベイズ統計と統計物理</h4>

<div id="Ch8.S2.SSx2.p1" class="ltx_para">
<dl id="Ch8.I6" class="ltx_description">
<dt id="Ch8.I6.ix1"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">著者</span>
              </span></dt>
<dd>
<div id="Ch8.I6.ix1.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">伊庭幸人</span>
                </p>
</div>
</dd>
<dt id="Ch8.I6.ix2"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">出版社</span>
              </span></dt>
<dd>
<div id="Ch8.I6.ix2.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">岩波書店</span>
                </p>
</div>
</dd>
<dt id="Ch8.I6.ix3"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">ISBN13</span>
              </span></dt>
<dd>
<div id="Ch8.I6.ix3.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">978-4000111584</span>
                </p>
</div>
</dd>
</dl>
<p class="ltx_p">ベイジアンMCMCについておそらく最も易しく説明されている本です。MrBayesを使いながら読むとパラメータの意味が良く分かるだろうと思います。</p>
</div>
</section>
<section id="Ch8.S2.SSx3" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">計算統計II－マルコフ連鎖モンテカルロ法とその周辺</h4>

<div id="Ch8.S2.SSx3.p1" class="ltx_para">
<dl id="Ch8.I7" class="ltx_description">
<dt id="Ch8.I7.ix1"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">著者</span>
              </span></dt>
<dd>
<div id="Ch8.I7.ix1.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">伊庭幸人, 種村正美, 大森裕浩, 和合肇, 佐藤整尚, 高橋明彦</span>
                </p>
</div>
</dd>
<dt id="Ch8.I7.ix2"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">出版社</span>
              </span></dt>
<dd>
<div id="Ch8.I7.ix2.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">岩波書店</span>
                </p>
</div>
</dd>
<dt id="Ch8.I7.ix3"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">ISBN13</span>
              </span></dt>
<dd>
<div id="Ch8.I7.ix3.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">978-4000068529</span>
                </p>
</div>
</dd>
</dl>
<p class="ltx_p">ベイジアンMCMCについてもっと深く知りたい方のための本です。</p>
</div>
</section>
</section>
<section id="Ch8.S3" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8.3 </span>UNIX入門</h3>

<div id="Ch8.S3.p1" class="ltx_para">
<p class="ltx_p">分子系統解析を行うソフトウェアは、UNIXの関連知識があると大変楽に使うことができます。以下ではWindows上でUNIXライクな環境を構築できるCygwinの入門書、Linuxの中でも初心者でも比較的取っ付きやすいUbuntu Linuxの入門書、Mac OS XをUNIXとして使うための入門書、シェルの入門書を挙げます。CDやDVDが付属しているものもありますが、この世界は進歩が早いので、ソフトウェアはWebから最新版をダウンロードするようにしましょう。なお、以下の本は必ずしも私は読んではいません。</p>
</div>
<div id="Ch8.S3.p2" class="ltx_para">
<p class="ltx_p">ちなみに、私が主に使っているUNIXはGentoo Linuxという、マイナーなものです。極限までカスタマイズ・チューニングができるのが特徴です。コンピュータの性能を限界まで引き出したい方は検討されてみるとよいでしょう。公式サイトのハンドブックが大変よくできていますのである程度のUNIX利用経験があれば簡単に使えるようになると思います。</p>
</div>
<div id="Ch8.S3.p3" class="ltx_para">
<p class="ltx_p">UNIXが使えるようになったら、SSHという遠隔操作するためのソフトウェアと、GNU screenまたはtmuxというソフトを是非インストールしましょう。これらを組み合わせることで、遠隔地からインターネット経由で自宅や研究室の高速なコンピュータに接続して系統解析を行わせ、さらに行わせたままで接続を切ったり再接続したりすることができるようになります。使用方法は、検索すれば説明してくれているWebページがすぐに見つかります。</p>
</div>
<section id="Ch8.S3.SSx1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">Windowsで使えるUNIX環境－Cygwin徹底入門</h4>

<div id="Ch8.S3.SSx1.p1" class="ltx_para">
<dl id="Ch8.I8" class="ltx_description">
<dt id="Ch8.I8.ix1"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">著者</span>
              </span></dt>
<dd>
<div id="Ch8.I8.ix1.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">小川淳一</span>
                </p>
</div>
</dd>
<dt id="Ch8.I8.ix2"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">出版社</span>
              </span></dt>
<dd>
<div id="Ch8.I8.ix2.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">ソーテック社</span>
                </p>
</div>
</dd>
<dt id="Ch8.I8.ix3"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">ISBN13</span>
              </span></dt>
<dd>
<div id="Ch8.I8.ix3.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">978-4881663622</span>
                </p>
</div>
</dd>
</dl>
</div>
</section>
<section id="Ch8.S3.SSx2" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">WindowsでUNIXを使う本－CygwinでUNIX入門</h4>

<div id="Ch8.S3.SSx2.p1" class="ltx_para">
<dl id="Ch8.I9" class="ltx_description">
<dt id="Ch8.I9.ix1"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">著者</span>
              </span></dt>
<dd>
<div id="Ch8.I9.ix1.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">阿久津良和</span>
                </p>
</div>
</dd>
<dt id="Ch8.I9.ix2"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">出版社</span>
              </span></dt>
<dd>
<div id="Ch8.I9.ix2.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">毎日コミュニケーションズ</span>
                </p>
</div>
</dd>
<dt id="Ch8.I9.ix3"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">ISBN13</span>
              </span></dt>
<dd>
<div id="Ch8.I9.ix3.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">978-4839911959</span>
                </p>
</div>
</dd>
</dl>
</div>
</section>
<section id="Ch8.S3.SSx3" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">はじめてのUbuntu－超初心者向けLinuxを使いこなす</h4>

<div id="Ch8.S3.SSx3.p1" class="ltx_para">
<dl id="Ch8.I10" class="ltx_description">
<dt id="Ch8.I10.ix1"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">著者</span>
              </span></dt>
<dd>
<div id="Ch8.I10.ix1.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">天野友道</span>
                </p>
</div>
</dd>
<dt id="Ch8.I10.ix2"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">出版社</span>
              </span></dt>
<dd>
<div id="Ch8.I10.ix2.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">工学社</span>
                </p>
</div>
</dd>
<dt id="Ch8.I10.ix3"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">ISBN13</span>
              </span></dt>
<dd>
<div id="Ch8.I10.ix3.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">978-4777513086</span>
                </p>
</div>
</dd>
</dl>
</div>
</section>
<section id="Ch8.S3.SSx4" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">Ubuntuスタートアップバイブル</h4>

<div id="Ch8.S3.SSx4.p1" class="ltx_para">
<dl id="Ch8.I11" class="ltx_description">
<dt id="Ch8.I11.ix1"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">著者</span>
              </span></dt>
<dd>
<div id="Ch8.I11.ix1.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">佐々木宣文</span>
                </p>
</div>
</dd>
<dt id="Ch8.I11.ix2"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">出版社</span>
              </span></dt>
<dd>
<div id="Ch8.I11.ix2.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">毎日コミュニケーションズ</span>
                </p>
</div>
</dd>
<dt id="Ch8.I11.ix3"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">ISBN13</span>
              </span></dt>
<dd>
<div id="Ch8.I11.ix3.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">978-4839930691</span>
                </p>
</div>
</dd>
</dl>
</div>
</section>
<section id="Ch8.S3.SSx5" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">Mac OS XユーザのためのUNIX入門－ターミナルから覗くUNIXの世界</h4>

<div id="Ch8.S3.SSx5.p1" class="ltx_para">
<dl id="Ch8.I12" class="ltx_description">
<dt id="Ch8.I12.ix1"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">著者</span>
              </span></dt>
<dd>
<div id="Ch8.I12.ix1.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">大津真</span>
                </p>
</div>
</dd>
<dt id="Ch8.I12.ix2"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">出版社</span>
              </span></dt>
<dd>
<div id="Ch8.I12.ix2.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">毎日コミュニケーションズ</span>
                </p>
</div>
</dd>
<dt id="Ch8.I12.ix3"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">ISBN13</span>
              </span></dt>
<dd>
<div id="Ch8.I12.ix3.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">978-4839909574</span>
                </p>
</div>
</dd>
</dl>
</div>
</section>
<section id="Ch8.S3.SSx6" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">入門Unix for Mac OS X</h4>

<div id="Ch8.S3.SSx6.p1" class="ltx_para">
<dl id="Ch8.I13" class="ltx_description">
<dt id="Ch8.I13.ix1"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">著者</span>
              </span></dt>
<dd>
<div id="Ch8.I13.ix1.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">Dave Taylor</span>
                </p>
</div>
</dd>
<dt id="Ch8.I13.ix2"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">出版社</span>
              </span></dt>
<dd>
<div id="Ch8.I13.ix2.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">オライリージャパン</span>
                </p>
</div>
</dd>
<dt id="Ch8.I13.ix3"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">ISBN13</span>
              </span></dt>
<dd>
<div id="Ch8.I13.ix3.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">978-4873112749</span>
                </p>
</div>
</dd>
</dl>
</div>
</section>
<section id="Ch8.S3.SSx7" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">シェルの基本テクニック</h4>

<div id="Ch8.S3.SSx7.p1" class="ltx_para">
<dl id="Ch8.I14" class="ltx_description">
<dt id="Ch8.I14.ix1"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">著者</span>
              </span></dt>
<dd>
<div id="Ch8.I14.ix1.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">西村めぐみ</span>
                </p>
</div>
</dd>
<dt id="Ch8.I14.ix2"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">出版社</span>
              </span></dt>
<dd>
<div id="Ch8.I14.ix2.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">IDGジャパン</span>
                </p>
</div>
</dd>
<dt id="Ch8.I14.ix3"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">ISBN13</span>
              </span></dt>
<dd>
<div id="Ch8.I14.ix3.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">978-4872802252</span>
                </p>
</div>
</dd>
</dl>
</div>
</section>
<section id="Ch8.S3.SSx8" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">UNIXシェル入門－bashの基本操作とUNIXの環境設定</h4>

<div id="Ch8.S3.SSx8.p1" class="ltx_para">
<dl id="Ch8.I15" class="ltx_description">
<dt id="Ch8.I15.ix1"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">著者</span>
              </span></dt>
<dd>
<div id="Ch8.I15.ix1.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">北浦訓行, 小島範幸</span>
                </p>
</div>
</dd>
<dt id="Ch8.I15.ix2"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">出版社</span>
              </span></dt>
<dd>
<div id="Ch8.I15.ix2.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">技術評論社</span>
                </p>
</div>
</dd>
<dt id="Ch8.I15.ix3"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">ISBN13</span>
              </span></dt>
<dd>
<div id="Ch8.I15.ix3.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">978-4774139203</span>
                </p>
</div>
</dd>
</dl>
</div>
</section>
</section>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">引用文献</h2>

<ul class="ltx_biblist" style="padding:0em 0em 0em 1em;text-indent:-1em;">
      
<li id="bib.bib2" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Ababneh, F., Jermiin, L. S., Ma, C., and Robinson, J., 2006, “Matched-pairs
tests of homogeneity with applications to homologous nucleotide sequences”,
<span class="ltx_text ltx_font_italic">Bioinformatics</span>, <span class="ltx_text ltx_font_bold">22</span>, 1225–1231.

</span>
      </li>
      
<li id="bib.bib3" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Abascal, F., Posada, D., and Zardoya, R., 2007, “MtArt: a new model of amino
acid replacement for Arthropoda”, <span class="ltx_text ltx_font_italic">Molecular Biology and Evolution</span>,
<span class="ltx_text ltx_font_bold">24</span>, 1–5.

</span>
      </li>
      
<li id="bib.bib4" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Aberer, A. J., Kobert, K., and Stamatakis, A., 2014, “ExaBayes: massively
parallel bayesian tree inference for the whole-genome era”, <span class="ltx_text ltx_font_italic">Molecular
Biology and Evolution</span>, <span class="ltx_text ltx_font_bold">31</span>, No. 10, 2553–2556, Oct.

</span>
      </li>
      
<li id="bib.bib5" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Adachi, J. and Hasegawa, M., 1996, “MOLPHY version 2.3: programs for molecular
phylogenetics based in maximum likelihood”, <span class="ltx_text ltx_font_italic">Computer Science
Monographs</span>, <span class="ltx_text ltx_font_bold">28</span>, 1–150.

</span>
      </li>
      
<li id="bib.bib6" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Adachi, J., Waddell, P. J., Martin, W., and Hasegawa, M., 2000, “Plastid
genome phylogeny and a model of amino acid substitution for proteins encoded
by chloroplast DNA”, <span class="ltx_text ltx_font_italic">Journal of Molecular Evolution</span>, <span class="ltx_text ltx_font_bold">50</span>,
348–358.

</span>
      </li>
      
<li id="bib.bib7" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Akaike, H., 1974, “New look at statistical-model identification”, <span class="ltx_text ltx_font_italic">IEEE
Transactions on Automatic Control</span>, <span class="ltx_text ltx_font_bold">19</span>, 716–723.

</span>
      </li>
      
<li id="bib.bib8" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Altekar, G., Dwarkadas, S., Huelsenbeck, J. P., and Ronquist, F., 2004,
“Parallel Metropolis coupled Markov chain Monte Carlo for Bayesian
phylogenetic inference”, <span class="ltx_text ltx_font_italic">Bioinformatics</span>, <span class="ltx_text ltx_font_bold">20</span>, 407–415.

</span>
      </li>
      
<li id="bib.bib9" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Avise, J. C. and Robinson, T. J., 2008, “Hemiplasy: a new term in the lexicon
of phylogenetics”, <span class="ltx_text ltx_font_italic">Systematic Biology</span>, <span class="ltx_text ltx_font_bold">57</span>, No. 3, 503–507,
Jun.

</span>
      </li>
      
<li id="bib.bib10" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Blanquart, S. and Lartillot, N., 2006, “A Bayesian compound stochastic process
for modeling nonstationary and nonhomogeneous sequence evolution”, <span class="ltx_text ltx_font_italic">Molecular Biology and Evolution</span>, <span class="ltx_text ltx_font_bold">23</span>, No. 11, 2058–2071, Nov.

</span>
      </li>
      
<li id="bib.bib11" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Blanquart, S. and Lartillot, N., 2008, “A site- and time-heterogeneous model
of amino acid replacement”, <span class="ltx_text ltx_font_italic">Molecular Biology and Evolution</span>,
<span class="ltx_text ltx_font_bold">25</span>, No. 5, 842–858, May.

</span>
      </li>
      
<li id="bib.bib12" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Boussau, B. and Gouy, M., 2006, “Efficient likelihood computations with
nonreversible models of evolution”, <span class="ltx_text ltx_font_italic">Systematic Biology</span>, <span class="ltx_text ltx_font_bold">55</span>,
No. 5, 756–768, Oct.

</span>
      </li>
      
<li id="bib.bib13" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Cao, Y., Janke, A., Waddell, P. J., Westerman, M., Takenaka, O., Murata, S.,
Okada, N., Pääbo, S., and Hasegawa, M., 1998, “Conflict among
individual mitochondrial proteins in resolving the phylogeny of eutherian
orders.”, <span class="ltx_text ltx_font_italic">Journal of Molecular Evolution</span>, <span class="ltx_text ltx_font_bold">47</span>, 307–322.

</span>
      </li>
      
<li id="bib.bib14" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Capella-Gutiérrez, S., Silla-Martínez, J. M., and Gabaldón, T.,
2009, “trimAl: a tool for automated alignment trimming in large-scale
phylogenetic analyses”, <span class="ltx_text ltx_font_italic">Bioinformatics</span>, <span class="ltx_text ltx_font_bold">25</span>, No. 15,
1972–1973, Aug.

</span>
      </li>
      
<li id="bib.bib15" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Castresana, J., 2000, “Selection of conserved blocks from multiple alignments
for their use in phylogenetic analysis”, <span class="ltx_text ltx_font_italic">Molecular Biology and
Evolution</span>, <span class="ltx_text ltx_font_bold">17</span>, No. 4, 540–552, Apr.

</span>
      </li>
      
<li id="bib.bib16" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Cochran, W. G., 1954, “Some methods for strengthening the common <img src="mi/mi57.png" width="21" height="20" alt="">
tests”, <span class="ltx_text ltx_font_italic">Biometrics</span>, <span class="ltx_text ltx_font_bold">10</span>, 417–451.

</span>
      </li>
      
<li id="bib.bib17" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Criscuolo, A. and Gribaldo, S., 2010, “BMGE (Block Mapping and Gathering with
Entropy): a new software for selection of phylogenetic informative regions
from multiple sequence alignments”, <span class="ltx_text ltx_font_italic">BMC Evolutionary Biology</span>,
<span class="ltx_text ltx_font_bold">10</span>, 210.

</span>
      </li>
      
<li id="bib.bib18" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Dayhoff, M. O., Schwartz, R. M., and Orcutt, B. C., 1978, “A model of
evolutionary change in proteins, Vol. 5, Suppl. 3”, in Dayhoff, M. O. ed.
<span class="ltx_text ltx_font_italic">Atlas of Protein Sequence Structure</span>: National Biomedical Research
Foundation, 345–352.

</span>
      </li>
      
<li id="bib.bib19" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Dimmic, M. W., Rest, J. S., Mindell, D. P., and Goldstein, R. A., 2002,
“rtREV: an amino acid substitution matrix for inference of retrovirus and
reverse transcriptase phylogeny”, <span class="ltx_text ltx_font_italic">Journal of Molecular Evolution</span>,
<span class="ltx_text ltx_font_bold">55</span>, 65–73.

</span>
      </li>
      
<li id="bib.bib20" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Edgar, R. C., 2004, “MUSCLE: multiple sequence alignment with high accuracy
and high throughput”, <span class="ltx_text ltx_font_italic">Nucleic Acids Research</span>, <span class="ltx_text ltx_font_bold">32</span>, No. 5,
1792–1797.

</span>
      </li>
      
<li id="bib.bib21" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Felsenstein, J., 1981, “Evolutionary trees from DNA sequencies - a
maximum-likelihood approach”, <span class="ltx_text ltx_font_italic">Journal of Molecular Evolution</span>,
<span class="ltx_text ltx_font_bold">17</span>, 368–376.

</span>
      </li>
      
<li id="bib.bib22" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Felsenstein, J., 1985, “Confidence-limits on phylogenies - an approach using
the bootstrap”, <span class="ltx_text ltx_font_italic">Evolution</span>, <span class="ltx_text ltx_font_bold">39</span>, 783–791.

</span>
      </li>
      
<li id="bib.bib23" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Fleissner, R., Metzler, D., and von Haeseler, A., 2005, “Simultaneous
statistical multiple alignment and phylogeny reconstruction”, <span class="ltx_text ltx_font_italic">Systematic Biology</span>, <span class="ltx_text ltx_font_bold">54</span>, 548–561.

</span>
      </li>
      
<li id="bib.bib24" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Hastings, W. K., 1970, “Monte Carlo sampling methods using Markov chains and
their applications”, <span class="ltx_text ltx_font_italic">Biometrika</span>, <span class="ltx_text ltx_font_bold">57</span>, 97–109.

</span>
      </li>
      
<li id="bib.bib25" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Henikoff, S. and Henikoff, J. G., 1992, “Amino acid substitution matrices from
protein blocks”, <span class="ltx_text ltx_font_italic">Proceedings of the National Academy of Sciences of the
United States of America</span>, <span class="ltx_text ltx_font_bold">89</span>, 10915–10919.

</span>
      </li>
      
<li id="bib.bib26" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Hrdy, I., Hirt, R. P., Dolezal, P., Bardonová, L., Foster, P. G., Tachezy,
J., and Embley, T. M., 2004, “Trichomonas hydrogenosomes contain the NADH
dehydrogenase module of mitochondrial complex I”, <span class="ltx_text ltx_font_italic">Nature</span>,
<span class="ltx_text ltx_font_bold">432</span>, No. 7017, 618–622, Dec.

</span>
      </li>
      
<li id="bib.bib27" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Jobb, G., 2008, “Treefinder version of April 2008”, Software distributed by
the author at http://www.treefinder.de/.

</span>
      </li>
      
<li id="bib.bib28" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Jobb, G., von Haeseler, A., and Strimmer, K., 2004, “Treefinder: a powerful
graphical analysis environment for molecular phylogenetics”, <span class="ltx_text ltx_font_italic">BMC
Evolutionary Biology</span>, <span class="ltx_text ltx_font_bold">4</span>,  18.

</span>
      </li>
      
<li id="bib.bib29" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Jones, D. T., Taylor, W. R., and Thornton, J. M., 1992, “The rapid generation
of mutation data matrices from protein sequences”, <span class="ltx_text ltx_font_italic">Computer
Applications in the Biosciences</span>, <span class="ltx_text ltx_font_bold">8</span>, 275–282.

</span>
      </li>
      
<li id="bib.bib30" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Jukes, T. H. and Cantor, C. R., 1969, “Evolution of protein molecules”, in
Munro, H. N. ed. <span class="ltx_text ltx_font_italic">Mammalian protein metabolism</span>, New York: Academic
Press, 21–132.

</span>
      </li>
      
<li id="bib.bib31" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Kass, R. E. and Raftery, A. E., 1995, “Bayes Factors”, <span class="ltx_text ltx_font_italic">Journal of the
American Statistical Association</span>, <span class="ltx_text ltx_font_bold">90</span>, 773–795.

</span>
      </li>
      
<li id="bib.bib32" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Kass, R. E., Carlin, B. P., Gelman, A., and Neal, R., 1998, “Markov chain
Monte Carlo in practice: a roundtable discussion”, <span class="ltx_text ltx_font_italic">American
Statistician</span>, <span class="ltx_text ltx_font_bold">52</span>, 93–100.

</span>
      </li>
      
<li id="bib.bib33" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Katoh, K., Kuma, K., Toh, H., and Miyata, T., 2005, “MAFFT version 5:
improvement in accuracy of multiple sequence alignment”, <span class="ltx_text ltx_font_italic">Nucleic Acids
Research</span>, <span class="ltx_text ltx_font_bold">33</span>, 511–518.

</span>
      </li>
      
<li id="bib.bib34" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Kimura, M., 1980, “A simple method for estimating evolutionary rates of base
substitutions through comparative studies of nucleotide sequences”, <span class="ltx_text ltx_font_italic">Journal of Molecular Evolution</span>, <span class="ltx_text ltx_font_bold">16</span>, 111–120.

</span>
      </li>
      
<li id="bib.bib35" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Kimura, M., 1983, <span class="ltx_text ltx_font_italic">The neutral theory of molecular evolution</span>: Cambridge
University Press.

</span>
      </li>
      
<li id="bib.bib36" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Kishino, H. and Hasegawa, M., 1989, “Evaluation of the maximum likelihood
estimate of the evolutionary tree topologies from DNA sequence data, and the
branching order in hominoidea”, <span class="ltx_text ltx_font_italic">Journal of Molecular Evolution</span>,
<span class="ltx_text ltx_font_bold">29</span>, 170–179.

</span>
      </li>
      
<li id="bib.bib37" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Kosiol, C. and Goldman, N., 2005, “Different versions of the Dayhoff rate
matrix”, <span class="ltx_text ltx_font_italic">Molecular Biology and Evolution</span>, <span class="ltx_text ltx_font_bold">22</span>, 193–199.

</span>
      </li>
      
<li id="bib.bib38" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Larkin, M. A., Blackshields, G., Brown, N. P., Chenna, R., McGettigan, P. A.,
McWilliam, H., Valentin, F., Wallace, I. M., Wilm, A., Lopez, R., Thompson,
J. D., Gibson, T. J., and Higgins, D. G., 2007, “Clustal W and Clustal X
version 2.0”, <span class="ltx_text ltx_font_italic">Bioinformatics</span>, <span class="ltx_text ltx_font_bold">23</span>, No. 21, 2947–2948, Nov.

</span>
      </li>
      
<li id="bib.bib39" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Lartillot, N. and Philippe, H., 2004, “A Bayesian mixture model for
across-site heterogeneities in the amino-acid replacement process”, <span class="ltx_text ltx_font_italic">Molecular Biology and Evolution</span>, <span class="ltx_text ltx_font_bold">21</span>, 1095–1109.

</span>
      </li>
      
<li id="bib.bib40" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Le, S. Q. and Gascuel, O., 2008, “An improved general amino acid replacement
matrix”, <span class="ltx_text ltx_font_italic">Molecular Biology and Evolution</span>, <span class="ltx_text ltx_font_bold">25</span>, 1307–1320.

</span>
      </li>
      
<li id="bib.bib41" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Le, S. Q. and Gascuel, O., 2010, “Accounting for solvent accessibility and
secondary structure in protein phylogenetics is clearly beneficial”, <span class="ltx_text ltx_font_italic">Systematic Biology</span>, <span class="ltx_text ltx_font_bold">59</span>, No. 3, 277–287.

</span>
      </li>
      
<li id="bib.bib42" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Le, S. Q., Dang, C. C., and Gascuel, O., 2012, “Modeling protein evolution
with several amino acid replacement matrices depending on site rates”, <span class="ltx_text ltx_font_italic">Molecular Biology and Evolution</span>, <span class="ltx_text ltx_font_bold">29</span>, No. 10, 2921–2936, Oct.

</span>
      </li>
      
<li id="bib.bib43" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Lunter, G., Miklós, I., Drummond, A., Jensen, J. L., and Hein, J., 2005,
“Bayesian coestimation of phylogeny and sequence alignment”, <span class="ltx_text ltx_font_italic">BMC
Bioinformatics</span>, <span class="ltx_text ltx_font_bold">6</span>,  83.

</span>
      </li>
      
<li id="bib.bib44" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Metropolis, N., Rosenbluth, A. W., Rosenbluth, M. N., and Teller, A. H., 1953,
“Equation of state calculations by fast computing machines”, <span class="ltx_text ltx_font_italic">Journal
of Chemical Physics</span>, <span class="ltx_text ltx_font_bold">21</span>, 1087–1092.

</span>
      </li>
      
<li id="bib.bib45" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Misof, B. and Misof, K., 2009, “A Monte Carlo approach successfully identifies
randomness in multiple sequence alignments: a more objective means of data
exclusion”, <span class="ltx_text ltx_font_italic">Systematic Biology</span>, <span class="ltx_text ltx_font_bold">58</span>, No. 1, 21–34, Feb.

</span>
      </li>
      
<li id="bib.bib46" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Müller, T. and Vingron, M., 2000, “Modeling amino acid replacement”, <span class="ltx_text ltx_font_italic">Journal of Computational Biology</span>, <span class="ltx_text ltx_font_bold">7</span>, 761–776.

</span>
      </li>
      
<li id="bib.bib47" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Newton, M. A. and Raftery, A. E., 1994, “Approximate Bayesian inference with
the weighted likelihood bootstrap”, <span class="ltx_text ltx_font_italic">Journal of the Royal Statistical
Society</span>, <span class="ltx_text ltx_font_bold">56</span>, 3–48.

</span>
      </li>
      
<li id="bib.bib48" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Nickle, D. C., Heath, L., Jensen, M. A., Gilbert, P. B., Mullins, J. I., and
Pond, S. L. K., 2007, “HIV-specific probabilistic models of protein
evolution”, <span class="ltx_text ltx_font_italic">PLoS ONE</span>, <span class="ltx_text ltx_font_bold">2</span>, e503.

</span>
      </li>
      
<li id="bib.bib49" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Pagel, M. and Meade, A., 2004, “A phylogenetic mixture model for detecting
pattern-heterogeneity in gene sequence or character-state data”, <span class="ltx_text ltx_font_italic">Systematic Biology</span>, <span class="ltx_text ltx_font_bold">53</span>, 571–581.

</span>
      </li>
      
<li id="bib.bib50" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Posada, D. and Crandall, K. A., 1998, “Modeltest: testing the model of DNA
substitution”, <span class="ltx_text ltx_font_italic">Bioinformatics</span>, <span class="ltx_text ltx_font_bold">14</span>, 817–818.

</span>
      </li>
      
<li id="bib.bib51" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Redelings, B. D. and Suchard, M. A., 2005, “Joint Bayesian estimation of
alignment and phylogeny”, <span class="ltx_text ltx_font_italic">Systematic Biology</span>, <span class="ltx_text ltx_font_bold">54</span>, 401–418.

</span>
      </li>
      
<li id="bib.bib52" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Ronquist, F. and Huelsenbeck, J. P., 2003, “MrBayes 3: Bayesian phylogenetic
inference under mixed models”, <span class="ltx_text ltx_font_italic">Bioinformatics</span>, <span class="ltx_text ltx_font_bold">19</span>,
1572–1574.

</span>
      </li>
      
<li id="bib.bib53" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Ronquist, F., Huelsenbeck, J. P., and van der Mark, P., 2005, “MrBayes 3.1
Manual 5/26/2005”, Distributed at http://mrbayes.csit.fsu.edu/manual.php.

</span>
      </li>
      
<li id="bib.bib54" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Rota-Stabelli, O., Yang, Z., and Telford, M. J., 2009, “MtZoa: a general
mitochondrial amino acid substitutions model for animal evolutionary
studies”, <span class="ltx_text ltx_font_italic">Molecular Phylogenetics and Evolution</span>, <span class="ltx_text ltx_font_bold">52</span>, No. 1,
268–272, Jul.

</span>
      </li>
      
<li id="bib.bib55" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Saitou, N. and Nei, M., 1987, “The neighbor-joining method: a new method for
reconstructing phylogenetics trees”, <span class="ltx_text ltx_font_italic">Molecular Biology and Evolution</span>,
<span class="ltx_text ltx_font_bold">4</span>, 406–425.

</span>
      </li>
      
<li id="bib.bib56" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Schwarz, G., 1978, “Estimating the dimension of a model”, <span class="ltx_text ltx_font_italic">Annals of
Statistics</span>, <span class="ltx_text ltx_font_bold">6</span>, 461–464.

</span>
      </li>
      
<li id="bib.bib57" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Shimodaira, H., 2002, “An approximately unbiased test of phylogenetic tree
selection”, <span class="ltx_text ltx_font_italic">Systematic Biology</span>, <span class="ltx_text ltx_font_bold">51</span>, 492–508.

</span>
      </li>
      
<li id="bib.bib58" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Shimodaira, H. and Hasegawa, M., 1999, “Multiple comparisons of
log-likelihoods with applications to phylogenetic inference”, <span class="ltx_text ltx_font_italic">Molecular
Biology and Evolution</span>, <span class="ltx_text ltx_font_bold">16</span>, 1114–1116.

</span>
      </li>
      
<li id="bib.bib59" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Stamatakis, A., 2006, “RAxML-VI-HPC: maximum likelihood-based phylogenetic
analyses with thousands of taxa and mixed models”, <span class="ltx_text ltx_font_italic">Bioinformatics</span>,
<span class="ltx_text ltx_font_bold">22</span>, 2688–2690.

</span>
      </li>
      
<li id="bib.bib60" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Sugiura, N., 1978, “Further analysis of the data by Akaike’s information
criterion and the finite corrections”, <span class="ltx_text ltx_font_italic">Communications in Statistics:
Theory and Methods</span>, <span class="ltx_text ltx_font_bold">A7</span>, 13–26.

</span>
      </li>
      
<li id="bib.bib61" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Swofford, D. L., 2003, <span class="ltx_text ltx_font_italic">PAUP*. Phylogenetic Analysis Using Parsimony (*and
Other Methods). Version 4</span>, Sunderland, Massachusetts: Sinauer Associates.

</span>
      </li>
      
<li id="bib.bib62" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Swofford, D. L. and Begle, D. P., 1993, <span class="ltx_text ltx_font_italic">PAUP: Phylogenetic Analysis Using
Parsimony , Ver.3.1. User’s Manual</span>: Laboratory of Molecular Systematics,
Smithonian Institution.

</span>
      </li>
      
<li id="bib.bib63" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Talavera, G. and Castresana, J., 2007, “Improvement of phylogenies after
removing divergent and ambiguously aligned blocks from protein sequence
alignments”, <span class="ltx_text ltx_font_italic">Systematic Biology</span>, <span class="ltx_text ltx_font_bold">56</span>, No. 4, 564–577, Aug.

</span>
      </li>
      
<li id="bib.bib64" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Tanabe, A. S., 2011, “Kakusan4 and Aminosan: two programs for comparing
nonpartitioned, proportional and separate models for combined molecular
phylogenetic analyses of multilocus sequence data”, <span class="ltx_text ltx_font_italic">Molecular Ecology
Resources</span>, <span class="ltx_text ltx_font_bold">11</span>, No. 5, 914–921, Sep.

</span>
      </li>
      
<li id="bib.bib65" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Tavaré, S., 1986, “Some probabilistic and statistical problems in the
analysis of DNA sequences”, <span class="ltx_text ltx_font_italic">Lectures on Mathematics in the Life
Sciences</span>, <span class="ltx_text ltx_font_bold">17</span>, 57–86.

</span>
      </li>
      
<li id="bib.bib66" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Tuffley, C. and Steel, M., 1997, “Links between maximum likelihood and maximum
parsimony under a simple model of site substitution”, <span class="ltx_text ltx_font_italic">Bulletin of
Mathematical Biolology</span>, <span class="ltx_text ltx_font_bold">59</span>, No. 3, 581–607, May.

</span>
      </li>
      
<li id="bib.bib67" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Tuffley, C. and Steel, M., 1998, “Modeling the covarion hypothesis of
nucleotide substitution”, <span class="ltx_text ltx_font_italic">Mathematical Biosciences</span>, <span class="ltx_text ltx_font_bold">147</span>, No.
1, 63–91, Jan.

</span>
      </li>
      
<li id="bib.bib68" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Veerassamy, S., Smith, A., and Tillier, E. R. M., 2003, “A transition
probability model for amino acid substitutions from blocks.”, <span class="ltx_text ltx_font_italic">Journal
of Computational Biology</span>, <span class="ltx_text ltx_font_bold">10</span>, 997–1010.

</span>
      </li>
      
<li id="bib.bib69" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Venditti, C., Meade, A., and Pagel, M., 2006, “Detecting the node-density
artifact in phylogeny reconstruction”, <span class="ltx_text ltx_font_italic">Systematic Biology</span>,
<span class="ltx_text ltx_font_bold">55</span>, No. 4, 637–643, Aug.

</span>
      </li>
      
<li id="bib.bib70" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Webster, A. J., Payne, R. J. H., and Pagel, M., 2003, “Molecular phylogenies
link rates of evolution and speciation”, <span class="ltx_text ltx_font_italic">Science</span>, <span class="ltx_text ltx_font_bold">301</span>, No.
5632, 478, Jul.

</span>
      </li>
      
<li id="bib.bib71" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Whelan, S. and Goldman, N., 2001, “A general empirical model of protein
evolution derived from multiple protein families using a maximum-likelihood
approach”, <span class="ltx_text ltx_font_italic">Molecular Biology and Evolution</span>, <span class="ltx_text ltx_font_bold">18</span>, 691–699.

</span>
      </li>
      
<li id="bib.bib72" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Woese, C. R., Achenbach, L., Rouviere, P., and Mandelco, L., 1991, “Archaeal
phylogeny: reexamination of the phylogenetic position of Archaeoglobus
fulgidus in light of certain composition-induced artifacts”, <span class="ltx_text ltx_font_italic">Systematic
and Applied Microbiology</span>, <span class="ltx_text ltx_font_bold">14</span>, No. 4, 364–371.

</span>
      </li>
      
<li id="bib.bib73" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Yang, Z., 1993, “Maximum likelihood estimation of phylogeny from DNA sequences
when substitution rates differ over sites”, <span class="ltx_text ltx_font_italic">Molecular Biology and
Evolution</span>, <span class="ltx_text ltx_font_bold">10</span>, 1396–1401.

</span>
      </li>
      
<li id="bib.bib74" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Yang, Z., 1994, “Maximum likelihood phylogenetic estimation from DNA sequences
with variable rates over sites: approximate methods”, <span class="ltx_text ltx_font_italic">Journal of
Molecular Evolution</span>, <span class="ltx_text ltx_font_bold">39</span>, 306–314.

</span>
      </li>
      
<li id="bib.bib75" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Yang, Z., 1995, “A space-time process model for the evolution of DNA
sequences”, <span class="ltx_text ltx_font_italic">Genetics</span>, <span class="ltx_text ltx_font_bold">139</span>, 993–1005.

</span>
      </li>
    
</ul>
</section><div class="ltx_rdf" about="" property="dcterms:subject" content="分子系統樹推定"></div>

</article>
</div>
</div>
</body>
</html>
